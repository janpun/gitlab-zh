(this.webpackJsonp=this.webpackJsonp||[]).push([[7],{107:function(e,t,a){"use strict";var s=a(0),n=a.n(s),i=a(3),r=a.n(i),l=a(1),o=a(5),d=a(79),u=a(64),c=a(117),f=a(7),h=a(47),p=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],s=!0,n=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(s=(r=l.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){n=!0,i=e}finally{try{!s&&l.return&&l.return()}finally{if(n)throw i}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();var b=function(){function e(t){var a,s,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a=this,s=n()(t),t||(s=n()(".js-label-select")),s.each(function(t,s){var d,m,b,v,g,w,k,y,C,j,_,x,L,I,$,S,U,O,D,E,B,F;F=(m=n()(s)).closest(".labels-filter"),m.find(".dropdown-toggle-text"),x=m.data("namespacePath"),L=m.data("projectPath"),_=m.data("labels"),j=m.data("issueUpdate"),null==($=m.data("selected"))||m.hasClass("js-multiselect")||($=$.split(",")),U=m.data("showNo"),S=m.data("showAny"),B=m.data("showMenuAbove"),C=m.data("defaultLabel")||"Label",y=m.data("abilityName"),d=(g=m.closest(".selectbox")).closest(".block"),b=m.closest("form, .js-issuable-update"),w=d.find(".sidebar-collapsed-icon span"),O=d.find(".js-sidebar-labels-tooltip"),k=d.find(".value"),v=d.find(".block-loading").fadeOut(),E=m.data("fieldName"),m.is(".js-issuable-form-dropdown, .js-filter-bulk-update, .js-label-sidebar-dropdown"),D=g.find('input[name="'+m.data("fieldName")+'"]').map(function(){return this.value}).get();var N=i.handleClick;O.tooltip(),m.closest(".dropdown").find(".dropdown-new-label").length&&new c.a(m.closest(".dropdown").find(".dropdown-new-label"),x,L),I=function(){var t,a;a=m.closest(".selectbox").find("input[name='"+E+"']").map(function(){return this.value}).get(),r.a.isEqual(D,a)||(D=a,(t={})[y]={},t[y].label_ids=a,a.length||(t[y].label_ids=[""]),v.removeClass("hidden").fadeIn(),m.trigger("loading.gl.dropdown"),o.a.put(j,t).then(function(t){var a,s,i,r,o=t.data;v.fadeOut(),m.trigger("loaded.gl.dropdown"),g.hide(),o.issueUpdateURL=j,a=0,o.labels.length&&j?(s=e.getLabelTemplate({labels:o.labels,issueUpdateURL:j}),a=o.labels.length):s='<span class="no-value">None</span>',k.removeAttr("style").html(s),w.text(a),o.labels.length?((r=o.labels.map(function(e){return e.title})).length>5&&(r=r.slice(0,5)).push("and "+(o.labels.length-5)+" more"),i=r.join(", ")):i=Object(l.a)("Labels"),O.attr("title",i).tooltip("_fixTitle"),n()(".has-tooltip",k).tooltip({container:"body"})}).catch(function(){return Object(f.a)(Object(l.a)("Error saving label update."))}))},m.glDropdown({showMenuAbove:B,data:function(e,t){o.a.get(_).then(function(e){var a=r.a.chain(e.data).groupBy(function(e){return e.title}).map(function(e){var t;return t=r.a.map(e,function(e){return e.color}),{id:e[0].id,title:e[0].title,color:t,duplicate:t.length>1}}).value();if(m.hasClass("js-extra-options")){var s=[];U&&s.unshift({id:0,title:"No Label"}),S&&s.unshift({isAny:!0,title:"Any Label"}),s.length&&(s.push("divider"),a=s.concat(a))}t(a),B&&m.data("glDropdown").positionMenuAbove()}).catch(function(){return Object(f.a)(Object(l.a)("Error fetching labels."))})},renderRow:function(e,t){var a,s,i,l,o,d,c,f,h,v,g;(s=n()("<li>"),a=n()('<a href="#">'),c=[],d=e.id<=0||null==e.id,m.hasClass("js-filter-bulk-update")?(o=m.data("indeterminate")||[],h=m.data("marked")||[],-1!==o.indexOf(e.id)&&c.push("is-indeterminate"),-1!==h.indexOf(e.id)&&(-1!==(f=c.indexOf("is-indeterminate"))&&c.splice(f,1),c.push("is-active"))):(this.id(e)&&(v=m.data("fieldName"),g=this.id(e).toString().replace(/'/g,"\\'"),b.find("input[type='hidden'][name='"+v+"'][value='"+g+"']").length&&c.push("is-active")),m.hasClass("js-multiselect")&&d&&c.push("dropdown-clear-active")),e.duplicate)?i=u.a.duplicateLabelColor(e.color):null!=e.color&&(i=p(e.color,1)[0]);return l=i?"<span class='dropdown-label-box' style='background: "+i+"'></span>":"",e.id&&(c.push("label-item"),a.attr("data-label-id",e.id)),a.addClass(c.join(" ")).html(l+" "+r.a.escape(e.title)),s.html(a).prop("outerHTML")},search:{fields:["title"]},selectable:!0,filterable:!0,selected:m.data("selected")||[],toggleLabel:function(e,t){var a=m.parent(),s=a.find(".dropdown-input-field"),n=null!==t&&t.hasClass("is-active"),i=e?e.title:null,r=this.selected;if(s.length&&s.val().length&&a.find(".dropdown-input-clear").trigger("click"),e&&0===e.id)return this.selected=[],"No Label";if(n)this.selected.push(i);else if(!n&&i){var l=this.selected.indexOf(i);this.selected.splice(l,1)}return 1===r.length?r:r.length?r[0]+" +"+(r.length-1)+" more":C},fieldName:m.data("fieldName"),id:function(e){return e.id<=0?e.title:m.hasClass("js-issuable-form-dropdown")?e.id:m.hasClass("js-filter-submit")&&null==e.isAny?e.title:e.id},hidden:function(){var e,t,a;e="projects:issues:index"===(a=n()("body").attr("data-page")),t="projects:merge_requests:index"===a,g.hide(),k.removeAttr("style"),m.hasClass("js-issuable-form-dropdown")||n()("html").hasClass("issue-boards-page")||m.hasClass("js-multiselect")&&(m.hasClass("js-filter-submit")&&(e||t)?(m.closest("form").find("input:hidden[name='"+m.data("fieldName")+"']"),Issuable.filterResults(m.closest("form"))):m.hasClass("js-filter-submit")?m.closest("form").submit():m.hasClass("js-filter-bulk-update")||I())},multiSelect:m.hasClass("js-multiselect"),vue:m.hasClass("js-issue-board-sidebar"),clicked:function(e){var t,s,i,r,l=e.$el,o=e.e,d=e.isMarking,u=e.selectedObj,c=function(){v.fadeOut()};if(t="projects:issues:index"===(i=n()("body").attr("data-page")),s="projects:merge_requests:index"===i,m.parent().find(".is-active:not(.dropdown-clear-active)").length&&m.parent().find(".dropdown-clear-active").removeClass("is-active"),!m.hasClass("js-issuable-form-dropdown")){if(m.hasClass("js-filter-bulk-update"))return a.enableBulkLabelDropdown(),void a.setDropdownData(m,d,u.id);if(m.closest(".add-issues-modal").length&&(r=h.a.store.filter),r)return u.isAny?r.label_name=[]:l.hasClass("is-active")&&r.label_name.push(u.title),void o.preventDefault();if(m.hasClass("js-filter-submit")&&(t||s)){if(!m.hasClass("js-multiselect"))return $=u.title,Issuable.filterResults(m.closest("form"))}else{if(m.hasClass("js-filter-submit"))return m.closest("form").submit();if(m.hasClass("js-issue-board-sidebar")){if(l.hasClass("is-active"))gl.issueBoards.BoardsStore.detail.issue.labels.push(new ListLabel({id:u.id,title:u.title,color:u.color[0],textColor:"#fff"}));else{var f=gl.issueBoards.BoardsStore.detail.issue.labels;f=f.filter(function(e){return e.id!==u.id}),gl.issueBoards.BoardsStore.detail.issue.labels=f}v.fadeIn(),gl.issueBoards.BoardsStore.detail.issue.update(m.attr("data-issue-update")).then(c).catch(c)}else if(N)o.preventDefault(),N(u);else if(!m.hasClass("js-multiselect"))return I()}}},opened:function(e){if(m.hasClass("js-issue-board-sidebar")){var t=m.attr("data-selected");this.selected=t?t.split(","):[],m.data("glDropdown").updateLabel()}},preserveContext:!0}),a.setOriginalDropdownData(F,m)}),this.bindEvents()}return m(e,[{key:"bindEvents",value:function(){return n()("body").on("change",".selected_issue",this.onSelectCheckboxIssue)}},{key:"onSelectCheckboxIssue",value:function(){if(!n()(".selected_issue:checked").length)return n()(".issues-bulk-update .labels-filter .dropdown-toggle-text").text("Label")}},{key:"enableBulkLabelDropdown",value:function(){d.a.willUpdateLabels=!0}},{key:"setDropdownData",value:function(e,t,a){var s,n,i,r;n=e.data("marked")||[],i=e.data("unmarked")||[],r=e.data("indeterminate")||[],t?(n.push(a),(s=r.indexOf(a))>-1&&r.splice(s,1),(s=i.indexOf(a))>-1&&i.splice(s,1)):((s=n.indexOf(a))>-1&&n.splice(s,1),d.a.getOriginalIndeterminateIds().indexOf(a)>-1&&i.push(a),d.a.getOriginalCommonIds().indexOf(a)>-1&&i.push(a)),e.data("marked",n),e.data("unmarked",i),e.data("indeterminate",r)}},{key:"setOriginalDropdownData",value:function(e,t){var a=[];e.find('[name="label_name[]"]').map(function(){return a.push(this.value)}),t.data("marked",a)}}],[{key:"getLabelTemplate",value:function(e){return r.a.template(["<% _.each(labels, function(label){ %>",'<a href="<%- issueUpdateURL.slice(0, issueUpdateURL.lastIndexOf("/")) %>?label_name[]=<%- encodeURIComponent(label.title) %>">','<span class="badge label has-tooltip color-label" title="<%- label.description %>" style="background-color: <%- label.color %>; color: <%- label.text_color %>;">',"<%- label.title %>","</span>","</a>","<% }); %>"].join(""))(e)}}]),e}();t.a=b},117:function(e,t,a){"use strict";var s=a(0),n=a.n(s),i=a(33),r=a(45),l=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();var o=function(){function e(t,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.namespacePath=a,this.projectPath=s,this.$dropdownBack=n()(".dropdown-menu-back",this.$el.closest(".dropdown")),this.$cancelButton=n()(".js-cancel-label-btn",this.$el),this.$newLabelField=n()("#new_label_name",this.$el),this.$newColorField=n()("#new_label_color",this.$el),this.$colorPreview=n()(".js-dropdown-label-color-preview",this.$el),this.$newLabelError=n()(".js-label-error",this.$el),this.$newLabelCreateButton=n()(".js-new-label-btn",this.$el),this.$colorSuggestions=n()(".suggest-colors-dropdown a",this.$el),this.$newLabelError.hide(),this.$newLabelCreateButton.disable(),this.cleanBinding(),this.addBinding()}return l(e,[{key:"cleanBinding",value:function(){this.$colorSuggestions.off("click"),this.$newLabelField.off("keyup change"),this.$newColorField.off("keyup change"),this.$dropdownBack.off("click"),this.$cancelButton.off("click"),this.$newLabelCreateButton.off("click")}},{key:"addBinding",value:function(){var e=this;this.$colorSuggestions.on("click",function(t){var a=n()(this);e.addColorValue(t,a)}),this.$newLabelField.on("keyup change",this.enableLabelCreateButton.bind(this)),this.$newColorField.on("keyup change",this.enableLabelCreateButton.bind(this)),this.$dropdownBack.on("click",this.resetForm.bind(this)),this.$cancelButton.on("click",function(t){t.preventDefault(),t.stopPropagation(),e.resetForm(),e.$dropdownBack.trigger("click")}),this.$newLabelCreateButton.on("click",this.saveLabel.bind(this))}},{key:"addColorValue",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.$newColorField.val(t.data("color")).trigger("change"),this.$colorPreview.css("background-color",t.data("color")).parent().addClass("is-active")}},{key:"enableLabelCreateButton",value:function(){""!==this.$newLabelField.val()&&""!==this.$newColorField.val()?(this.$newLabelError.hide(),this.$newLabelCreateButton.enable()):this.$newLabelCreateButton.disable()}},{key:"resetForm",value:function(){this.$newLabelField.val("").trigger("change"),this.$newColorField.val("").trigger("change"),this.$colorPreview.css("background-color","").parent().removeClass("is-active")}},{key:"saveLabel",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),i.a.newLabel(this.namespacePath,this.projectPath,{title:this.$newLabelField.val(),color:this.$newColorField.val()},function(e){if(t.$newLabelCreateButton.enable(),e.message){var a=void 0;a="string"==typeof e.message?e.message:Object.keys(e.message).map(function(t){return Object(r.h)(t)+" "+e.message[t].join(", ")}).join("<br/>"),t.$newLabelError.html(a).show()}else t.$dropdownBack.trigger("click"),n()(document).trigger("created.label",e)})}}]),e}();t.a=o},79:function(e,t,a){"use strict";var s=a(0),n=a.n(s),i=a(3),r=a.n(i),l=a(5),o=a(7);t.a={init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.container,e.form),a=e.issues,s=e.prefixId;this.prefixId=s||"issue_",this.form=t||this.getElement(".bulk-update"),this.$labelDropdown=this.form.find(".js-label-select"),this.issues=a||this.getElement(".issues-list .issue"),this.willUpdateLabels=!1,this.bindEvents()},bindEvents:function(){return this.form.off("submit").on("submit",this.onFormSubmit.bind(this))},onFormSubmit:function(e){return e.preventDefault(),this.submit()},submit:function(){var e=this;l.a[this.form.attr("method")](this.form.attr("action"),this.getFormDataAsObject()).then(function(){return window.location.reload()}).catch(function(){return e.onFormSubmitFailure()})},onFormSubmitFailure:function(){return this.form.find('[type="submit"]').enable(),new o.a("Issue update failed")},getSelectedIssues:function(){return this.issues.has(".selected_issue:checked")},getLabelsFromSelection:function(){var e=[];return this.getSelectedIssues().map(function(){var t=n()(this).data("labels");if(t)return t.map(function(t){if(-1===e.indexOf(t))return e.push(t)})}),e},getUnmarkedIndeterminedLabels:function(){var e=[],t=this.$labelDropdown.data("indeterminate");return this.getLabelsFromSelection().forEach(function(a){-1===t.indexOf(a)&&e.push(a)}),e},getFormDataAsObject:function(){var e={update:{state_event:this.form.find('input[name="update[state_event]"]').val(),assignee_id:this.form.find('input[name="update[assignee_id]"]').val(),assignee_ids:[this.form.find('input[name="update[assignee_ids][]"]').val()],milestone_id:this.form.find('input[name="update[milestone_id]"]').val(),issuable_ids:this.form.find('input[name="update[issuable_ids]"]').val(),subscription_event:this.form.find('input[name="update[subscription_event]"]').val(),add_label_ids:[],remove_label_ids:[]}};return this.willUpdateLabels&&(e.update.add_label_ids=this.$labelDropdown.data("marked"),e.update.remove_label_ids=this.$labelDropdown.data("unmarked")),e},setOriginalDropdownData:function(){var e=n()(".bulk-update .js-label-select");e.data("common",this.getOriginalCommonIds()),e.data("marked",this.getOriginalMarkedIds()),e.data("indeterminate",this.getOriginalIndeterminateIds())},getOriginalCommonIds:function(){var e=this,t=[];return this.getElement(".selected_issue:checked").each(function(a,s){t.push(e.getElement("#"+e.prefixId+s.dataset.id).data("labels"))}),r.a.intersection.apply(this,t)},getOriginalMarkedIds:function(){var e=this,t=[];return this.getElement(".selected_issue:checked").each(function(a,s){t.push(e.getElement("#"+e.prefixId+s.dataset.id).data("labels"))}),r.a.intersection.apply(this,t)},getOriginalIndeterminateIds:function(){var e=this,t=[],a=[],s=[];return this.getElement(".selected_issue:checked").each(function(n,i){(s=e.getElement("#"+e.prefixId+i.dataset.id).data("labels")).forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),a.push(s)}),a.unshift(t),r.a.difference(t,r.a.intersection.apply(this,a))},getElement:function(e){return this.scopeEl=this.scopeEl||n()(".content"),this.scopeEl.find(e)}}},81:function(e,t,a){"use strict";var s=a(0),n=a.n(s),i=a(3),r=a.n(i),l=a(5),o=a(1),d=a(47),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function c(e,t){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.users=this.users.bind(this),this.user=this.user.bind(this),this.usersPath="/autocomplete/users.json",this.userPath="/autocomplete/users/:id.json",null!=e&&("object"===(void 0===e?"undefined":u(e))?this.currentUser=e:this.currentUser=JSON.parse(e));var i,c=s.handleClick;a=n()(t),t||(a=n()(".js-user-search")),a.each((i=this,function(e,t){var a,s,u,f,h,p,m,b,v,g,w,k,y,C,j,_,x,L,I,$={};u=n()(t),$.projectId=u.data("projectId"),$.groupId=u.data("groupId"),$.showCurrentUser=u.data("currentUser"),$.todoFilter=u.data("todoFilter"),$.todoStateFilter=u.data("todoStateFilter"),L=u.data("nullUser"),k=u.data("nullUserDefault"),I=u.data("showMenuAbove"),x=u.data("anyUser"),y=u.data("firstUser"),$.authorId=u.data("authorId"),w=u.data("defaultLabel"),C=u.data("issueUpdate"),h=u.closest(".selectbox"),a=h.closest(".block"),m=u.data("abilityName"),p=a.find(".value"),s=a.find(".sidebar-collapsed-user"),f=a.find(".block-loading").fadeOut(),_=k&&L?0:null,void 0===(j=u.data("selected"))&&(j=_);var S=function(){var e=u.closest(".selectbox").find("input[name='"+u.data("fieldName")+"'][value=0]");e&&e.remove();var t=document.createElement("input");t.type="hidden",t.name=u.data("fieldName");var a=u.data("currentUserInfo");a?(t.value=a.id,t.dataset.meta=r.a.escape(a.name)):i.currentUser&&(t.value=i.currentUser.id),h?u.parent().before(t):u.after(t)};a[0]&&a[0].addEventListener("assignYourself",S);var U=function(){return h.find('input[name="'+u.data("fieldName")+'"]')},O=function(){return U().map(function(e,t){return parseInt(t.value,10)}).get()},D=function(){var e=u.data("maxSelect");if(e){var t=O();if(t.length>e){var a=t[0];u.closest(".selectbox").find("input[name='"+u.data("fieldName")+"'][value="+a+"]").remove(),emitSidebarEvent("sidebar.removeAssignee",{id:a})}}},E=function(e,t){var a=O().filter(function(e){return 0!==e}),s=U().map(function(e,t){return{name:t.dataset.meta,value:parseInt(t.value,10)}}).filter(function(e){return 0!==e.id}).get(0);if(0===a.length)return"Unassigned";if(1===a.length)return s.name;if(t){var n=a.filter(function(t){return t!==e.id});return e.name+" + "+n.length+" more"}return s.name+" + "+(a.length-1)+" more"};return n()(".assign-to-me-link").on("click",function(e){if(e.preventDefault(),n()(e.currentTarget).hide(),u.data("multiSelect")){S(),D();var t=u.data("currentUserInfo");u.find(".dropdown-toggle-text").text(E(t)).removeClass("is-default")}else{var a=n()('input[name="'+u.data("fieldName")+'"]');a.val(gon.current_user_id),j=a.val(),u.find(".dropdown-toggle-text").text(gon.current_user_fullname).removeClass("is-default")}}),a.on("click",".js-assign-yourself",function(e){return e.preventDefault(),b(i.currentUser.id)}),b=function(e){var t;return(t={})[m]={},t[m].assignee_id=null!=e?e:null,f.removeClass("hidden").fadeIn(),u.trigger("loading.gl.dropdown"),l.a.put(C,t).then(function(e){var t,a,n=e.data;return u.trigger("loaded.gl.dropdown"),f.fadeOut(),n.assignee?(t={name:n.assignee.name,username:n.assignee.username,avatar:n.assignee.avatar_url},a=r.a.escape(t.name)):(t={name:"Unassigned",username:"",avatar:""},a=Object(o.a)("Assignee")),p.html(v(t)),s.attr("title",a).tooltip("_fixTitle"),s.html(g(t))})},g=r.a.template('<% if( avatar ) { %> <a class="author-link" href="/<%- username %>"> <img width="24" class="avatar avatar-inline s24" alt="" src="<%- avatar %>"> </a> <% } else { %> <i class="fa fa-user"></i> <% } %>'),v=r.a.template('<% if (username) { %> <a class="author-link bold" href="/<%- username %>"> <% if( avatar ) { %> <img width="32" class="avatar avatar-inline s32" alt="" src="<%- avatar %>"> <% } %> <span class="author"><%- name %></span> <span class="username"> @<%- username %> </span> </a> <% } else { %> <span class="no-value assign-yourself"> No assignee - <a href="#" class="js-assign-yourself"> assign yourself </a> </span> <% } %>'),u.glDropdown({showMenuAbove:I,data:function(e,t){return i.users(e,$,function(a){(this.instance||this.options.instance).options.processData(e,a,t)}.bind(this))},processData:function(e,t,a){var s=t;if(u.hasClass("js-multiselect")&&0===e.length){var n=U(),i=r.a.uniq(n,!1,function(e){return e.value}).filter(function(e){var t=parseInt(e.value,10);return!s.find(function(e){return e.id===t})&&0!==t}).map(function(e){var t=parseInt(e.value,10),a=e.dataset,s=a.avatarUrl,n=a.avatar_url,i=a.name,r=a.username;return{avatar_url:s||n,id:t,name:i,username:r}});s=t.concat(i)}var l=void 0,o=void 0,d=void 0,c=void 0,f=void 0,h=void 0;if(0===e.length){if(h=0,y)for(o=0,d=s.length;o<d;o+=1)if((f=s[o]).username===y){s.splice(o,1),s.unshift(f);break}if(L&&(h+=1,s.unshift({beforeDivider:!0,name:"Unassigned",id:0})),x&&(h+=1,!0===(c=x)&&(c="Any User"),l={beforeDivider:!0,name:c,id:null},s.unshift(l)),h&&s.splice(h,0,"divider"),u.hasClass("js-multiselect")){var p=O().filter(function(e){return 0!==e});if(p.length>0){u.data("dropdownHeader")&&(h+=1,s.splice(h,0,{header:u.data("dropdownHeader")}));var m=s.filter(function(e){return-1!==p.indexOf(e.id)}).sort(function(e,t){return e.name>t.name});s=s.filter(function(e){return-1===p.indexOf(e.id)}),m.forEach(function(e){h+=1,s.splice(h,0,e)}),s.splice(h+1,0,"divider")}}}a(s),I&&u.data("glDropdown").positionMenuAbove()},filterable:!0,filterRemote:!0,search:{fields:["name","username"]},selectable:!0,fieldName:u.data("fieldName"),toggleLabel:function(e,t,a){var s=a.filterInput.val();if(this.multiSelect&&""===s){var i=a.filteredFullData(),r=a.parseData.bind(a);this.processData(s,i,r)}return this.multiSelect?E(e,n()(t).hasClass("is-active")):e&&"id"in e&&n()(t).hasClass("is-active")?(u.find(".dropdown-toggle-text").removeClass("is-default"),e.text?e.text:e.name):(u.find(".dropdown-toggle-text").addClass("is-default"),w)},defaultLabel:w,hidden:function(e){u.hasClass("js-multiselect")&&emitSidebarEvent("sidebar.saveAssignees"),u.data("alwaysShowSelectbox")||(h.hide(),a=h.closest(".block"),(p=a.find(".value")).css("display",""))},multiSelect:u.hasClass("js-multiselect"),inputMeta:u.data("inputMeta"),clicked:function(e){var t,a,s,i,r=e.$el,l=e.e,o=e.isMarking,f=e.selectedObj;if(u.hasClass("js-multiselect")){var h=r.hasClass("is-active"),p=u.closest(".selectbox").find("input[name='"+u.data("fieldName")+"'][value!=0]");if(D(),f.beforeDivider&&"unassigned"===f.name.toLowerCase())p.each(function(e,t){parseInt(t.value,10),t.remove()}),emitSidebarEvent("sidebar.removeAllAssignees");else if(h){emitSidebarEvent("sidebar.addAssignee",f);var m=u.closest(".selectbox").find("input[name='"+u.data("fieldName")+"'][value=0]");m&&m.remove()}else 0===p.length&&this.addInput(u.data("fieldName"),0,{}),emitSidebarEvent("sidebar.removeAssignee",f);O().find(function(e){return e===gon.current_user_id})?n()(".assign-to-me-link").hide():n()(".assign-to-me-link").show()}if(t="projects:issues:index"===(s=n()("body").attr("data-page")),a=s==s&&"projects:merge_requests:index"===s,u.hasClass("js-filter-bulk-update")||u.hasClass("js-issuable-form-dropdown")){l.preventDefault();var v=f.id!==j;(j=v?f.id:_)===gon.current_user_id?n()(".assign-to-me-link").hide():n()(".assign-to-me-link").show()}else{if(r.closest(".add-issues-modal").length)d.a.store.filter[u.data("fieldName")]=f.id;else if(c)l.preventDefault(),c(f,o);else{if(u.hasClass("js-filter-submit")&&(t||a))return Issuable.filterResults(u.closest("form"));if(u.hasClass("js-filter-submit"))return u.closest("form").submit();if(!u.hasClass("js-multiselect"))return i=u.closest(".selectbox").find("input[name='"+u.data("fieldName")+"']").val(),b(i)}u.data("maxSelect")&&O().length===u.data("maxSelect")&&u.dropdown("toggle")}},id:function(e){return e.id},opened:function(e){var t=n()(e.currentTarget),a=O();function s(e){t.find('li[data-user-id="'+e+'"] .dropdown-menu-user-link').addClass("is-active")}u.hasClass("js-issue-board-sidebar")&&0===a.length&&this.addInput(u.data("fieldName"),0,{}),t.find(".is-active").removeClass("is-active"),a.length>0?O().forEach(function(e){return s(e)}):u.hasClass("js-issue-board-sidebar")?s(0):s(j)},updateLabel:u.data("dropdownTitle"),renderRow:function(e){var t,a,s;s=e.username?"@"+e.username:"",t=e.avatar_url?e.avatar_url:gon.default_avatar_url;var n=!1;if(this.multiSelect){n=O().find(function(t){return e.id===t});var i=this.fieldName;u.closest(".selectbox").find("input[name='"+i+"'][value='"+e.id+"']").length&&(n=!0)}else n=e.id===j;return a="",null!=e.beforeDivider?r.a.escape(e.name):a="<img src='"+t+"' class='avatar avatar-inline' width='32' />","\n            <li data-user-id="+e.id+">\n              <a href='#' class='dropdown-menu-user-link "+(!0===n?"is-active":"")+"'>\n                "+a+"\n                <strong class='dropdown-menu-user-full-name'>\n                  "+r.a.escape(e.name)+"\n                </strong>\n                "+(s?"<span class='dropdown-menu-user-username'>"+s+"</span>":"")+"\n              </a>\n            </li>\n          "}})})),n()(".ajax-users-select").each(function(e){return function(t,a){var s,i,r,l,o={};return o.skipLdap=n()(a).hasClass("skip_ldap"),o.projectId=n()(a).data("projectId"),o.groupId=n()(a).data("groupId"),o.showCurrentUser=n()(a).data("currentUser"),o.authorId=n()(a).data("authorId"),o.skipUsers=n()(a).data("skipUsers"),l=n()(a).data("nullUser"),i=n()(a).data("anyUser"),r=n()(a).data("emailUser"),s=n()(a).data("firstUser"),n()(a).select2({placeholder:"Search for a user",multiple:n()(a).hasClass("multiselect"),minimumInputLength:0,query:function(t){return e.users(t.term,o,function(e){var a,n,o,d,u,c,f,h,p;if(n={results:e},0===t.term.length){if(s)for(d=0,u=(p=n.results).length;d<u;d+=1)if((h=p[d]).username===s){n.results.splice(d,1),n.results.unshift(h);break}l&&(f={name:"Unassigned",id:0},n.results.unshift(f)),i&&(!0===(c=i)&&(c="Any User"),a={name:c,id:null},n.results.unshift(a))}if(r&&0===n.results.length&&t.term.match(/^[^@]+@[^@]+$/)){var m=t.term.trim();o={name:'Invite "'+t.term+'" by email',username:m,id:m,invite:!0},n.results.unshift(o)}return t.callback(n)})},initSelection:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.initSelection.apply(e,t)},formatResult:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.formatResult.apply(e,t)},formatSelection:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.formatSelection.apply(e,t)},dropdownCssClass:"ajax-users-dropdown",escapeMarkup:function(e){return e}})}}(this))}window.emitSidebarEvent=window.emitSidebarEvent||n.a.noop,c.prototype.initSelection=function(e,t){var a;return"0"===(a=n()(e).val())?t({name:"Unassigned"}):""!==a?this.user(a,t):void 0},c.prototype.formatResult=function(e){var t;return t=e.avatar_url?e.avatar_url:gon.default_avatar_url,"<div class='user-result "+(e.username?void 0:"no-username")+"'> <div class='user-image'><img class='avatar avatar-inline s32' src='"+t+"'></div> <div class='user-name dropdown-menu-user-full-name'>"+r.a.escape(e.name)+"</div> <div class='user-username dropdown-menu-user-username'>"+(e.invite?"":"@"+r.a.escape(e.username))+"</div> </div>"},c.prototype.formatSelection=function(e){return r.a.escape(e.name)},c.prototype.user=function(e,t){return!!/^\d+$/.test(e)&&(a=(a=this.buildUrl(this.userPath)).replace(":id",e),l.a.get(a).then(function(e){var a=e.data;t(a)}));var a},c.prototype.users=function(e,t,a){var s=this.buildUrl(this.usersPath),n={search:e,active:!0,project_id:t.projectId||null,group_id:t.groupId||null,skip_ldap:t.skipLdap||null,todo_filter:t.todoFilter||null,todo_state_filter:t.todoStateFilter||null,current_user:t.showCurrentUser||null,author_id:t.authorId||null,skip_users:t.skipUsers||null};return l.a.get(s,{params:n}).then(function(e){var t=e.data;a(t)})},c.prototype.buildUrl=function(e){return null!=gon.relative_url_root&&(e=gon.relative_url_root.replace(/\/$/,"")+e),e},t.a=c}}]);
//# sourceMappingURL=commons~pages.dashboard.issues~pages.dashboard.merge_requests~pages.groups.boards~pages.projects.iss~2716c7a5.7e5a63d9.chunk.js.map