{"version":3,"sources":["webpack:///./blob/sketch/index.js","webpack:///./blob/sketch_viewer.js"],"names":["SketchLoader","container","_classCallCheck","this","loadingIcon","querySelector","load","_this","getZipFile","then","data","lib_default","a","loadAsync","asyncResult","files","async","content","url","window","URL","webkitURL","blob","Blob","Uint8Array","type","previewUrl","createObjectURL","render","catch","error","bind","_this2","external","Promise","resolve","reject","jszip_utils_lib_default","getBinaryContent","dataset","endpoint","err","previewLink","document","createElement","previewImage","href","target","src","className","appendChild","removeLoadingIcon","errorMsg","textContent","remove","__webpack_exports__","el","getElementById","sketch"],"mappings":"8YAIE,SAAAA,EAAYC,gGAAWC,CAAAC,KAAAH,GACrBG,KAAKF,UAAYA,EACjBE,KAAKC,YAAcD,KAAKF,UAAUI,cAAc,oBAEhDF,KAAKG,gDAGA,IAAAC,EAAAJ,KACL,OAAOA,KAAKK,aACTC,KAAK,SAAAC,GAAA,OAAQC,EAAAC,EAAMC,UAAUH,KAC7BD,KAAK,SAAAK,GAAA,OAAeA,EAAYC,MAAM,wBAAwBC,MAAM,gBACpEP,KAAK,SAACQ,GACL,IAAMC,EAAMC,OAAOC,KAAOD,OAAOE,UAC3BC,EAAO,IAAIC,MAAM,IAAIC,WAAWP,KACpCQ,KAAM,cAEFC,EAAaR,EAAIS,gBAAgBL,GAEvCf,EAAKqB,OAAOF,KAEbG,MAAM1B,KAAK2B,MAAMC,KAAK5B,4CAGd,IAAA6B,EAAA7B,KACX,OAAO,IAAIQ,EAAAC,EAAMqB,SAASC,QAAQ,SAACC,EAASC,GAC1CC,EAAAzB,EAAW0B,iBAAiBN,EAAK/B,UAAUsC,QAAQC,SAAU,SAACC,EAAK/B,GAC7D+B,EACFL,EAAOK,GAEPN,EAAQzB,sCAMTgB,GACL,IAAMgB,EAAcC,SAASC,cAAc,KACrCC,EAAeF,SAASC,cAAc,OAE5CF,EAAYI,KAAOpB,EACnBgB,EAAYK,OAAS,SACrBF,EAAaG,IAAMtB,EACnBmB,EAAaI,UAAY,YAEzBP,EAAYQ,YAAYL,GACxB1C,KAAKF,UAAUiD,YAAYR,GAE3BvC,KAAKgD,oDAIL,IAAMC,EAAWT,SAASC,cAAc,KAExCQ,EAASH,UAAY,wDACrBG,EAASC,YAAT,oJAIAlD,KAAKF,UAAUiD,YAAYE,GAE3BjD,KAAKgD,gEAIDhD,KAAKC,aACPD,KAAKC,YAAYkD,kBClEvBC,EAAA,mBACE,IAAMC,EAAKb,SAASc,eAAe,oBAEnC,IAAIC,EAAaF","file":"sketch_viewer.e94b227f.chunk.js","sourcesContent":["import JSZip from 'jszip';\nimport JSZipUtils from 'jszip-utils';\n\nexport default class SketchLoader {\n  constructor(container) {\n    this.container = container;\n    this.loadingIcon = this.container.querySelector('.js-loading-icon');\n\n    this.load();\n  }\n\n  load() {\n    return this.getZipFile()\n      .then(data => JSZip.loadAsync(data))\n      .then(asyncResult => asyncResult.files['previews/preview.png'].async('uint8array'))\n      .then((content) => {\n        const url = window.URL || window.webkitURL;\n        const blob = new Blob([new Uint8Array(content)], {\n          type: 'image/png',\n        });\n        const previewUrl = url.createObjectURL(blob);\n\n        this.render(previewUrl);\n      })\n      .catch(this.error.bind(this));\n  }\n\n  getZipFile() {\n    return new JSZip.external.Promise((resolve, reject) => {\n      JSZipUtils.getBinaryContent(this.container.dataset.endpoint, (err, data) => {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(data);\n        }\n      });\n    });\n  }\n\n  render(previewUrl) {\n    const previewLink = document.createElement('a');\n    const previewImage = document.createElement('img');\n\n    previewLink.href = previewUrl;\n    previewLink.target = '_blank';\n    previewImage.src = previewUrl;\n    previewImage.className = 'img-fluid';\n\n    previewLink.appendChild(previewImage);\n    this.container.appendChild(previewLink);\n\n    this.removeLoadingIcon();\n  }\n\n  error() {\n    const errorMsg = document.createElement('p');\n\n    errorMsg.className = 'prepend-top-default append-bottom-default text-center';\n    errorMsg.textContent = `\n      Cannot show preview. For previews on sketch files, they must have the file format\n      introduced by Sketch version 43 and above.\n    `;\n    this.container.appendChild(errorMsg);\n\n    this.removeLoadingIcon();\n  }\n\n  removeLoadingIcon() {\n    if (this.loadingIcon) {\n      this.loadingIcon.remove();\n    }\n  }\n}\n","/* eslint-disable no-new */\nimport SketchLoader from './sketch';\n\nexport default () => {\n  const el = document.getElementById('js-sketch-viewer');\n\n  new SketchLoader(el);\n};\n"],"sourceRoot":""}