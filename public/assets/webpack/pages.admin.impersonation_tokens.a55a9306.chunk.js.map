{"version":3,"sources":["webpack:///./due_date_select.js","webpack:///./pages/admin/impersonation_tokens/index.js","webpack:///./pages/admin/admin.js","webpack:///./pages/admin/index.js"],"names":["DueDateSelect","_ref","arguments","length","undefined","$dropdown","$loading","_classCallCheck","this","$dropdownParent","closest","$block","$datePicker","find","$sidebarCollapsedValue","$selectbox","$value","$valueContent","$sidebarValue","jquery__WEBPACK_IMPORTED_MODULE_0___default","fieldName","data","abilityName","issueUpdateURL","rawSelectedDate","displayedDate","datePayload","initGlDropdown","initRemoveDueDate","initDatePicker","_this","glDropdown","opened","show","hidden","hide","css","_this2","$dueDateInput","$","calendar","pikaday__WEBPACK_IMPORTED_MODULE_1___default","a","field","get","theme","format","parse","dateString","Object","_lib_utils_datefix__WEBPACK_IMPORTED_MODULE_6__","toString","date","onSelect","dateText","val","hasClass","gl","issueBoards","BoardsStore","detail","issue","dueDate","updateIssueBoardIssue","saveDueDate","setDate","append","el","_this3","on","e","preventDefault","isDropdown","parseSelectedDate","prepSelectedDate","submitSelectedDate","dateArray","split","map","v","parseInt","dateObj","Date","dateformat__WEBPACK_IMPORTED_MODULE_2___default","due_date","_this4","fadeIn","trigger","fadeOutLoader","fadeOut","update","attr","then","catch","_this5","selectedDateValue","hasDueDate","displayedDateStyle","removeClass","html","toggleClass","_lib_utils_axios_utils__WEBPACK_IMPORTED_MODULE_4__","put","tooltipText","_locale__WEBPACK_IMPORTED_MODULE_3__","_lib_utils_datetime_utility__WEBPACK_IMPORTED_MODULE_5__","dropdown","DueDateSelectors","initMilestoneDatePicker","initIssuableSelect","each","datePickerVal","container","parent","target","siblings","i","document","addEventListener","_due_date_select__WEBPACK_IMPORTED_MODULE_0__","showBlacklistType","jquery_default","modal","$elems","prop","tab","$visibleLog","animate","scrollTop","height","url_utility"],"mappings":"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","file":"pages.admin.impersonation_tokens.a55a9306.chunk.js","sourcesContent":["import $ from 'jquery';\nimport Pikaday from 'pikaday';\nimport dateFormat from 'dateformat';\nimport { __ } from '~/locale';\nimport axios from './lib/utils/axios_utils';\nimport { timeFor } from './lib/utils/datetime_utility';\nimport { parsePikadayDate, pikadayToString } from './lib/utils/datefix';\n\nclass DueDateSelect {\n  constructor({ $dropdown, $loading } = {}) {\n    const $dropdownParent = $dropdown.closest('.dropdown');\n    const $block = $dropdown.closest('.block');\n    this.$loading = $loading;\n    this.$dropdown = $dropdown;\n    this.$dropdownParent = $dropdownParent;\n    this.$datePicker = $dropdownParent.find('.js-due-date-calendar');\n    this.$block = $block;\n    this.$sidebarCollapsedValue = $block.find('.sidebar-collapsed-icon');\n    this.$selectbox = $dropdown.closest('.selectbox');\n    this.$value = $block.find('.value');\n    this.$valueContent = $block.find('.value-content');\n    this.$sidebarValue = $('.js-due-date-sidebar-value', $block);\n    this.fieldName = $dropdown.data('fieldName');\n    this.abilityName = $dropdown.data('abilityName');\n    this.issueUpdateURL = $dropdown.data('issueUpdate');\n\n    this.rawSelectedDate = null;\n    this.displayedDate = null;\n    this.datePayload = null;\n\n    this.initGlDropdown();\n    this.initRemoveDueDate();\n    this.initDatePicker();\n  }\n\n  initGlDropdown() {\n    this.$dropdown.glDropdown({\n      opened: () => {\n        const calendar = this.$datePicker.data('pikaday');\n        calendar.show();\n      },\n      hidden: () => {\n        this.$selectbox.hide();\n        this.$value.css('display', '');\n      },\n    });\n  }\n\n  initDatePicker() {\n    const $dueDateInput = $(`input[name='${this.fieldName}']`);\n    const calendar = new Pikaday({\n      field: $dueDateInput.get(0),\n      theme: 'gitlab-theme',\n      format: 'yyyy-mm-dd',\n      parse: dateString => parsePikadayDate(dateString),\n      toString: date => pikadayToString(date),\n      onSelect: dateText => {\n        $dueDateInput.val(calendar.toString(dateText));\n\n        if (this.$dropdown.hasClass('js-issue-boards-due-date')) {\n          gl.issueBoards.BoardsStore.detail.issue.dueDate = $dueDateInput.val();\n          this.updateIssueBoardIssue();\n        } else {\n          this.saveDueDate(true);\n        }\n      },\n    });\n\n    calendar.setDate(parsePikadayDate($dueDateInput.val()));\n    this.$datePicker.append(calendar.el);\n    this.$datePicker.data('pikaday', calendar);\n  }\n\n  initRemoveDueDate() {\n    this.$block.on('click', '.js-remove-due-date', e => {\n      const calendar = this.$datePicker.data('pikaday');\n      e.preventDefault();\n\n      calendar.setDate(null);\n\n      if (this.$dropdown.hasClass('js-issue-boards-due-date')) {\n        gl.issueBoards.BoardsStore.detail.issue.dueDate = '';\n        this.updateIssueBoardIssue();\n      } else {\n        $(`input[name='${this.fieldName}']`).val('');\n        this.saveDueDate(false);\n      }\n    });\n  }\n\n  saveDueDate(isDropdown) {\n    this.parseSelectedDate();\n    this.prepSelectedDate();\n    this.submitSelectedDate(isDropdown);\n  }\n\n  parseSelectedDate() {\n    this.rawSelectedDate = $(`input[name='${this.fieldName}']`).val();\n\n    if (this.rawSelectedDate.length) {\n      // Construct Date object manually to avoid buggy dateString support within Date constructor\n      const dateArray = this.rawSelectedDate.split('-').map(v => parseInt(v, 10));\n      const dateObj = new Date(dateArray[0], dateArray[1] - 1, dateArray[2]);\n      this.displayedDate = dateFormat(dateObj, 'mmm d, yyyy');\n    } else {\n      this.displayedDate = 'No due date';\n    }\n  }\n\n  prepSelectedDate() {\n    const datePayload = {};\n    datePayload[this.abilityName] = {};\n    datePayload[this.abilityName].due_date = this.rawSelectedDate;\n    this.datePayload = datePayload;\n  }\n\n  updateIssueBoardIssue() {\n    this.$loading.fadeIn();\n    this.$dropdown.trigger('loading.gl.dropdown');\n    this.$selectbox.hide();\n    this.$value.css('display', '');\n    const fadeOutLoader = () => {\n      this.$loading.fadeOut();\n    };\n\n    gl.issueBoards.BoardsStore.detail.issue\n      .update(this.$dropdown.attr('data-issue-update'))\n      .then(fadeOutLoader)\n      .catch(fadeOutLoader);\n  }\n\n  submitSelectedDate(isDropdown) {\n    const selectedDateValue = this.datePayload[this.abilityName].due_date;\n    const hasDueDate = this.displayedDate !== 'No due date';\n    const displayedDateStyle = hasDueDate ? 'bold' : 'no-value';\n\n    this.$loading.removeClass('hidden').fadeIn();\n\n    if (isDropdown) {\n      this.$dropdown.trigger('loading.gl.dropdown');\n      this.$selectbox.hide();\n    }\n\n    this.$value.css('display', '');\n    this.$valueContent.html(`<span class='${displayedDateStyle}'>${this.displayedDate}</span>`);\n    this.$sidebarValue.html(this.displayedDate);\n\n    $('.js-remove-due-date-holder').toggleClass('hidden', selectedDateValue.length);\n\n    return axios.put(this.issueUpdateURL, this.datePayload).then(() => {\n      const tooltipText = hasDueDate\n        ? `${__('Due date')}<br />${selectedDateValue} (${timeFor(selectedDateValue)})`\n        : __('Due date');\n      if (isDropdown) {\n        this.$dropdown.trigger('loaded.gl.dropdown');\n        this.$dropdown.dropdown('toggle');\n      }\n      this.$sidebarCollapsedValue.attr('data-original-title', tooltipText);\n\n      return this.$loading.fadeOut();\n    });\n  }\n}\n\nexport default class DueDateSelectors {\n  constructor() {\n    this.initMilestoneDatePicker();\n    this.initIssuableSelect();\n  }\n  // eslint-disable-next-line class-methods-use-this\n  initMilestoneDatePicker() {\n    $('.datepicker').each(function initPikadayMilestone() {\n      const $datePicker = $(this);\n      const datePickerVal = $datePicker.val();\n\n      const calendar = new Pikaday({\n        field: $datePicker.get(0),\n        theme: 'gitlab-theme animate-picker',\n        format: 'yyyy-mm-dd',\n        container: $datePicker.parent().get(0),\n        parse: dateString => parsePikadayDate(dateString),\n        toString: date => pikadayToString(date),\n        onSelect(dateText) {\n          $datePicker.val(calendar.toString(dateText));\n        },\n      });\n\n      calendar.setDate(parsePikadayDate(datePickerVal));\n\n      $datePicker.data('pikaday', calendar);\n    });\n\n    $('.js-clear-due-date,.js-clear-start-date').on('click', e => {\n      e.preventDefault();\n      const calendar = $(e.target)\n        .siblings('.datepicker')\n        .data('pikaday');\n      calendar.setDate(null);\n    });\n  }\n  // eslint-disable-next-line class-methods-use-this\n  initIssuableSelect() {\n    const $loading = $('.js-issuable-update .due_date')\n      .find('.block-loading')\n      .hide();\n\n    $('.js-due-date-select').each((i, dropdown) => {\n      const $dropdown = $(dropdown);\n      // eslint-disable-next-line no-new\n      new DueDateSelect({\n        $dropdown,\n        $loading,\n      });\n    });\n  }\n}\n","import DueDateSelectors from '~/due_date_select';\n\ndocument.addEventListener('DOMContentLoaded', () => new DueDateSelectors());\n","import $ from 'jquery';\nimport { refreshCurrentPage } from '../../lib/utils/url_utility';\n\nfunction showBlacklistType() {\n  if ($('input[name=\"blacklist_type\"]:checked').val() === 'file') {\n    $('.blacklist-file').show();\n    $('.blacklist-raw').hide();\n  } else {\n    $('.blacklist-file').hide();\n    $('.blacklist-raw').show();\n  }\n}\n\nexport default function adminInit() {\n  const modal = $('.change-owner-holder');\n\n  $('input#user_force_random_password').on('change', function randomPasswordClick() {\n    const $elems = $('#user_password, #user_password_confirmation');\n    if ($(this).attr('checked')) {\n      $elems.val('').prop('disabled', true);\n    } else {\n      $elems.prop('disabled', false);\n    }\n  });\n\n  $('body').on('click', '.js-toggle-colors-link', (e) => {\n    e.preventDefault();\n    $('.js-toggle-colors-container').toggleClass('hide');\n  });\n\n  $('.log-tabs a').on('click', function logTabsClick(e) {\n    e.preventDefault();\n    $(this).tab('show');\n  });\n\n  $('.log-bottom').on('click', (e) => {\n    e.preventDefault();\n    const $visibleLog = $('.file-content:visible');\n    $visibleLog.animate({\n      scrollTop: $visibleLog.find('ol').height(),\n    }, 'fast');\n  });\n\n  $('.change-owner-link').on('click', function changeOwnerLinkClick(e) {\n    e.preventDefault();\n    $(this).hide();\n    modal.show();\n  });\n\n  $('.change-owner-cancel-link').on('click', (e) => {\n    e.preventDefault();\n    modal.hide();\n    $('.change-owner-link').show();\n  });\n\n  $('li.project_member, li.group_member').on('ajax:success', refreshCurrentPage);\n\n  $(\"input[name='blacklist_type']\").on('click', showBlacklistType);\n  showBlacklistType();\n}\n","import initAdmin from './admin';\n\ndocument.addEventListener('DOMContentLoaded', initAdmin);\n"],"sourceRoot":""}