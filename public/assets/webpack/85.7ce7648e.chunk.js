(this.webpackJsonp=this.webpackJsonp||[]).push([[85],{2012:function(e,t,r){"use strict";r.r(t);var s=r(0),i=r.n(s),n={components:{GlModal:r(95).a},props:{currentRequest:{type:Object,required:!0},metric:{type:String,required:!0},header:{type:String,required:!0},details:{type:String,required:!0},keys:{type:Array,required:!0}},computed:{metricDetails:function(){return this.currentRequest.details[this.metric]},detailsList:function(){return this.metricDetails[this.details]}}},a=r(2),l=Object(a.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.currentRequest.details?r("div",{staticClass:"view",attrs:{id:"peek-view-"+e.metric}},[r("button",{staticClass:"btn-blank btn-link bold",attrs:{"data-target":"#modal-peek-"+e.metric+"-details",type:"button","data-toggle":"modal"}},[e._v("\n    "+e._s(e.metricDetails.duration)+"\n    /\n    "+e._s(e.metricDetails.calls)+"\n  ")]),e._v(" "),r("gl-modal",{staticClass:"performance-bar-modal",attrs:{id:"modal-peek-"+e.metric+"-details","header-title-text":e.header,"modal-size":"xl"}},[r("table",{staticClass:"table"},[e.detailsList.length?e._l(e.detailsList,function(t,s){return r("tr",{key:s},[r("td",[r("strong",[e._v(e._s(t.duration)+"ms")])]),e._v(" "),e._l(e.keys,function(s){return r("td",{key:s,staticClass:"break-word"},[e._v("\n            "+e._s(t[s])+"\n          ")])})],2)}):[r("tr",[r("td",[e._v("\n            No "+e._s(e.header.toLowerCase())+" for this request.\n          ")])])]],2),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"})]),e._v("\n  "+e._s(e.metric)+"\n")],1):e._e()},[],!1,null,null,null).exports,u={props:{currentRequest:{type:Object,required:!0},requests:{type:Array,required:!0}},data:function(){return{currentRequestId:this.currentRequest.id}},watch:{currentRequestId:function(e){this.$emit("change-current-request",e)}},methods:{truncatedUrl:function(e){var t=e.replace(/\/$/,"").split("/"),r=t[t.length-1];return r.match(/^\d+$/)&&(r=t[t.length-2]+"/"+r),r}}},o=Object(a.a)(u,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"peek-request-selector"}},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.currentRequestId,expression:"currentRequestId"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.currentRequestId=t.target.multiple?r:r[0]}}},e._l(e.requests,function(t){return r("option",{key:t.id,domProps:{value:t.id}},[e._v("\n      "+e._s(e.truncatedUrl(t.url))+"\n    ")])}))])},[],!1,null,null,null).exports,d={props:{currentRequest:{type:Object,required:!0},metric:{type:String,required:!0}}},c={components:{detailedMetric:l,requestSelector:o,simpleMetric:Object(a.a)(d,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"view",attrs:{id:"peek-view-"+e.metric}},[e.currentRequest.details?r("span",{staticClass:"bold"},[e._v("\n    "+e._s(e.currentRequest.details[e.metric].duration)+"\n    /\n    "+e._s(e.currentRequest.details[e.metric].calls)+"\n  ")]):e._e(),e._v("\n  "+e._s(e.metric)+"\n")])},[],!1,null,null,null).exports},props:{store:{type:Object,required:!0},env:{type:String,required:!0},requestId:{type:String,required:!0},peekUrl:{type:String,required:!0},profileUrl:{type:String,required:!0}},detailedMetrics:[{metric:"pg",header:"SQL queries",details:"queries",keys:["sql"]},{metric:"gitaly",header:"Gitaly calls",details:"details",keys:["feature","request"]}],simpleMetrics:["redis","sidekiq"],data:function(){return{currentRequestId:""}},computed:{requests:function(){return this.store.requestsWithDetails()},currentRequest:{get:function(){return this.store.findRequest(this.currentRequestId)},set:function(e){this.currentRequestId=e}},initialRequest:function(){return this.currentRequestId===this.requestId},lineProfileModal:function(){return i()("#modal-peek-line-profile")}},mounted:function(){this.currentRequest=this.requestId,this.lineProfileModal.length&&this.lineProfileModal.modal("toggle")},methods:{changeCurrentRequest:function(e){this.currentRequest=e}}},m=Object(a.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.env,attrs:{id:"js-peek"}},[e.currentRequest?r("div",{staticClass:"d-flex container-fluid container-limited"},[r("div",{staticClass:"view",attrs:{id:"peek-view-host"}},[e.currentRequest.details?r("span",{staticClass:"current-host"},[e._v("\n        "+e._s(e.currentRequest.details.host.hostname)+"\n      ")]):e._e()]),e._v(" "),e._l(e.$options.detailedMetrics,function(t){return r("detailed-metric",{key:t.metric,attrs:{"current-request":e.currentRequest,metric:t.metric,header:t.header,details:t.details,keys:t.keys}})}),e._v(" "),e.initialRequest?r("div",{staticClass:"view",attrs:{id:"peek-view-rblineprof"}},[e.lineProfileModal.length?r("button",{staticClass:"btn-link btn-blank",attrs:{"data-toggle":"modal","data-target":"#modal-peek-line-profile"}},[e._v("\n        profile\n      ")]):r("a",{attrs:{href:e.profileUrl}},[e._v("\n        profile\n      ")])]):e._e(),e._v(" "),e._l(e.$options.simpleMetrics,function(t){return r("simple-metric",{key:t,attrs:{"current-request":e.currentRequest,metric:t}})}),e._v(" "),r("div",{staticClass:"view",attrs:{id:"peek-view-gc"}},[e.currentRequest.details?r("span",{staticClass:"bold"},[r("span",{attrs:{title:"Invoke Time"}},[e._v(e._s(e.currentRequest.details.gc.gc_time))]),e._v("ms\n        /\n        "),r("span",{attrs:{title:"Invoke Count"}},[e._v(e._s(e.currentRequest.details.gc.invokes))]),e._v("\n        gc\n      ")]):e._e()]),e._v(" "),e.currentRequest?r("request-selector",{staticClass:"ml-auto",attrs:{"current-request":e.currentRequest,requests:e.requests},on:{"change-current-request":e.changeCurrentRequest}}):e._e()],2):e._e()])},[],!1,null,null,null);t.default=m.exports},95:function(e,t,r){"use strict";var s=r(0),i=r.n(s),n=["danger","primary","success","warning"],a=["sm","md","lg","xl"],l={name:"GlModal",props:{id:{type:String,required:!1,default:null},modalSize:{type:String,required:!1,default:"md",validator:function(e){return a.includes(e)}},headerTitleText:{type:String,required:!1,default:""},footerPrimaryButtonVariant:{type:String,required:!1,default:"primary",validator:function(e){return n.includes(e)}},footerPrimaryButtonText:{type:String,required:!1,default:""}},computed:{modalSizeClass:function(){return"md"===this.modalSize?"":"modal-"+this.modalSize}},mounted:function(){i()(this.$el).on("shown.bs.modal",this.opened).on("hidden.bs.modal",this.closed)},beforeDestroy:function(){i()(this.$el).off("shown.bs.modal",this.opened).off("hidden.bs.modal",this.closed)},methods:{emitCancel:function(e){this.$emit("cancel",e)},emitSubmit:function(e){this.$emit("submit",e)},opened:function(){this.$emit("open")},closed:function(){this.$emit("closed")}}},u=r(2),o=Object(u.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal fade",attrs:{id:e.id,tabindex:"-1",role:"dialog"}},[r("div",{staticClass:"modal-dialog",class:e.modalSizeClass,attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[e._t("header",[r("h4",{staticClass:"modal-title"},[e._t("title",[e._v("\n              "+e._s(e.headerTitleText)+"\n            ")])],2),e._v(" "),r("button",{staticClass:"close js-modal-close-action",attrs:{"aria-label":e.s__("Modal|Close"),type:"button","data-dismiss":"modal"},on:{click:function(t){e.emitCancel(t)}}},[r("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])])])],2),e._v(" "),r("div",{staticClass:"modal-body"},[e._t("default")],2),e._v(" "),r("div",{staticClass:"modal-footer"},[e._t("footer",[r("button",{staticClass:"btn js-modal-cancel-action",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(t){e.emitCancel(t)}}},[e._v("\n            "+e._s(e.s__("Modal|Cancel"))+"\n          ")]),e._v(" "),r("button",{staticClass:"btn js-modal-primary-action",class:"btn-"+e.footerPrimaryButtonVariant,attrs:{type:"button","data-dismiss":"modal"},on:{click:function(t){e.emitSubmit(t)}}},[e._v("\n            "+e._s(e.footerPrimaryButtonText)+"\n          ")])])],2)])])])},[],!1,null,null,null);t.a=o.exports}}]);
//# sourceMappingURL=85.7ce7648e.chunk.js.map