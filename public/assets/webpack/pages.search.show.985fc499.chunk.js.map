{"version":3,"sources":["webpack:///./pages/search/show/search.js","webpack:///./pages/search/show/index.js"],"names":["Search","_this","this","_classCallCheck","$groupDropdown","jquery_default","$projectDropdown","searchInput","searchClear","groupId","data","eventListeners","glDropdown","selectable","filterable","filterRemote","fieldName","search","fields","term","callback","api","groups","unshift","full_name","splice","id","obj","text","toggleLabel","clicked","submitSearch","getProjectsData","then","name_with_namespace","catch","flash","document","off","on","searchKeyUp","clearSearchField","bind","val","addClass","removeClass","trigger","focus","_this2","Promise","resolve","groupProjects","projects","order_by","submit","addEventListener"],"mappings":"uYAKE,SAAAA,IAAc,IAAAC,EAAAC,kGAAAC,CAAAD,KAAAF,GACZ,IAAMI,EAAiBC,IAAE,6BACnBC,EAAmBD,IAAE,+BAE3BH,KAAKK,YAAc,mBACnBL,KAAKM,YAAc,mBAEnBN,KAAKO,QAAUL,EAAeM,KAAK,WACnCR,KAAKS,iBAELP,EAAeQ,YACbC,YAAY,EACZC,YAAY,EACZC,cAAc,EACdC,UAAW,WACXC,QACEC,QAAS,cAEXR,KARwB,SAQnBS,EAAMC,GACT,OAAOC,EAAA,EAAIC,OAAOH,KAAU,SAACT,GAK3B,OAJAA,EAAKa,SACHC,UAAW,QAEbd,EAAKe,OAAO,EAAG,EAAG,WACXL,EAASV,MAGpBgB,GAjBwB,SAiBrBC,GACD,OAAOA,EAAID,IAEbE,KApBwB,SAoBnBD,GACH,OAAOA,EAAIH,WAEbK,YAvBwB,SAuBZF,GACV,OAAWvB,EAAeM,KAAK,gBAA/B,IAAmDiB,EAAIH,WAEzDM,QAAS,kBAAM9B,EAAO+B,kBAGxBzB,EAAiBM,YACfC,YAAY,EACZC,YAAY,EACZC,cAAc,EACdC,UAAW,aACXC,QACEC,QAAS,SAEXR,KAAM,SAACS,EAAMC,GACXnB,EAAK+B,gBAAgBb,GAClBc,KAAK,SAACvB,GAML,OALAA,EAAKa,SACHW,oBAAqB,QAEvBxB,EAAKe,OAAO,EAAG,EAAG,WAEXf,IAERuB,KAAK,SAAAvB,GAAA,OAAQU,EAASV,KACtByB,MAAM,kBAAM,IAAIC,EAAA,EAAM,8BAE3BV,GArB0B,SAqBvBC,GACD,OAAOA,EAAID,IAEbE,KAxB0B,SAwBrBD,GACH,OAAOA,EAAIO,qBAEbL,YA3B0B,SA2BdF,GACV,OAAWrB,EAAiBI,KAAK,gBAAjC,IAAqDiB,EAAIO,qBAE3DJ,QAAS,kBAAM9B,EAAO+B,qEAKxB1B,IAAEgC,UACCC,IAAI,QAASpC,KAAKK,aAClBgC,GAAG,QAASrC,KAAKK,YAAaL,KAAKsC,aACtCnC,IAAEgC,UACCC,IAAI,QAASpC,KAAKM,aAClB+B,GAAG,QAASrC,KAAKM,YAAaN,KAAKuC,iBAAiBC,KAAKxC,6CASvC,KADNG,IAAEH,MACNyC,MACTtC,IAAE,oBAAoBuC,SAAS,UAE/BvC,IAAE,oBAAoBwC,YAAY,qDAKpC,OAAOxC,IAAEH,KAAKK,aAAaoC,IAAI,IAAIG,QAAQ,SAASC,gDAGtC5B,GAAM,IAAA6B,EAAA9C,KACpB,OAAO,IAAI+C,QAAQ,SAACC,GACdF,EAAKvC,QACPY,EAAA,EAAI8B,cAAcH,EAAKvC,QAASU,KAAU+B,GAE1C7B,EAAA,EAAI+B,SAASjC,GACXkC,SAAU,MACTH,8CAvBP,OAAO7C,IAAE,mBAAmBiD,kBCtFhCjB,SAASkB,iBAAiB,mBAAoB,kBAAM,IAAItC","file":"pages.search.show.985fc499.chunk.js","sourcesContent":["import $ from 'jquery';\nimport Flash from '~/flash';\nimport Api from '~/api';\n\nexport default class Search {\n  constructor() {\n    const $groupDropdown = $('.js-search-group-dropdown');\n    const $projectDropdown = $('.js-search-project-dropdown');\n\n    this.searchInput = '.js-search-input';\n    this.searchClear = '.js-search-clear';\n\n    this.groupId = $groupDropdown.data('groupId');\n    this.eventListeners();\n\n    $groupDropdown.glDropdown({\n      selectable: true,\n      filterable: true,\n      filterRemote: true,\n      fieldName: 'group_id',\n      search: {\n        fields: ['full_name'],\n      },\n      data(term, callback) {\n        return Api.groups(term, {}, (data) => {\n          data.unshift({\n            full_name: 'Any',\n          });\n          data.splice(1, 0, 'divider');\n          return callback(data);\n        });\n      },\n      id(obj) {\n        return obj.id;\n      },\n      text(obj) {\n        return obj.full_name;\n      },\n      toggleLabel(obj) {\n        return `${($groupDropdown.data('defaultLabel'))} ${obj.full_name}`;\n      },\n      clicked: () => Search.submitSearch(),\n    });\n\n    $projectDropdown.glDropdown({\n      selectable: true,\n      filterable: true,\n      filterRemote: true,\n      fieldName: 'project_id',\n      search: {\n        fields: ['name'],\n      },\n      data: (term, callback) => {\n        this.getProjectsData(term)\n          .then((data) => {\n            data.unshift({\n              name_with_namespace: 'Any',\n            });\n            data.splice(1, 0, 'divider');\n\n            return data;\n          })\n          .then(data => callback(data))\n          .catch(() => new Flash('Error fetching projects'));\n      },\n      id(obj) {\n        return obj.id;\n      },\n      text(obj) {\n        return obj.name_with_namespace;\n      },\n      toggleLabel(obj) {\n        return `${($projectDropdown.data('defaultLabel'))} ${obj.name_with_namespace}`;\n      },\n      clicked: () => Search.submitSearch(),\n    });\n  }\n\n  eventListeners() {\n    $(document)\n      .off('keyup', this.searchInput)\n      .on('keyup', this.searchInput, this.searchKeyUp);\n    $(document)\n      .off('click', this.searchClear)\n      .on('click', this.searchClear, this.clearSearchField.bind(this));\n  }\n\n  static submitSearch() {\n    return $('.js-search-form').submit();\n  }\n\n  searchKeyUp() {\n    const $input = $(this);\n    if ($input.val() === '') {\n      $('.js-search-clear').addClass('hidden');\n    } else {\n      $('.js-search-clear').removeClass('hidden');\n    }\n  }\n\n  clearSearchField() {\n    return $(this.searchInput).val('').trigger('keyup').focus();\n  }\n\n  getProjectsData(term) {\n    return new Promise((resolve) => {\n      if (this.groupId) {\n        Api.groupProjects(this.groupId, term, {}, resolve);\n      } else {\n        Api.projects(term, {\n          order_by: 'id',\n        }, resolve);\n      }\n    });\n  }\n}\n","import Search from './search';\n\ndocument.addEventListener('DOMContentLoaded', () => new Search());\n"],"sourceRoot":""}