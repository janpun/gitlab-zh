{"version":3,"sources":["webpack:///./pages/admin/admin.js","webpack:///./pages/admin/index.js","webpack:///./filterable_list.js","webpack:///./projects_list.js","webpack:///./namespace_select.js","webpack:///./pages/admin/projects/index.js"],"names":["showBlacklistType","jquery_default","val","show","hide","document","addEventListener","modal","on","$elems","this","attr","prop","e","preventDefault","toggleClass","tab","$visibleLog","animate","scrollTop","find","height","url_utility","FilterableList","form","filter","holder","filterInputField","arguments","length","undefined","_classCallCheck","filterForm","listFilterElement","listHolderElement","isBusy","getAttribute","jquery__WEBPACK_IMPORTED_MODULE_0___default","serialize","getFilterEndpoint","debounceFilter","underscore__WEBPACK_IMPORTED_MODULE_1___default","a","debounce","onFilterInput","bind","unbindEvents","bindEvents","queryData","filterGroupsParam","filterResults","setDefaultFilterOption","removeEventListener","params","_this","fadeTo","_lib_utils_axios_utils__WEBPACK_IMPORTED_MODULE_2__","get","then","res","onFilterSuccess","onFilterComplete","catch","response","data","html","innerHTML","currentPath","getPagePath","window","history","replaceState","page","title","ProjectsList","querySelector","_filterable_list__WEBPACK_IMPORTED_MODULE_0__","initSearch","NamespaceSelect","opts","isFilter","dropdown","dataset","fieldName","glDropdown","filterable","selectable","filterRemote","search","fields","toggleLabel","selected","id","text","kind","full_path","term","dataCallback","api","namespaces","unshift","splice","namespace","renderRow","clicked","options","url","Object","location","href","projects_list","querySelectorAll","forEach","namespace_select"],"mappings":"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","file":"pages.admin.projects.e9d3e30e.chunk.js","sourcesContent":["import $ from 'jquery';\nimport { refreshCurrentPage } from '../../lib/utils/url_utility';\n\nfunction showBlacklistType() {\n  if ($('input[name=\"blacklist_type\"]:checked').val() === 'file') {\n    $('.blacklist-file').show();\n    $('.blacklist-raw').hide();\n  } else {\n    $('.blacklist-file').hide();\n    $('.blacklist-raw').show();\n  }\n}\n\nexport default function adminInit() {\n  const modal = $('.change-owner-holder');\n\n  $('input#user_force_random_password').on('change', function randomPasswordClick() {\n    const $elems = $('#user_password, #user_password_confirmation');\n    if ($(this).attr('checked')) {\n      $elems.val('').prop('disabled', true);\n    } else {\n      $elems.prop('disabled', false);\n    }\n  });\n\n  $('body').on('click', '.js-toggle-colors-link', (e) => {\n    e.preventDefault();\n    $('.js-toggle-colors-container').toggleClass('hide');\n  });\n\n  $('.log-tabs a').on('click', function logTabsClick(e) {\n    e.preventDefault();\n    $(this).tab('show');\n  });\n\n  $('.log-bottom').on('click', (e) => {\n    e.preventDefault();\n    const $visibleLog = $('.file-content:visible');\n    $visibleLog.animate({\n      scrollTop: $visibleLog.find('ol').height(),\n    }, 'fast');\n  });\n\n  $('.change-owner-link').on('click', function changeOwnerLinkClick(e) {\n    e.preventDefault();\n    $(this).hide();\n    modal.show();\n  });\n\n  $('.change-owner-cancel-link').on('click', (e) => {\n    e.preventDefault();\n    modal.hide();\n    $('.change-owner-link').show();\n  });\n\n  $('li.project_member, li.group_member').on('ajax:success', refreshCurrentPage);\n\n  $(\"input[name='blacklist_type']\").on('click', showBlacklistType);\n  showBlacklistType();\n}\n","import initAdmin from './admin';\n\ndocument.addEventListener('DOMContentLoaded', initAdmin);\n","import $ from 'jquery';\nimport _ from 'underscore';\nimport axios from './lib/utils/axios_utils';\n\n/**\n * Makes search request for content when user types a value in the search input.\n * Updates the html content of the page with the received one.\n */\n\nexport default class FilterableList {\n  constructor(form, filter, holder, filterInputField = 'filter_groups') {\n    this.filterForm = form;\n    this.listFilterElement = filter;\n    this.listHolderElement = holder;\n    this.filterInputField = filterInputField;\n    this.isBusy = false;\n  }\n\n  getFilterEndpoint() {\n    return `${this.filterForm.getAttribute('action')}?${$(this.filterForm).serialize()}`;\n  }\n\n  getPagePath() {\n    return this.getFilterEndpoint();\n  }\n\n  initSearch() {\n    // Wrap to prevent passing event arguments to .filterResults;\n    this.debounceFilter = _.debounce(this.onFilterInput.bind(this), 500);\n\n    this.unbindEvents();\n    this.bindEvents();\n  }\n\n  onFilterInput() {\n    const $form = $(this.filterForm);\n    const queryData = {};\n    const filterGroupsParam = $form.find(`[name=\"${this.filterInputField}\"]`).val();\n\n    if (filterGroupsParam) {\n      queryData[this.filterInputField] = filterGroupsParam;\n    }\n\n    this.filterResults(queryData);\n\n    if (this.setDefaultFilterOption) {\n      this.setDefaultFilterOption();\n    }\n  }\n\n  bindEvents() {\n    this.listFilterElement.addEventListener('input', this.debounceFilter);\n  }\n\n  unbindEvents() {\n    this.listFilterElement.removeEventListener('input', this.debounceFilter);\n  }\n\n  filterResults(params) {\n    if (this.isBusy) {\n      return false;\n    }\n\n    $(this.listHolderElement).fadeTo(250, 0.5);\n\n    this.isBusy = true;\n\n    return axios.get(this.getFilterEndpoint(), {\n      params,\n    }).then((res) => {\n      this.onFilterSuccess(res, params);\n      this.onFilterComplete();\n    }).catch(() => this.onFilterComplete());\n  }\n\n  onFilterSuccess(response, queryData) {\n    if (response.data.html) {\n      this.listHolderElement.innerHTML = response.data.html;\n    }\n\n    // Change url so if user reload a page - search results are saved\n    const currentPath = this.getPagePath(queryData);\n\n    return window.history.replaceState({\n      page: currentPath,\n    }, document.title, currentPath);\n  }\n\n  onFilterComplete() {\n    this.isBusy = false;\n    $(this.listHolderElement).fadeTo(250, 1);\n  }\n}\n","import FilterableList from './filterable_list';\n\n/**\n * Makes search request for projects when user types a value in the search input.\n * Updates the html content of the page with the received one.\n */\nexport default class ProjectsList {\n  constructor() {\n    const form = document.querySelector('form#project-filter-form');\n    const filter = document.querySelector('.js-projects-list-filter');\n    const holder = document.querySelector('.js-projects-list-holder');\n\n    if (form && filter && holder) {\n      const list = new FilterableList(form, filter, holder);\n      list.initSearch();\n    }\n  }\n}\n","/* eslint-disable func-names, comma-dangle, object-shorthand, no-else-return, prefer-template, quotes, prefer-arrow-callback, max-len */\n\nimport $ from 'jquery';\nimport Api from './api';\nimport { mergeUrlParams } from './lib/utils/url_utility';\n\nexport default class NamespaceSelect {\n  constructor(opts) {\n    const isFilter = opts.dropdown.dataset.isFilter === 'true';\n    const fieldName = opts.dropdown.dataset.fieldName || 'namespace_id';\n\n    $(opts.dropdown).glDropdown({\n      filterable: true,\n      selectable: true,\n      filterRemote: true,\n      search: {\n        fields: ['path']\n      },\n      fieldName: fieldName,\n      toggleLabel: function(selected) {\n        if (selected.id == null) {\n          return selected.text;\n        } else {\n          return selected.kind + \": \" + selected.full_path;\n        }\n      },\n      data: function(term, dataCallback) {\n        return Api.namespaces(term, function(namespaces) {\n          if (isFilter) {\n            const anyNamespace = {\n              text: 'Any namespace',\n              id: null\n            };\n            namespaces.unshift(anyNamespace);\n            namespaces.splice(1, 0, 'divider');\n          }\n          return dataCallback(namespaces);\n        });\n      },\n      text: function(namespace) {\n        if (namespace.id == null) {\n          return namespace.text;\n        } else {\n          return namespace.kind + \": \" + namespace.full_path;\n        }\n      },\n      renderRow: this.renderRow,\n      clicked(options) {\n        if (!isFilter) {\n          const { e } = options;\n          e.preventDefault();\n        }\n      },\n      url(namespace) {\n        return mergeUrlParams({ [fieldName]: namespace.id }, window.location.href);\n      },\n    });\n  }\n}\n","import ProjectsList from '../../../projects_list';\nimport NamespaceSelect from '../../../namespace_select';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  new ProjectsList(); // eslint-disable-line no-new\n\n  document.querySelectorAll('.js-namespace-select')\n    .forEach(dropdown => new NamespaceSelect({ dropdown }));\n});\n"],"sourceRoot":""}