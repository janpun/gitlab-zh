(this.webpackJsonp=this.webpackJsonp||[]).push([[158,16],{1027:function(e,t){window.NoteModel=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.discussionId=t,this.id=n.noteId,this.canResolve=n.canResolve,this.resolved=n.resolved,this.resolved_by=n.resolvedBy,this.authorName=n.authorName,this.authorAvatar=n.authorAvatar,this.noteTruncated=n.noteTruncated}},1028:function(e,t,n){n(31),n(57),e.exports=n(876)},118:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=(n(243),n(5)),a=n(7),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector,this.dataType=t.dataType,this.fieldName=t.fieldName,this.onSuccess=t.onSuccess||function(){},this.onError=function(e){var t="";return e.response.data&&"object"===r(e.response.data)&&(t=e.response.data.errors.join(" ")),new a.a(t||"Update failed","alert")},this.init()}return l(e,[{key:"init",value:function(){this.disable(),s()(this.selector+" .js-task-list-container").taskList("enable"),s()(document).on("tasklist:changed",this.selector+" .js-task-list-container",this.update.bind(this))}},{key:"disable",value:function(){s()(this.selector+" .js-task-list-container").taskList("disable"),s()(document).off("tasklist:changed",this.selector+" .js-task-list-container")}},{key:"update",value:function(e){var t,n,i,a=this,r=s()(e.target),l={};return l[this.dataType]=(t={},n=this.fieldName,i=r.val(),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t),o.a.patch(r.data("updateUrl")||s()("form.js-issuable-update").attr("action"),l).then(function(e){var t=e.data;return a.onSuccess(t)}).catch(function(e){return a.onError(e)})}}]),e}();t.a=d},119:function(e,t,n){"use strict";var i={props:{small:{type:Boolean,required:!1,default:!1},lines:{type:Number,required:!1,default:3}},computed:{lineClasses:function(){return new Array(this.lines).fill().map(function(e,t){return"skeleton-line-"+(t+1)})}}},s=n(2),o=Object(s.a)(i,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"animation-container",class:{"animation-container-small":this.small}},this._l(this.lineClasses,function(e,n){return t("div",{key:n,class:e})}))},[],!1,null,null,null);t.a=o.exports},12:function(e,t,n){"use strict";var i=n(0),s=n.n(i);t.a={bind:function(e){s()(e).tooltip({trigger:"hover"})},componentUpdated:function(e){s()(e).tooltip("_fixTitle")},unbind:function(e){s()(e).tooltip("dispose")}}},143:function(e,t,n){"use strict";var i={init:function(e){this.hook=e,this.destroyed=!1,this.config=e.config.InputSetter||(this.hook.config.InputSetter={}),this.eventWrapper={},this.addEvents()},addEvents:function(){this.eventWrapper.setInputs=this.setInputs.bind(this),this.hook.list.list.addEventListener("click.dl",this.eventWrapper.setInputs)},removeEvents:function(){this.hook.list.list.removeEventListener("click.dl",this.eventWrapper.setInputs)},setInputs:function(e){var t=this;if(!this.destroyed){var n=e.detail.selected;Array.isArray(this.config)||(this.config=[this.config]),this.config.forEach(function(e){return t.setInput(e,n)})}},setInput:function(e,t){var n=e.input||this.hook.trigger,i=t.getAttribute(e.valueAttribute),s=e.inputAttribute;return n.hasAttribute(s)?n.setAttribute(s,i):"INPUT"===n.tagName?n.value=i:n.textContent=i},destroy:function(){this.destroyed=!0,this.removeEvents()}};t.a=i},176:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(5),a=n(7),r=n(1),l=n(21),d=n(39),c=n.n(d),u={init:function(e){var t=this;this.userCanCreateNote||(this.userCanCreateNote=""===e.closest(".files").data("canCreateNote")),this.isParallelView="parallel"===c.a.get("diff_view"),this.userCanCreateNote&&e.on("mouseover",".diff-line-num, .line_content",function(e){return t.showButton(t.isParallelView,e)}).on("mouseleave",".diff-line-num, .line_content",function(e){return t.hideButton(t.isParallelView,e)})},showButton:function(e,t){var n=this.getButtonParent(t.currentTarget,e);this.validateButtonParent(n)&&(n.classList.add("is-over"),n.nextElementSibling.classList.add("is-over"))},hideButton:function(e,t){var n=this.getButtonParent(t.currentTarget,e);n.classList.remove("is-over"),n.nextElementSibling.classList.remove("is-over")},getButtonParent:function(e,t){if(t){if(!e.classList.contains("diff-line-num"))return e.previousElementSibling}else if(!e.classList.contains("old_line"))return e.parentNode.querySelector(".old_line");return e},validateButtonParent:function(e){return!(e.classList.contains("empty-cell")||e.classList.contains("js-unfold")||e.classList.contains("no-comment-btn")||e.parentNode.classList.contains("diff-expanded"))}},f=n(93),h=n(129),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var p='<div class="diff-content"></div>',v='<i class="fa fa-spinner fa-spin"></i>',g='<div class="nothing-here-block diff-collapsed">This diff is collapsed. <button class="click-to-expand btn btn-link">Click to expand it.</button></div>',y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.toggleDiff=this.toggleDiff.bind(this),this.content=s()(".diff-content",this.file),this.$toggleIcon=s()(".diff-toggle-caret",this.file),this.diffForPath=this.content.find("[data-diff-for-path]").data("diffForPath"),this.isOpen=!this.diffForPath,this.diffForPath?(this.collapsedContent=this.content,this.loadingContent=s()(p).addClass("loading").html(v).hide(),this.content=null,this.collapsedContent.after(this.loadingContent),this.$toggleIcon.addClass("fa-caret-right")):(this.collapsedContent=s()(p).html(g).hide(),this.content.after(this.collapsedContent),this.$toggleIcon.addClass("fa-caret-down")),s()(".js-file-title, .click-to-expand",this.file).on("click",function(e){this.toggleDiff(s()(e.target))}.bind(this))}return m(e,[{key:"toggleDiff",value:function(e,t){if(e.hasClass("js-file-title")||e.hasClass("click-to-expand")||e.hasClass("diff-toggle-caret"))if(this.isOpen=!this.isOpen,this.isOpen||this.hasError){if(!this.content)return this.$toggleIcon.addClass("fa-caret-down").removeClass("fa-caret-right"),this.getContentHTML(t);this.collapsedContent.hide(),this.content.show(),this.$toggleIcon.addClass("fa-caret-down").removeClass("fa-caret-right"),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents()}else this.content.hide(),this.$toggleIcon.addClass("fa-caret-right").removeClass("fa-caret-down"),this.collapsedContent.show(),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents()}},{key:"getContentHTML",value:function(e){var t=this;this.collapsedContent.hide(),this.loadingContent.show(),o.a.get(this.diffForPath).then(function(n){var i=n.data;t.loadingContent.hide(),i.html?(t.content=s()(i.html),Object(h.a)(t.content)):(t.hasError=!0,t.content=s()('<div class="nothing-here-block"><i class="fa fa-warning"></i> Could not load diff</div>')),t.collapsedContent.after(t.content),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents();var o=s()(t.file);u.init(o);var a=o.closest(".files").is("[data-can-create-note]");f.a.initImageDiff(o[0],a),e&&e()}).catch(function(){Object(a.a)(Object(r.a)("An error occurred while retrieving diff"))})}}]),e}(),b=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,s=!1,o=void 0;try{for(var a,r=e[Symbol.iterator]();!(i=(a=r.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var k=!1,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=s()(".files .diff-file");t.each(function(e,t){s.a.data(t,"singleFileDiff")||s.a.data(t,"singleFileDiff",new y(t))});var n=document.getElementById("diffs");(!n||n&&n.dataset&&""!==n.dataset.isLocked)&&u.init(t);var i=s()(".files").first().get(0),o=i&&i.hasAttribute("data-can-create-note");t.each(function(e,t){return f.a.initImageDiff(t,o)}),k||(s()(document).on("click",".js-unfold",this.handleClickUnfold.bind(this)).on("click",".diff-line-num a",this.handleClickLineNum.bind(this)).on("mousedown","td.line_content.parallel",this.handleParallelLineDown.bind(this)),k=!0),Object(l.a)()&&this.highlightSelectedLine(),this.openAnchoredDiff()}return w(e,[{key:"handleClickUnfold",value:function(e){var t=s()(e.target),n=this.lineNumbers(t.parent()),i=b(n,2),l=i[0],d=i[1],c=d-l,u=t.hasClass("js-unfold-bottom"),f=void 0,h=void 0,m=!0;if(u){var p=d+1;f=p,h=p+20}else{var v=d-1;f=v-20,h=v;var g=this.lineNumbers(t.parent().prev())[1];f<=g+1&&(f=g+1,m=!1)}var y=t.parents(".diff-file"),w=y.data("blobDiffPath"),k={since:f,to:h,bottom:u,offset:c,unfold:m,view:y.data("view")};o.a.get(w,{params:k}).then(function(e){var n=e.data;return t.parent().replaceWith(n)}).catch(function(){return Object(a.a)(Object(r.a)("An error occurred while loading diff"))})}},{key:"openAnchoredDiff",value:function(e){var t=this,n=Object(l.a)(),i=n&&n.split("_")[0];if(i){var o=s()("#"+i).closest(".diff-file");if(s()(".nothing-here-block:visible",o).length){var a=s()(".js-file-title, .click-to-expand",o);o.data("singleFileDiff").toggleDiff(a,function(){t.highlightSelectedLine(),e&&e()})}else e&&e()}}},{key:"handleClickLineNum",value:function(e){var t=s()(e.currentTarget).attr("href");e.preventDefault(),window.history.pushState?window.history.pushState(null,null,t):window.location.hash=t,this.highlightSelectedLine()}},{key:"handleParallelLineDown",value:function(e){var t=s()(e.currentTarget),n=t.closest("table");n.removeClass("left-side-selected right-side-selected");var i=["left-side","right-side"].filter(function(e){return t.hasClass(e)})[0];i&&n.addClass(i+"-selected")}},{key:"diffViewType",value:function(){return s()(".inline-parallel-buttons a.active").data("viewType")}},{key:"lineNumbers",value:function(e){var t=e.find(".diff-line-num").toArray();return 2!==t.length?[0,0]:t.map(function(e){return parseInt(s()(e).data("linenumber"),10)||0})}},{key:"highlightSelectedLine",value:function(){var e=Object(l.a)(),t=s()(".diff-file");t.find(".hll").removeClass("hll"),e&&t.find("tr#"+e+":not(.match) td, td#"+e+', td[data-line-code="'+e+'"]').addClass("hll")}}]),e}();t.a=C},186:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r});var i=n(228),s=n.n(i),o=function(e,t,n,i){var s=Math.floor(e.offsetTop-t);if(s<=n&&!e.classList.contains("is-stuck")){var o=i?function(){var e=document.createElement("div");return e.classList.add("sticky-placeholder"),e}():null,a=e.offsetHeight;e.classList.add("is-stuck"),i&&(e.parentNode.insertBefore(o,e.nextElementSibling),o.style.height=a-e.offsetHeight+"px")}else s>n&&e.classList.contains("is-stuck")&&(e.classList.remove("is-stuck"),i&&e.nextElementSibling&&e.nextElementSibling.classList.contains("sticky-placeholder")&&e.nextElementSibling.remove())},a=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e&&"undefined"!=typeof CSS&&CSS.supports("(position: -webkit-sticky) or (position: sticky)")&&document.addEventListener("scroll",function(){return o(e,window.scrollY,t,n)},{passive:!0})},r=function(e){s.a.add(e)}},205:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(3),a=n.n(o),r=n(39),l=n.n(r),d=n(50),c=n.n(d),u=(n(391),n(390),n(149)),f=n(8),h=n(129),m=n(119),p=n(5),v=n(21),g=n(7),y=n(53),b=n(159),w=n(143),k=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var C=Object.assign({},w.a),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dropdownTrigger=t.dropdownTrigger,this.dropdownList=t.dropdownList,this.noteTypeInput=t.noteTypeInput,this.submitButton=t.submitButton,this.closeButton=t.closeButton,this.reopenButton=t.reopenButton}return k(e,[{key:"initDroplab",value:function(){this.droplab=new b.a;var e=this.setConfig();this.droplab.init(this.dropdownTrigger,this.dropdownList,[C],e)}},{key:"setConfig",value:function(){var e={InputSetter:[{input:this.noteTypeInput,valueAttribute:"data-value"},{input:this.submitButton,valueAttribute:"data-submit-text"}]};return this.closeButton&&e.InputSetter.push({input:this.closeButton,valueAttribute:"data-close-text"},{input:this.closeButton,valueAttribute:"data-close-text",inputAttribute:"data-alternative-text"}),this.reopenButton&&e.InputSetter.push({input:this.reopenButton,valueAttribute:"data-reopen-text"},{input:this.reopenButton,valueAttribute:"data-reopen-text",inputAttribute:"data-alternative-text"}),e}}]),e}(),x=n(65),E=n(190),_=n(98),N=n(118),T=n(11),S=(n(93),n(38)),I=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function A(e){return e.replace(/\r\n/g,"\n")}window.autosize=c.a;var D=/^\/\w+.*$/gm,L=function(){function e(t,n,i,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y.b;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.updateTargetButtons=this.updateTargetButtons.bind(this),this.updateComment=this.updateComment.bind(this),this.visibilityChange=this.visibilityChange.bind(this),this.cancelDiscussionForm=this.cancelDiscussionForm.bind(this),this.onAddDiffNote=this.onAddDiffNote.bind(this),this.onAddImageDiffNote=this.onAddImageDiffNote.bind(this),this.setupDiscussionNoteForm=this.setupDiscussionNoteForm.bind(this),this.onReplyToDiscussionNote=this.onReplyToDiscussionNote.bind(this),this.removeNote=this.removeNote.bind(this),this.cancelEdit=this.cancelEdit.bind(this),this.updateNote=this.updateNote.bind(this),this.addDiscussionNote=this.addDiscussionNote.bind(this),this.addNoteError=this.addNoteError.bind(this),this.addNote=this.addNote.bind(this),this.resetMainTargetForm=this.resetMainTargetForm.bind(this),this.refresh=this.refresh.bind(this),this.keydownNoteText=this.keydownNoteText.bind(this),this.toggleCommitList=this.toggleCommitList.bind(this),this.postComment=this.postComment.bind(this),this.clearFlashWrapper=this.clearFlash.bind(this),this.onHashChange=this.onHashChange.bind(this),this.notes_url=t,this.note_ids=n,this.enableGFM=a,this.updatedNotesTrackingMap={},this.last_fetched_at=i,this.noteable_url=document.URL,this.notesCountBadge||(this.notesCountBadge=s()(".issuable-details").find(".notes-tab .badge")),this.basePollingInterval=15e3,this.maxPollingSteps=4,this.$wrapperEl=Object(T.t)()?s()(document).find(".diffs"):s()(document),this.cleanBinding(),this.addBinding(),this.setPollingInterval(),this.setupMainTargetNoteForm(a),this.taskList=new N.a({dataType:"note",fieldName:"note",selector:".notes"}),this.collapseLongCommitList(),this.setViewType(o),"merge_requests"===Object(T.i)(1)&&s()(".note-edit-form").clone().addClass("mr-note-edit-form").insertAfter(".note-edit-form");var r=Object(v.a)(),l=r&&document.getElementById(r);l&&this.loadLazyDiff({currentTarget:l})}return I(e,null,[{key:"initialize",value:function(t,n,i,s,o){this.instance||(this.instance=new e(t,n,i,s,o))}},{key:"getInstance",value:function(){return this.instance}}]),I(e,[{key:"setViewType",value:function(e){this.view=l.a.get("diff_view")||e}},{key:"addBinding",value:function(){this.$wrapperEl.on("click",".js-note-edit",this.showEditForm.bind(this)),this.$wrapperEl.on("click",".note-edit-cancel",this.cancelEdit),this.$wrapperEl.on("click",".js-comment-submit-button",this.postComment),this.$wrapperEl.on("click",".js-comment-save-button",this.updateComment),this.$wrapperEl.on("keyup input",".js-note-text",this.updateTargetButtons),this.$wrapperEl.on("click",".js-comment-resolve-button",this.postComment),this.$wrapperEl.on("click",".js-note-delete",this.removeNote),this.$wrapperEl.on("click",".js-note-attachment-delete",this.removeAttachment),this.$wrapperEl.on("click",".js-note-discard",this.resetMainTargetForm),this.$wrapperEl.on("change",".js-note-attachment-input",this.updateFormAttachment),this.$wrapperEl.on("click",".js-discussion-reply-button",this.onReplyToDiscussionNote),this.$wrapperEl.on("click",".js-add-diff-note-button",this.onAddDiffNote),this.$wrapperEl.on("click",".js-add-image-diff-note-button",this.onAddImageDiffNote),this.$wrapperEl.on("click",".js-close-discussion-note-form",this.cancelDiscussionForm),this.$wrapperEl.on("click",".system-note-commit-list-toggler",this.toggleCommitList),this.$wrapperEl.on("click",".js-toggle-lazy-diff",this.loadLazyDiff),this.$wrapperEl.on("click",".js-toggle-lazy-diff-retry-button",this.onClickRetryLazyLoad.bind(this)),this.$wrapperEl.on("visibilitychange",this.visibilityChange),this.$wrapperEl.on("issuable:change",this.refresh),this.$wrapperEl.on("ajax:success",".js-main-target-form",this.addNote),this.$wrapperEl.on("ajax:success",".js-discussion-note-form",this.addDiscussionNote),this.$wrapperEl.on("ajax:success",".js-main-target-form",this.resetMainTargetForm),this.$wrapperEl.on("ajax:complete",".js-main-target-form",this.reenableTargetFormSubmitButton),this.$wrapperEl.on("keydown",".js-note-text",this.keydownNoteText),s()(window).on("hashchange",this.onHashChange)}},{key:"cleanBinding",value:function(){this.$wrapperEl.off("click",".js-note-edit"),this.$wrapperEl.off("click",".note-edit-cancel"),this.$wrapperEl.off("click",".js-note-delete"),this.$wrapperEl.off("click",".js-note-attachment-delete"),this.$wrapperEl.off("click",".js-discussion-reply-button"),this.$wrapperEl.off("click",".js-add-diff-note-button"),this.$wrapperEl.off("click",".js-add-image-diff-note-button"),this.$wrapperEl.off("visibilitychange"),this.$wrapperEl.off("keyup input",".js-note-text"),this.$wrapperEl.off("click",".js-note-target-reopen"),this.$wrapperEl.off("click",".js-note-target-close"),this.$wrapperEl.off("click",".js-note-discard"),this.$wrapperEl.off("keydown",".js-note-text"),this.$wrapperEl.off("click",".js-comment-resolve-button"),this.$wrapperEl.off("click",".system-note-commit-list-toggler"),this.$wrapperEl.off("click",".js-toggle-lazy-diff"),this.$wrapperEl.off("click",".js-toggle-lazy-diff-retry-button"),this.$wrapperEl.off("ajax:success",".js-main-target-form"),this.$wrapperEl.off("ajax:success",".js-discussion-note-form"),this.$wrapperEl.off("ajax:complete",".js-main-target-form"),s()(window).off("hashchange",this.onHashChange)}},{key:"keydownNoteText",value:function(e){var t,n,i,o;if(!Object(T.x)(e))switch(t=s()(e.target),e.which){case 38:if(""!==t.val())return;if((o=s()("li.note[data-author-id='"+gon.current_user_id+"'][data-editable]:last",t.closest(".note, .notes_holder, #notes"))).length)return o.find(".js-note-edit").trigger("click",[!0,o]);break;case 27:if((n=t.closest(".js-discussion-note-form")).length){if(""!==t.val()&&!window.confirm("Are you sure you want to cancel creating this comment?"))return;return void this.removeDiscussionNoteForm(n)}if((i=t.closest(".note")).length){if(t.closest("form").data("originalNote")!==t.val()&&!window.confirm("Are you sure you want to cancel editing this comment?"))return;return this.removeNoteEditForm(i)}}}},{key:"initRefresh",value:function(){return e.interval&&clearInterval(e.interval),e.interval=setInterval((t=this,function(){return t.refresh()}),this.pollingInterval);var t}},{key:"refresh",value:function(){if(!document.hidden)return this.getContent()}},{key:"getContent",value:function(){var e=this;this.refreshing||(this.refreshing=!0,p.a.get(this.notes_url+"?html=true",{headers:{"X-Last-Fetched-At":this.last_fetched_at}}).then(function(t){var n=t.data,i=n.notes;e.last_fetched_at=n.last_fetched_at,e.setPollingInterval(n.notes.length),s.a.each(i,function(t,n){return e.renderNote(n)}),e.refreshing=!1}).catch(function(){e.refreshing=!1}))}},{key:"setPollingInterval",value:function(e){var t;return null==e&&(e=!0),t=this.basePollingInterval*Math.pow(2,this.maxPollingSteps-1),e?this.pollingInterval=this.basePollingInterval:this.pollingInterval<t&&(this.pollingInterval*=2),this.initRefresh()}},{key:"handleQuickActions",value:function(t){var n;t.commands_changes&&("merge"in t.commands_changes&&e.checkMergeRequestStatus(),"emoji_award"in t.commands_changes&&(n=s()(".js-awards-block").eq(0),Object(E.b)().then(function(e){e.addAwardToEmojiBar(n,t.commands_changes.emoji_award),e.scrollToAwards()}).catch(function(){})))}},{key:"setupNewNote",value:function(t){Object(S.e)(t.find(".js-timeago"),!1),this.collapseLongCommitList(),this.taskList.init(),e.updateNoteTargetSelector(t),this.$noteToCleanHighlight=t}},{key:"onHashChange",value:function(){this.$noteToCleanHighlight&&e.updateNoteTargetSelector(this.$noteToCleanHighlight),this.$noteToCleanHighlight=null}},{key:"renderNote",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s()(".main-notes-list");if(t.discussion_html)return this.renderDiscussionNote(t,n);if(t.valid){var o=i.find("#note_"+t.id);if(e.isNewNote(t,this.note_ids)){if(Object(T.t)())return;this.note_ids.push(t.id),i.length&&i.find(".system-note.being-posted").remove();var a=e.animateAppendNote(t.html,i);return this.setupNewNote(a),this.refresh(),this.updateNotesCount(1)}if(e.isUpdatedNote(t,o)){var r=o.hasClass("is-editing"),l=A(o.find(".original-note-content").text().trim()),d=o.find(".js-note-text"),c=d.val(),u=A(t.note),f=c===l||c===u;if(r&&f)d.val(t.note),this.updatedNotesTrackingMap[t.id]=t;else if(r&&!f)this.putConflictEditWarningInPlace(t,o),this.updatedNotesTrackingMap[t.id]=t;else{var h=e.animateUpdateNote(t.html,o);this.setupNewNote(h)}}}else t.errors&&t.errors.commands_only&&(t.commands_changes&&Object.keys(t.commands_changes).length>0&&i.find(".system-note.being-posted").remove(),this.addFlash(t.errors.commands_only,"notice",this.parentTimeline.get(0)),this.refresh())}},{key:"isParallelView",value:function(){return"parallel"===l.a.get("diff_view")}},{key:"renderDiscussionNote",value:function(t,n){var i,o,a,r,l;if(e.isNewNote(t,this.note_ids)){if(this.note_ids.push(t.id),a=(o=n||s()('.js-discussion-note-form[data-discussion-id="'+t.discussion_id+'"]')).length||!t.discussion_line_code?o.closest("tr"):s()("#"+t.discussion_line_code),t.on_image&&(a=o),r=this.isParallelView()?o.find("#line_type").val():"old",l=a.prevAll(".line_holder").first().find(".js-avatar-container."+r+"_line"),(i=s()('.notes[data-discussion-id="'+t.discussion_id+'"]')).length||(i=o.closest(".discussion").find(".notes")),0===i.length)if(t.diff_discussion_html){var d=s()(t.diff_discussion_html).renderGFM();if(!this.isParallelView()||a.hasClass("js-temp-notes-holder")||t.on_image)a.after(d);else{var c=d.find('.notes[data-discussion-id="'+t.discussion_id+'"]'),u="."+c.closest(".notes_content").attr("class").split(" ").join(".");a.find(u+" .content").append(c.closest(".content").children())}}else e.animateAppendNote(t.discussion_html,s()(".main-notes-list"));else e.animateAppendNote(t.html,i);return void 0!==gl.diffNotesCompileComponents&&t.discussion_resolvable&&(gl.diffNotesCompileComponents(),this.renderDiscussionAvatar(l,t)),Object(S.e)(s()(".js-timeago"),!1),e.checkMergeRequestStatus(),this.updateNotesCount(1)}}},{key:"getLineHolder",value:function(e){return s()(e).closest(".notes_holder").prevAll(".line_holder").first().get(0)}},{key:"renderDiscussionAvatar",value:function(e,t){var n=e.find(".diff-comment-avatar-holders");n.length||((n=document.createElement("diff-note-avatars")).setAttribute("discussion-id",t.discussion_id),e.append(n),gl.diffNotesCompileComponents())}},{key:"resetMainTargetForm",value:function(e){var t;(t=s()(".js-main-target-form")).find(".js-errors").remove(),t.find(".js-md-write-button").click(),t.find(".js-note-text").val("").trigger("input"),t.find(".js-note-text").data("autosave").reset();var n=document.createEvent("Event");n.initEvent("autosize:update",!0,!1),t.find(".js-autosize")[0].dispatchEvent(n),this.updateTargetButtons(e)}},{key:"reenableTargetFormSubmitButton",value:function(){return s()(".js-main-target-form").find(".js-note-text").trigger("input")}},{key:"setupMainTargetNoteForm",value:function(t){var n;n=s()(".js-new-note-form"),this.formClone=n.clone(),this.setupNoteForm(n,t),n.removeClass("js-new-note-form"),n.addClass("js-main-target-form"),n.find("#note_line_code").remove(),n.find("#note_position").remove(),n.find("#note_type").val(""),n.find("#note_project_id").remove(),n.find("#in_reply_to_discussion_id").remove(),n.find(".js-comment-resolve-button").closest("comment-and-resolve-btn").remove(),this.parentTimeline=n.parents(".timeline"),n.length&&e.initCommentTypeToggle(n.get(0))}},{key:"setupNoteForm",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.b;return this.glForm=new x.a(e,i),t=e.find(".js-note-text"),n=["Note",e.find("#note_noteable_type").val(),e.find("#note_noteable_id").val(),e.find("#note_commit_id").val(),e.find("#note_type").val(),e.find("#note_project_id").val(),e.find("#in_reply_to_discussion_id").val(),e.find("#note_line_code").val(),e.find("#note_position").val()],new _.a(t,n)}},{key:"addNote",value:function(e,t){return this.renderNote(t)}},{key:"addNoteError",value:function(e){var t=void 0;return e.hasClass("js-main-target-form")?t=e.parents(".timeline"):e.hasClass("js-discussion-note-form")&&(t=e.closest(".discussion-notes").find(".notes")),this.addFlash("Your comment could not be submitted! Please check your network connection and try again.","alert",t.get(0))}},{key:"updateNoteError",value:function(e){new g.a("Your comment could not be updated! Please check your network connection and try again.")}},{key:"addDiscussionNote",value:function(e,t,n){if(null!=e.attr("data-resolve-all")){e.data("projectPath");var i=e.data("discussionId"),s=e.data("noteableIid");null!=ResolveService&&ResolveService.toggleResolveForDiscussion(s,i)}this.renderNote(t,e),n&&this.removeDiscussionNoteForm(e)}},{key:"updateNote",value:function(e,t){var n;n=s()(e.html),this.revertNoteEditForm(t),n.renderGFM(),s()(".note-row-"+e.id).replaceWith(n),this.setupNewNote(n),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents()}},{key:"checkContentToAllowEditing",value:function(e){var t=e.find(".original-note-content").text().trim(),n=!0;if(e.find(".js-note-text").val()===t)this.removeNoteEditForm(e);else{e.find(".note-form-actions");Object(T.v)(e.get(0))||Object(T.F)(e),e.find(".js-finish-edit-warning").show(),n=!1}return n}},{key:"showEditForm",value:function(e,t,n){e.preventDefault();var i=s()(e.target),o=s()(this.getEditFormSelector(i)),a=i.closest(".note"),r=s()(".note.is-editing:visible");if(r.length&&!this.checkContentToAllowEditing(r))return;a.find(".js-note-attachment-delete").show(),o.addClass("current-note-edit-form"),a.addClass("is-editing"),this.putEditFormInPlace(i)}},{key:"cancelEdit",value:function(e){e.preventDefault();var t=s()(e.target),n=t.closest(".note"),i=n.attr("data-note-id");if(this.revertNoteEditForm(t),this.updatedNotesTrackingMap[i]){var o=s()(this.updatedNotesTrackingMap[i].html);n.replaceWith(o),this.setupNewNote(o),delete this.updatedNotesTrackingMap[i]}else n.find(".js-finish-edit-warning").hide(),this.removeNoteEditForm(n)}},{key:"revertNoteEditForm",value:function(e){e=e||s()(".note.is-editing:visible");var t=this.getEditFormSelector(e),n=s()(t);n.insertBefore(".diffs"),n.find(".js-comment-save-button").enable(),n.find(".js-finish-edit-warning").hide()}},{key:"getEditFormSelector",value:function(e){var t=".note-edit-form:not(.mr-note-edit-form)";return e.parents("#diffs").length&&(t=".note-edit-form.mr-note-edit-form"),t}},{key:"removeNoteEditForm",value:function(e){var t=e.find(".diffs .current-note-edit-form");return e.removeClass("is-editing"),t.removeClass("current-note-edit-form"),t.find(".js-finish-edit-warning").hide(),t.find(".js-note-text").val(t.find("form.edit-note").data("originalNote"))}},{key:"removeNote",value:function(t){var n,i;return i=s()(t.currentTarget).closest(".note"),n=i.attr("id"),i.attr("data-note-id"),s()(t.currentTarget).closest(".notes[data-discussion-id]").closest(".notes_holder").prev(".line_holder"),s()('.note[id="'+n+'"]').each(function(e,t){var i,o;o=(i=s()(t)).closest(".discussion-notes");var a=s()(".notes",o).data("discussionId");if(void 0!==gl.diffNotesCompileComponents&&gl.diffNoteApps[n]&&gl.diffNoteApps[n].$destroy(),i.remove(),0===o.find(".note").length){var r=o.closest("tr");if(o.closest(".timeline-entry").remove(),s()(".js-diff-avatars-"+a).trigger("remove.vue"),r.find(".discussion-notes").length>1||0===r.length){var l=o.closest(".diff-file");if(l.length>0){var d=new CustomEvent("removeBadge.imageDiff",{detail:{badgeNumber:o.index()+1}});l[0].dispatchEvent(d)}o.remove()}else r.length>0&&r.remove()}}),e.checkMergeRequestStatus(),this.updateNotesCount(-1)}},{key:"removeAttachment",value:function(){var e=s()(this).closest(".note");return e.find(".note-attachment").remove(),e.find(".note-body > .note-text").show(),e.find(".note-header").show(),e.find(".diffs .current-note-edit-form").remove()}},{key:"onReplyToDiscussionNote",value:function(e){this.replyToDiscussionNote(e.target)}},{key:"replyToDiscussionNote",value:function(e){var t,n;return t=this.cleanForm(this.formClone.clone()),(n=s()(e).closest(".js-discussion-reply-button")).closest(".discussion-reply-holder").hide().after(t),this.setupDiscussionNoteForm(n,t)}},{key:"setupDiscussionNoteForm",value:function(e,t){var n=e.closest(".text-file");0===n.length&&(n=e.closest(".image"));var i=e.data("discussionId");(i&&(t.attr("data-discussion-id",i),t.find("#in_reply_to_discussion_id").val(i)),t.find("#note_project_id").val(e.data("discussionProjectId")),t.attr("data-line-code",e.data("lineCode")),t.find("#line_type").val(e.data("lineType")),t.find("#note_noteable_type").val(n.data("noteableType")),t.find("#note_noteable_id").val(n.data("noteableId")),t.find("#note_commit_id").val(n.data("commitId")),t.find("#note_type").val(e.data("noteType")),t.find("#note_line_code").val(e.data("lineCode")),t.find("#note_position").val(e.attr("data-position")),t.find(".js-note-discard").show().removeClass("js-note-discard").addClass("js-close-discussion-note-form").text(t.find(".js-close-discussion-note-form").data("cancelText")),t.find(".js-note-target-close").remove(),t.find(".js-note-new-discussion").remove(),this.setupNoteForm(t),t.removeClass("js-main-target-form").addClass("discussion-form js-discussion-note-form"),void 0!==gl.diffNotesCompileComponents)&&(t.find("comment-and-resolve-btn").attr(":discussion-id","'"+i+"'"),gl.diffNotesCompileComponents());t.find(".js-note-text").focus(),t.find(".js-comment-resolve-button").attr("data-discussion-id",i)}},{key:"onAddDiffNote",value:function(e){e.preventDefault();var t=e.currentTarget||e.target,n=s()(t),i=!n.hasClass("js-diff-comment-avatar");this.toggleDiffNote({target:n,lineType:t.dataset.lineType,showReplyInput:i})}},{key:"onAddImageDiffNote",value:function(e){var t=s()(e.currentTarget||e.target),n=t.closest(".diff-file"),i=new CustomEvent("click.imageDiff",{detail:e});n[0].dispatchEvent(i);var o=void 0,a=t.closest(".diff-viewer").find(".note-container"),r=a.find("> .discussion-form");0===r.length?(o=this.cleanForm(this.formClone.clone())).appendTo(a):o=r,this.setupDiscussionNoteForm(t,o)}},{key:"toggleDiffNote",value:function(e){var t,n,i,o,a,r,l,d=e.target,c=e.lineType,u=e.forceShow,f=e.showReplyInput,h=void 0!==f&&f,m=(r=(t=s()(d)).closest("tr")).next(),p=r;m.is(".notes_holder")&&(p=m),i=m.is(".notes_holder"),n=!1;var v="";l='<tr class="notes_holder js-temp-notes-holder"><td class="notes_line" colspan="2"></td><td class="notes_content"><div class="content"></div></td></tr>',this.isParallelView()&&(v="."+c,l='<tr class="notes_holder js-temp-notes-holder"><td class="notes_line old"></td><td class="notes_content parallel old"><div class="content"></div></td><td class="notes_line new"></td><td class="notes_content parallel new"><div class="content"></div></td></tr>');var g=".notes_content"+v+" .content",y=p.find(g);if(i&&h)p.show(),(y=p.find(g)).length&&(y.show(),(a=y.find(".js-discussion-reply-button:visible")).length?this.replyToDiscussionNote(a[0]):0===y.find(".js-discussion-note-form").length&&(n=!0));else if(h)r.after(l),y=(p=r.next()).find(g),n=!0;else{var b=p.find(".content:not(:empty)").is(":visible"),w=!0===u||!b&&!(!0===u||!1===u);p.toggleClass("hide",!w),y.toggleClass("hide",!w)}if(n)return(o=this.cleanForm(this.formClone.clone())).appendTo(y),this.setupDiscussionNoteForm(t,o)}},{key:"removeDiscussionNoteForm",value:function(e){var t;return t=e.closest("tr"),e.data("glForm").destroy(),e.find(".js-note-text").data("autosave").reset(),e.prev(".discussion-reply-holder").show(),t.is(".js-temp-notes-holder")?t.remove():e.remove()}},{key:"cancelDiscussionForm",value:function(e){e.preventDefault();var t=s()(e.target).closest(".js-discussion-note-form");if(0===s()(e.target).closest(".discussion-notes").length){var n=t.closest(".diff-file");if(n.length>0){var i=new CustomEvent("blur.imageDiff",{detail:e});n[0].dispatchEvent(i)}}return this.removeDiscussionNoteForm(t)}},{key:"updateFormAttachment",value:function(){var e,t;return t=s()(this).closest("form"),e=s()(this).val().replace(/^.*[\\\/]/,""),t.find(".js-attachment-filename").text(e)}},{key:"visibilityChange",value:function(){return this.refresh()}},{key:"updateTargetButtons",value:function(e){var t,n,i,o,a,r,l;if(a=(o=(l=s()(e.target)).parents("form")).find(".js-note-target-reopen"),t=o.find(".js-note-target-close"),i=o.find(".js-note-discard"),l.val().trim().length>0){if(r=a.attr("data-alternative-text"),n=t.attr("data-alternative-text"),a.text()!==r&&a.text(r),t.text()!==n&&t.text(n),a.is(":not(.btn-comment-and-reopen)")&&a.addClass("btn-comment-and-reopen"),t.is(":not(.btn-comment-and-close)")&&t.addClass("btn-comment-and-close"),i.is(":hidden"))return i.show()}else if(r=a.data("originalText"),n=t.data("originalText"),a.text()!==r&&a.text(r),t.text()!==n&&t.text(n),a.is(".btn-comment-and-reopen")&&a.removeClass("btn-comment-and-reopen"),t.is(".btn-comment-and-close")&&t.removeClass("btn-comment-and-close"),i.is(":visible"))return i.hide()}},{key:"putEditFormInPlace",value:function(e){var t=s()(this.getEditFormSelector(e)),n=e.closest(".note");t.insertAfter(n.find(".note-text"));var i=n.find(".original-note-content"),o=i.text().trim(),a=i.data("postUrl"),r=i.data("targetId"),l=i.data("targetType"),d=i.data("markdownVersion");this.glForm=new x.a(t.find("form"),this.enableGFM),t.find("form").attr("action",a+"?html=true").attr("data-remote","true").attr("data-markdown-version",d),t.find(".js-form-target-id").val(r),t.find(".js-form-target-type").val(l),t.find(".js-note-text").focus().val(o),t.find(".js-md-write-button").trigger("click"),t.find(".referenced-users").hide()}},{key:"putConflictEditWarningInPlace",value:function(e,t){0===t.find(".js-conflict-edit-warning").length&&s()('<div class="js-conflict-edit-warning alert alert-danger">\n        This comment has changed since you started editing, please review the\n        <a href="#note_'+e.id+'" target="_blank" rel="noopener noreferrer">\n          updated comment\n        </a>\n        to ensure information is not lost\n      </div>').insertAfter(t.find(".note-text"))}},{key:"updateNotesCount",value:function(e){return this.notesCountBadge.text(parseInt(this.notesCountBadge.text(),10)+e)}},{key:"onClickRetryLazyLoad",value:function(e){var t=s()(e.currentTarget);return t.prop("disabled",!0),this.loadLazyDiff(e).then(function(){t.prop("disabled",!1)})}},{key:"loadLazyDiff",value:function(t){var n=s()(t.currentTarget).closest(".js-toggle-container");if(e.renderPlaceholderComponent(n),n.find(".js-toggle-lazy-diff").removeClass("js-toggle-lazy-diff"),0!==n.find("tbody").length){var i=n.find(".file-holder").data("linesPath"),o=n.find(".js-error-lazy-load-diff"),a=n.find(".js-success-lazy-load");return i?p.a.get(i).then(function(t){var i=t.data;a.removeClass("hidden"),o.addClass("hidden"),e.renderDiffContent(n,i)}).catch(function(){a.addClass("hidden"),o.removeClass("hidden")}):Promise.resolve()}}},{key:"toggleCommitList",value:function(e){var t=s()(e.currentTarget),n=t.siblings(".system-note-commit-list");t.find(".fa").toggleClass("fa-angle-down").toggleClass("fa-angle-up"),n.toggleClass("hide-shade")}},{key:"collapseLongCommitList",value:function(){var e=s()("#notes-list").find("li.system-note").has("ul");s.a.each(e,function(e,t){var n=s()(t),i=n.find(".note-text").find("p:first").text().replace(":","");n.find(".note-header .system-note-message").html(i),n.find("li").length>3?(n.find(".note-text").addClass("system-note-commit-list"),n.find(".system-note-commit-list-toggler").show()):n.find(".note-text").addClass("system-note-commit-list hide-shade")})}},{key:"addFlash",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.flashContainer=new(Function.prototype.bind.apply(g.a,[null].concat(t)))}},{key:"clearFlash",value:function(){this.flashContainer&&(this.flashContainer.style.display="none",this.flashContainer=null)}},{key:"cleanForm",value:function(e){return e.find(".js-comment-type-dropdown").removeClass("btn-group"),e.find(".dropdown-menu").remove(),e}},{key:"getFormData",value:function(e){var t=e.find(".js-note-text").val();return{formData:e.serialize(),formContent:a.a.escape(t),formAction:e.attr("action"),formContentOriginal:t}}},{key:"hasQuickActions",value:function(e){return D.test(e)}},{key:"stripQuickActions",value:function(e){return e.replace(D,"").trim()}},{key:"getQuickActionDescription",value:function(e){var t=void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(function(t,n){return new RegExp("/"+t.name).test(e)});n&&n.length?t=n.length>1?"Applying multiple commands":"Applying command to "+n[0].description.toLowerCase():t="Applying command";return t}},{key:"createPlaceholderNote",value:function(e){var t=e.formContent,n=e.uniqueId,i=e.isDiscussionNote,o=e.currentUsername,r=e.currentUserFullname,l=e.currentUserAvatar,d=i?"discussion":"",c=s()('<li id="'+n+'" class="note being-posted fade-in-half timeline-entry">\n         <div class="timeline-entry-inner">\n            <div class="timeline-icon">\n               <a href="/'+a.a.escape(o)+'">\n                 <img class="avatar s40" src="'+l+'" />\n               </a>\n            </div>\n            <div class="timeline-content '+d+'">\n               <div class="note-header">\n                  <div class="note-header-info">\n                     <a href="/'+a.a.escape(o)+'">\n                       <span class="d-none d-sm-inline-block">'+a.a.escape(o)+'</span>\n                       <span class="note-headline-light">'+a.a.escape(o)+'</span>\n                     </a>\n                  </div>\n               </div>\n               <div class="note-body">\n                 <div class="note-text">\n                   <p>'+t+"</p>\n                 </div>\n               </div>\n            </div>\n         </div>\n      </li>");return c.find(".d-none.d-sm-inline-block").text(a.a.escape(r)),c.find(".note-headline-light").text("@"+a.a.escape(o)),c}},{key:"createPlaceholderSystemNote",value:function(e){var t=e.formContent,n=e.uniqueId;return s()('<li id="'+n+'" class="note system-note timeline-entry being-posted fade-in-half">\n         <div class="timeline-entry-inner">\n           <div class="timeline-content">\n             <i>'+t+"</i>\n           </div>\n         </div>\n       </li>")}},{key:"postComment",value:function(e){var t=this;e.preventDefault();var n=s()(e.target);n.prop("disabled",!0);var i=n.parents("form"),o=i.find(".js-note-target-close"),r="discussion"===n.parent().find("li.droplab-item-selected").attr("id"),l=i.hasClass("js-main-target-form"),d=i.hasClass("js-discussion-note-form"),c=n.hasClass("js-comment-resolve-button"),f=this.getFormData(i),h=f.formData,m=f.formContent,v=f.formAction,g=f.formContentOriginal,y=void 0,b=void 0,w=!1,k=void 0,C=void 0;return d?k=i.parent(".discussion-notes").find(".notes"):l&&(k=s()("ul.main-notes-list")),c&&i.find(".js-comment-submit-button").disable(),C=m,this.hasQuickActions(m)&&(C=this.stripQuickActions(m),w=!0),C&&(y=a.a.uniqueId("tempNote_"),k.append(this.createPlaceholderNote({formContent:C,uniqueId:y,isDiscussionNote:r,currentUsername:gon.current_username,currentUserFullname:gon.current_user_fullname,currentUserAvatar:gon.current_user_avatar_url}))),w&&(b=a.a.uniqueId("tempSystemNote_"),k.append(this.createPlaceholderSystemNote({formContent:this.getQuickActionDescription(m,u.a.get(gl.GfmAutoComplete.dataSources.commands)),uniqueId:b}))),k.length&&(l?this.resetMainTargetForm(e):d&&this.removeDiscussionNoteForm(i)),o.text(o.data("originalText")),p.a.post(v+"?html=true",h).then(function(s){var o=s.data;n.prop("disabled",!1),k.find("#"+y).remove();var a=i.closest(".diff-file");if(a.length>0){var r=new CustomEvent("blur.imageDiff",{detail:e});a[0].dispatchEvent(r)}if(w&&i.find("textarea.js-note-text").trigger("clear-commands-cache.atwho"),t.clearFlashWrapper(),d){k.find(".flash-container").remove(),c&&i.attr("data-discussion-id",n.data("discussionId")).attr("data-resolve-all","true").attr("data-project-path",n.data("projectPath"));var u=0===k.length;if(t.addDiscussionNote(i,o,u),u){var f=i.find("#note_position").val();if(a.length>0&&f.length>0){var h=JSON.parse(f),m=h.x,p=h.y,v=h.width,g=h.height,b=new CustomEvent("addBadge.imageDiff",{detail:{x:m,y:p,width:v,height:g,noteId:"note_"+o.id,discussionId:o.discussion_id}});a[0].dispatchEvent(b)}}k.length&&k.append('<div class="flash-container" style="display: none;"></div>')}else l&&(t.addNote(i,o),t.reenableTargetFormSubmitButton(e));o.commands_changes&&t.handleQuickActions(o),i.trigger("ajax:success",[o])}).catch(function(){k.find("#"+y).remove(),n.prop("disabled",!1);var s=new CustomEvent("blur.imageDiff",{detail:e}),o=i.closest(".diff-file");if(o.length&&o[0].dispatchEvent(s),w&&k.find("#"+b).remove(),d&&k.length){var a=k.parent().find(".js-discussion-reply-button");t.replyToDiscussionNote(a[0]),i=k.parent().find("form")}i.find(".js-note-text").val(g),t.reenableTargetFormSubmitButton(e),t.addNoteError(i)})}},{key:"updateComment",value:function(e){var t=this;e.preventDefault();var n=s()(e.target).parents("form"),i=n.find(".js-note-target-close"),o=n.parents(".note.is-editing"),r=o.find(".js-task-list-container").find(".note-text"),l=this.getFormData(n),d=l.formData,c=l.formContent,u=l.formAction,f=(n.closest(".diff-file"),n.closest(".notes"),r.html());return r.html(c),o.removeClass("is-editing fade-in-full").addClass("being-posted fade-in-half"),o.find(".note-headline-meta a").html('<i class="fa fa-spinner fa-spin" aria-label="Comment is being updated" aria-hidden="true"></i>'),p.a.post(u+"?html=true",d).then(function(e){var n=e.data;t.updateNote(n,o)}).catch(function(){r.html(a.a.escape(f)),o.removeClass("being-posted fade-in"),o.find(".fa.fa-spinner").remove(),t.updateNoteError()}),i.text(i.data("originalText"))}}],[{key:"initCommentTypeToggle",value:function(e){var t=e.querySelector(".js-comment-type-dropdown .dropdown-toggle"),n=e.querySelector(".js-comment-type-dropdown .dropdown-menu"),i=e.querySelector("#note_type"),s=e.querySelector(".js-comment-type-dropdown .js-comment-submit-button"),o=e.querySelector(".js-note-target-close"),a=e.querySelector(".js-note-target-reopen");new j({dropdownTrigger:t,dropdownList:n,noteTypeInput:i,submitButton:s,closeButton:o,reopenButton:a}).initDroplab()}},{key:"updateNoteTargetSelector",value:function(e){var t=Object(v.a)(),n=Boolean(t&&e.filter("#"+t).length>0);e.toggleClass("target",n)}},{key:"renderPlaceholderComponent",value:function(e){var t=e.find(".js-code-placeholder").get(0);new f.default({el:t,components:{SkeletonLoadingContainer:m.a},render:function(e){return e("skeleton-loading-container")}})}},{key:"renderDiffContent",value:function(e,t){var n=t.discussion_html,i=s()(n).find(".line_holder");i.addClass("fade-in"),e.find(".diff-content > table > tbody").prepend(i);var o=e.find(".file-holder");e.find(".line-holder-placeholder").remove(),Object(h.a)(o)}},{key:"isNewNote",value:function(e,t){return-1===s.a.inArray(e.id,t)}},{key:"isUpdatedNote",value:function(e,t){return A(e.note.trim())!==A(t.find(".original-note-content").first().text().trim())}},{key:"checkMergeRequestStatus",value:function(){"merge_requests"===Object(T.i)(1)&&gl.mrWidget&&gl.mrWidget.checkStatus()}},{key:"animateAppendNote",value:function(e,t){var n=s()(e);return n.addClass("fade-in-full").renderGFM(),t.append(n),n}},{key:"animateUpdateNote",value:function(e,t){var n=s()(e);return n.addClass("fade-in").renderGFM(),t.replaceWith(n),n}}]),e}();t.a=L;window.Notes=L},228:function(e,t){!function(t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=!1;if(t.getComputedStyle){var o=n.createElement("div");["","-webkit-","-moz-","-ms-"].some(function(e){try{o.style.position=e+"sticky"}catch(e){}return""!=o.style.position})&&(s=!0)}else s=!0;var a="undefined"!=typeof ShadowRoot,r={top:null,left:null},l=[];function d(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function c(e){return parseFloat(e)||0}function u(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}var f=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t instanceof HTMLElement))throw new Error("First argument must be HTMLElement");if(l.some(function(e){return e._node===t}))throw new Error("Stickyfill is already applied to this node");this._node=t,this._stickyMode=null,this._active=!1,l.push(this),this.refresh()}return i(e,[{key:"refresh",value:function(){if(!s&&!this._removed){this._active&&this._deactivate();var e=this._node,i=getComputedStyle(e),o={top:i.top,display:i.display,marginTop:i.marginTop,marginBottom:i.marginBottom,marginLeft:i.marginLeft,marginRight:i.marginRight,cssFloat:i.cssFloat};if(!isNaN(parseFloat(o.top))&&"table-cell"!=o.display&&"none"!=o.display){this._active=!0;var r=e.parentNode,l=a&&r instanceof ShadowRoot?r.host:r,f=e.getBoundingClientRect(),h=l.getBoundingClientRect(),m=getComputedStyle(l);this._parent={node:l,styles:{position:l.style.position},offsetHeight:l.offsetHeight},this._offsetToWindow={left:f.left,right:n.documentElement.clientWidth-f.right},this._offsetToParent={top:f.top-h.top-c(m.borderTopWidth),left:f.left-h.left-c(m.borderLeftWidth),right:-f.right+h.right-c(m.borderRightWidth)},this._styles={position:e.style.position,top:e.style.top,bottom:e.style.bottom,left:e.style.left,right:e.style.right,width:e.style.width,marginTop:e.style.marginTop,marginLeft:e.style.marginLeft,marginRight:e.style.marginRight};var p=c(o.top);this._limits={start:f.top+t.pageYOffset-p,end:h.top+t.pageYOffset+l.offsetHeight-c(m.borderBottomWidth)-e.offsetHeight-p-c(o.marginBottom)};var v=m.position;"absolute"!=v&&"relative"!=v&&(l.style.position="relative"),this._recalcPosition();var g=this._clone={};g.node=n.createElement("div"),d(g.node.style,{width:f.right-f.left+"px",height:f.bottom-f.top+"px",marginTop:o.marginTop,marginBottom:o.marginBottom,marginLeft:o.marginLeft,marginRight:o.marginRight,cssFloat:o.cssFloat,padding:0,border:0,borderSpacing:0,fontSize:"1em",position:"static"}),r.insertBefore(g.node,e),g.docOffsetTop=u(g.node)}}}},{key:"_recalcPosition",value:function(){if(this._active&&!this._removed){var e=r.top<=this._limits.start?"start":r.top>=this._limits.end?"end":"middle";if(this._stickyMode!=e){switch(e){case"start":d(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:this._offsetToParent.top+"px",bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"middle":d(this._node.style,{position:"fixed",left:this._offsetToWindow.left+"px",right:this._offsetToWindow.right+"px",top:this._styles.top,bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"end":d(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:"auto",bottom:0,width:"auto",marginLeft:0,marginRight:0})}this._stickyMode=e}}}},{key:"_fastCheck",value:function(){this._active&&!this._removed&&(Math.abs(u(this._clone.node)-this._clone.docOffsetTop)>1||Math.abs(this._parent.node.offsetHeight-this._parent.offsetHeight)>1)&&this.refresh()}},{key:"_deactivate",value:function(){var e=this;this._active&&!this._removed&&(this._clone.node.parentNode.removeChild(this._clone.node),delete this._clone,d(this._node.style,this._styles),delete this._styles,l.some(function(t){return t!==e&&t._parent&&t._parent.node===e._parent.node})||d(this._parent.node.style,this._parent.styles),delete this._parent,this._stickyMode=null,this._active=!1,delete this._offsetToWindow,delete this._offsetToParent,delete this._limits)}},{key:"remove",value:function(){var e=this;this._deactivate(),l.some(function(t,n){if(t._node===e._node)return l.splice(n,1),!0}),this._removed=!0}}]),e}(),h={stickies:l,Sticky:f,addOne:function(e){if(!(e instanceof HTMLElement)){if(!e.length||!e[0])return;e=e[0]}for(var t=0;t<l.length;t++)if(l[t]._node===e)return l[t];return new f(e)},add:function(e){if(e instanceof HTMLElement&&(e=[e]),e.length){for(var t=[],n=function(n){var i=e[n];return i instanceof HTMLElement?l.some(function(e){if(e._node===i)return t.push(e),!0})?"continue":void t.push(new f(i)):(t.push(void 0),"continue")},i=0;i<e.length;i++)n(i);return t}},refreshAll:function(){l.forEach(function(e){return e.refresh()})},removeOne:function(e){if(!(e instanceof HTMLElement)){if(!e.length||!e[0])return;e=e[0]}l.some(function(t){if(t._node===e)return t.remove(),!0})},remove:function(e){if(e instanceof HTMLElement&&(e=[e]),e.length)for(var t=function(t){var n=e[t];l.some(function(e){if(e._node===n)return e.remove(),!0})},n=0;n<e.length;n++)t(n)},removeAll:function(){for(;l.length;)l[0].remove()}};s||function(){function e(){t.pageXOffset!=r.left?(r.top=t.pageYOffset,r.left=t.pageXOffset,h.refreshAll()):t.pageYOffset!=r.top&&(r.top=t.pageYOffset,r.left=t.pageXOffset,l.forEach(function(e){return e._recalcPosition()}))}e(),t.addEventListener("scroll",e),t.addEventListener("resize",h.refreshAll),t.addEventListener("orientationchange",h.refreshAll);var i=void 0;function s(){i=setInterval(function(){l.forEach(function(e){return e._fastCheck()})},500)}var o=void 0,a=void 0;"hidden"in n?(o="hidden",a="visibilitychange"):"webkitHidden"in n&&(o="webkitHidden",a="webkitvisibilitychange"),a?(n[o]||s(),n.addEventListener(a,function(){n[o]?clearInterval(i):s()})):s()}(),void 0!==e&&e.exports?e.exports=h:t.Stickyfill=h}(window,document)},243:function(e,t,n){(function(t){var n;n=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,n){var i,s,o,a,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};i=function(e){return Array.prototype.slice.apply(e)},o=function(e,t){for(;e&&!e.classList.contains(t);)e=e.parentNode;return e},a=function(e,t){var n;return"function"==typeof Event?(n=new Event(e,{bubbles:!0,cancelable:!0})).detail=t:(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,t),n},s=function(){function e(e){var t;this.el=e,this.container=o(this.el,"js-task-list-container"),this.field=this.container.querySelector(".js-task-list-field"),this.container.addEventListener("change",(t=this,function(e){if(e.target.classList.contains("task-list-item-checkbox"))return t.updateTaskList(e.target)})),this.enable()}return e.prototype.enable=function(){var e;if(this.container.querySelectorAll(".js-task-list-field").length>0)return i(this.container.querySelectorAll(".task-list-item")).forEach(function(e){return e.classList.add("enabled")}),i(this.container.querySelectorAll(".task-list-item-checkbox")).forEach(function(e){return e.disabled=!1}),this.container.classList.add("is-task-list-enabled"),e=a("tasklist:enabled"),this.container.dispatchEvent(e)},e.prototype.disable=function(){var e;return i(this.container.querySelectorAll(".task-list-item")).forEach(function(e){return e.classList.remove("enabled")}),i(this.container.querySelectorAll(".task-list-item-checkbox")).forEach(function(e){return e.disabled=!0}),this.container.classList.remove("is-task-list-enabled"),e=a("tasklist:disabled"),this.container.dispatchEvent(e)},e.prototype.updateTaskList=function(t){var n,s,o,r;if(o=this.container.querySelectorAll(".task-list-item-checkbox"),r=1+i(o).indexOf(t),n=a("tasklist:change",{index:r,checked:t.checked}),this.field.dispatchEvent(n),!n.defaultPrevented)return this.field.value=e.updateSource(this.field.value,r,t.checked),n=a("change"),this.field.dispatchEvent(n),s=a("tasklist:changed",{index:r,checked:t.checked}),this.field.dispatchEvent(s)},e.incomplete="[ ]",e.complete="[x]",e.escapePattern=function(e){return e.replace(/([\[\]])/g,"\\$1").replace(/\s/,"\\s").replace("x","[xX]")},e.incompletePattern=RegExp(""+e.escapePattern(e.incomplete)),e.completePattern=RegExp(""+e.escapePattern(e.complete)),e.itemPattern=RegExp("^(?:\\s*(?:>\\s*)*(?:[-+*]|(?:\\d+\\.)))\\s*("+e.escapePattern(e.complete)+"|"+e.escapePattern(e.incomplete)+")\\s+(?!\\(.*?\\))(?=(?:\\[.*?\\]\\s*(?:\\[.*?\\]|\\(.*?\\))\\s*)*(?:[^\\[]|$))"),e.startFencesPattern=/^`{3}.*$/,e.endFencesPattern=/^`{3}$/,e.itemsInParasPattern=RegExp("^("+e.escapePattern(e.complete)+"|"+e.escapePattern(e.incomplete)+").+$","g"),e.updateSource=function(e,t,n){var i,s,o,a;return i=e.replace(/\r/g,"").replace(this.itemsInParasPattern,"").split("\n"),o=0,s=!1,function(){var l,d,c,u;for(u=[],l=0,d=(c=e.split("\n")).length;l<d;l++)a=c[l],s?a.match(this.endFencesPattern)&&(s=!1):a.match(this.startFencesPattern)?s=!0:r.call(i,a)>=0&&a.match(this.itemPattern)&&(o+=1)===t&&(a=n?a.replace(this.incompletePattern,this.complete):a.replace(this.completePattern,this.incomplete)),u.push(a);return u}.call(this).join("\n")},e}(),void 0!==t&&(t.fn.taskList=function(e){return this.each(function(n,i){var o;if((o=t(i).data("task-list"))||(o=new s(i),t(i).data("task-list",o),e&&"enable"!==e))return o[e||"enable"]()})}),e.exports=s}])},e.exports=n()}).call(this,n(0))},276:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(186);t.a=function(e){Object(o.b)(document.querySelector(".js-diff-files-changed"),e),s()(".js-diff-stats-dropdown").glDropdown({filterable:!0,remoteFilter:!1})}},346:function(e,t,n){"use strict";var i=n(205);t.a=function(){var e=document.querySelector(".js-notes-data"),t=JSON.parse(e.innerHTML),n=t.notesUrl,s=t.notesIds,o=t.now,a=t.diffView,r=t.enableGFM;i.a.initialize(n,s,o,a,r)}},457:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(7),a=n(5),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t.container||"",this.dropdownListSelector=".js-builds-dropdown-container",this.getBuildsList=this.getBuildsList.bind(this)}return r(e,[{key:"bindEvents",value:function(){s()(document).off("shown.bs.dropdown",this.container).on("shown.bs.dropdown",this.container,this.getBuildsList)}},{key:"stopDropdownClickPropagation",value:function(){s()(document).on("click",this.container+" .js-builds-dropdown-list a.mini-pipeline-graph-dropdown-item",function(e){e.stopPropagation()})}},{key:"renderBuildsList",value:function(e,t){e.parentElement.querySelector(this.dropdownListSelector+" .js-builds-dropdown-list ul").innerHTML=t}},{key:"getBuildsList",value:function(e){var t=this,n=e.relatedTarget,i=n.dataset.stageEndpoint;this.renderBuildsList(n,""),this.toggleLoading(n),a.a.get(i).then(function(e){var i=e.data;t.toggleLoading(n),t.renderBuildsList(n,i.html),t.stopDropdownClickPropagation()}).catch(function(){t.toggleLoading(n),s()(n).parent().hasClass("open")&&s()(n).dropdown("toggle"),Object(o.a)("An error occurred while fetching the builds.","alert")})}},{key:"toggleLoading",value:function(e){e.parentElement.querySelector(this.dropdownListSelector+" .js-builds-dropdown-loading").classList.toggle("hidden")}}]),e}();t.a=l},65:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(50),a=n.n(o),r=n(53),l=n(24),d=n.n(l),c=n(3),u=n.n(c),f=(n(157),n(66)),h=n(5);function m(e){var t=e.find(".button-attach-file"),n=e.find(".attaching-file-message"),i=e.find(".button-cancel-uploading-files"),o=e.find(".retry-uploading-link"),a=e.find(".uploading-progress"),r=e.find(".uploading-error-container"),l=e.find(".uploading-error-message"),c=e.find(".uploading-progress-container"),m=window.uploads_path||null,p=gon.max_file_size||10,v=e.find(".js-gfm-input"),g=void 0,y=void 0,b=void 0,w=void 0,k=void 0,C=void 0,j=void 0;v.wrap('<div class="div-dropzone"></div>'),v.on("paste",function(e){return g(e)});var x=v.closest(".md-area");e.setupMarkdownPreview();var E=e.find(".div-dropzone");if(E.parent().addClass("div-dropzone-wrapper"),E.append('<div class="div-dropzone-hover"></div>'),E.find(".div-dropzone-hover").append('<i class="fa fa-paperclip div-dropzone-icon"></i>'),m){var _=E.dropzone({url:m,dictDefaultMessage:"",clickable:!0,paramName:"file",maxFilesize:p,uploadMultiple:!1,headers:f.a.headers,previewContainer:!1,processing:function(){return s()(".div-dropzone-alert").alert("close")},dragover:function(){x.addClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",.7)},dragleave:function(){x.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0)},drop:function(){x.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0),v.focus()},success:function(e,n){var i=this.getQueuedFiles().length+this.getUploadingFiles().length,s=i>=1;y(n.link.markdown,s),i||t.removeClass("hide"),b(n.link.url)},error:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Attaching the file failed.",s=arguments[2],o=s?s.responseText:n;r.removeClass("hide"),l.html(o),t.addClass("hide"),i.addClass("hide")},totaluploadprogress:function(e){w(this.files,n),a.text(Math.round(e)+"%")},sending:function(){t.addClass("hide"),r.addClass("hide"),c.removeClass("hide"),i.removeClass("hide")},removedfile:function(){t.removeClass("hide"),i.addClass("hide"),c.addClass("hide"),r.addClass("hide")},queuecomplete:function(){s()(".dz-preview").remove(),s()(".markdown-area").trigger("input"),c.addClass("hide"),i.addClass("hide")}}),N=s()(_[0]).children("textarea");i.on("click",function(e){e.preventDefault(),e.stopPropagation(),d.a.forElement(E.get(0)).removeAllFiles(!0)}),o.on("click",function(e){var t=d.a.forElement(e.target.closest(".js-main-target-form").querySelector(".div-dropzone")),n=t.files;e.preventDefault(),t.removeAllFiles(!0),n.map(function(e){var n=e;return n.status===d.a.ERROR&&(n.status=void 0,n.accepted=void 0),t.addFile(n)})}),g=function(e){var t=e.originalEvent;if(t.clipboardData&&t.clipboardData.items){var n=k(t);if(n){e.preventDefault();var i=C(t)||"image.png";return y("{{"+i+"}}"),j(n.getAsFile(),i)}}},k=function(e){for(var t=0;t<e.clipboardData.items.length;){var n=e.clipboardData.items[t];if(-1!==n.type.indexOf("image"))return n;t+=1}return!1},y=function(e,t){var n=e;t&&(n+="\n\n");var i=N.get(0),o=i.selectionStart,a=i.selectionEnd,r=s()(N).val().length,l=s()(N).val().substring(0,o),d=s()(N).val().substring(a,r);return s()(N).val(l+n+d),i.setSelectionRange(o+n.length,a+n.length),i.style.height=i.scrollHeight+"px",v.get(0).dispatchEvent(new Event("input")),v.trigger("input")},b=function(t){s()(e).append('<input type="hidden" name="files[]" value="'+u.a.escape(t)+'">')},C=function(e){var t=void 0;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),(t=t.split("\r"))[0]};var T=function(){return c.addClass("hide")};j=function(t,n){var i=new FormData;i.append("file",t,n),c.removeClass("hide"),e.find(".div-dropzone-alert").alert("close"),h.a.post(m,i).then(function(e){var t=e.data.link.markdown;!function(e,t){var n=s()(N);n.val(function(n,i){return i.replace("{{"+e+"}}",t)}),n.trigger("change")}(n,t),T()}).catch(function(e){var t;t=e.response.data.message,r.removeClass("hide"),l.html(t),T()})},w=function(e,t){var n=void 0,i=e.filter(function(e){return"uploading"===e.status||"queued"===e.status}).length;n=i>1?"Attaching "+i+" files -":"Attaching a file -",t.text(n)},e.find(".markdown-selector").click(function(e){e.preventDefault(),s()(this).closest(".gfm-form").find(".div-dropzone").click(),v.focus()})}else E.addClass("js-invalid-dropzone")}d.a.autoDiscover=!1;var p=n(11);function v(e,t,n,i){var o,a,r;return e=(o=s()(e)).get(0),a=function(e,t){return e.substring(t.selectionStart,t.selectionEnd)}(r=o.val(),e),o.focus(),function(e,t,n,i,s,o){var a,r,l,d,c,u,f;return d=!1,c=!1,u=!1,0===s.indexOf("\n")&&(c=!0,s=s.replace(/\n+/,"")),e.selectionEnd-e.selectionStart>s.replace(/\n$/,"").length&&(d=!0,s=s.replace(/\n$/,"")),r=s.split("\n"),o||(f=e.value.substr(0,e.selectionStart).lastIndexOf("\n"),/^\s*$/.test(e.value.substring(f,e.selectionStart))&&(u=!0)),l=!o&&!u&&e.selectionStart>0?"\n":"",a=r.length>1&&(!o||null!=i&&""!==i)?null!=i&&""!==i?function(e,t,n,i){var s=function(e,t){var n;return(n=e.substring(0,t.selectionStart).trim().split("\n"))[n.length-1]}(e,t),o=function(e,t){return e.substring(t.selectionEnd).trim().split("\n")[0]}(e,t);return s===n&&o===n?(null!=n&&(t.selectionStart=t.selectionStart-(n.length+1),t.selectionEnd=t.selectionEnd+(n.length+1)),i):n+"\n"+i+"\n"+n}(t,e,i,s):r.map(function(e){return 0===e.indexOf(n)?""+e.replace(n,""):""+n+e}).join("\n"):""+l+n+s+(o?n:" "),c&&(a="\n"+a),d&&(a+="\n"),Object(p.p)(e,a),function(e,t,n,i){var s;if(e.setSelectionRange)return e.selectionStart===e.selectionEnd?(s=n?e.selectionStart-t.length:e.selectionStart,i&&(s-=1),e.setSelectionRange(s,s)):void 0}(e,n,o,d)}(e,r,t,n,a,i)}var g=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var y=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=t,this.textarea=this.form.find("textarea.js-gfm-input"),this.enableGFM=Object.assign({},r.b,i);var s=gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources||{};Object.keys(this.enableGFM).forEach(function(e){"emojis"!==e&&(n.enableGFM[e]=!!s[e])}),this.destroy(),this.setupForm(),this.form.data("glForm",this)}return g(e,[{key:"destroy",value:function(){this.clearEventListeners(),this.autoComplete&&this.autoComplete.destroy(),this.form.data("glForm",null)}},{key:"setupForm",value:function(){var e,t=this.form.is(":not(.gfm-form)");this.form.removeClass("js-new-note-form"),t&&(this.form.find(".div-dropzone").remove(),this.form.addClass("gfm-form"),gl.utils.disableButtonIfEmptyField(this.form.find(".js-note-text"),this.form.find(".js-comment-button, .js-note-new-discussion")),this.autoComplete=new r.a(gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources),this.autoComplete.setup(this.form.find(".js-gfm-input"),this.enableGFM),m(this.form),a()(this.textarea)),this.addEventListeners(),e=this.form,s()(".js-md",e).off("click").on("click",function(){var e=s()(this);return v(e.closest(".md-area").find("textarea"),e.data("mdTag"),e.data("mdBlock"),!e.data("mdPrepend"))}),this.form.find(".js-note-discard").hide(),this.form.show(),this.isAutosizeable&&this.setupAutosize()}},{key:"setupAutosize",value:function(){var e=this;this.textarea.off("autosize:resized").on("autosize:resized",this.setHeightData.bind(this)),this.textarea.off("mouseup.autosize").on("mouseup.autosize",this.destroyAutosize.bind(this)),setTimeout(function(){a()(e.textarea),e.textarea.css("resize","vertical")},0)}},{key:"setHeightData",value:function(){this.textarea.data("height",this.textarea.outerHeight())}},{key:"destroyAutosize",value:function(){var e=this.textarea.outerHeight();this.textarea.data("height")!==e&&(a.a.destroy(this.textarea),this.textarea.data("height",e),this.textarea.outerHeight(e),this.textarea.css("max-height",window.outerHeight))}},{key:"clearEventListeners",value:function(){var e;this.textarea.off("focus"),this.textarea.off("blur"),e=this.form,s()(".js-md",e).off("click")}},{key:"addEventListeners",value:function(){this.textarea.on("focus",function(){s()(this).closest(".md-area").addClass("is-focused")}),this.textarea.on("blur",function(){s()(this).closest(".md-area").removeClass("is-focused")})}}]),e}();t.a=y},71:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=(n(158),n(24)),a=n.n(o),r=n(29),l=n.n(r),d=(n(99),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}());a.a.autoDiscover=!1;var c=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active_backdrop=null,this.active_textarea=null,s()(document).on("click",".js-zen-enter",function(e){return e.preventDefault(),s()(e.currentTarget).trigger("zen_mode:enter")}),s()(document).on("click",".js-zen-leave",function(e){return e.preventDefault(),s()(e.currentTarget).trigger("zen_mode:leave")}),s()(document).on("zen_mode:enter",(t=this,function(e){return t.enter(s()(e.target).closest(".md-area").find(".zen-backdrop"))})),s()(document).on("zen_mode:leave",function(e){return function(t){return e.exit()}}(this)),s()(document).on("keydown",function(e){if(27===e.keyCode)return e.preventDefault(),s()(document).trigger("zen_mode:leave")})}return d(e,[{key:"enter",value:function(e){l.a.pause(),this.active_backdrop=s()(e),this.active_backdrop.addClass("fullscreen"),this.active_textarea=this.active_backdrop.find("textarea"),this.active_textarea.removeAttr("style"),this.active_textarea.focus()}},{key:"exit",value:function(){if(this.active_textarea){l.a.unpause(),this.active_textarea.closest(".zen-backdrop").removeClass("fullscreen"),this.scrollTo(this.active_textarea),this.active_textarea=null,this.active_backdrop=null;var e=s()(".div-dropzone");e&&!e.hasClass("js-invalid-dropzone")&&a.a.forElement(".div-dropzone").enable()}}},{key:"scrollTo",value:function(e){return s.a.scrollTo(e,0,{offset:-150})}}]),e}();t.a=c},730:function(e,t){e.exports='<svg width="11" height="11" viewBox="0 0 9 13"><path d="M2.57568253,6.49866948 C2.50548852,6.57199715 2.44637866,6.59708255 2.39835118,6.57392645 C2.3503237,6.55077034 2.32631032,6.48902165 2.32631032,6.38867852 L2.32631032,-2.13272614 C2.32631032,-2.23306927 2.3503237,-2.29481796 2.39835118,-2.31797406 C2.44637866,-2.34113017 2.50548852,-2.31604477 2.57568253,-2.24271709 L6.51022184,1.86747129 C6.53977721,1.8983461 6.56379059,1.93500939 6.5822627,1.97746225 L6.5822627,2.27849013 C6.56379059,2.31708364 6.53977721,2.35374693 6.51022184,2.38848109 L2.57568253,6.49866948 Z" transform="translate(4.454287, 2.127976) rotate(90.000000) translate(-4.454287, -2.127976) "></path><path d="M3.74312342,2.09553332 C3.74312342,1.99519019 3.77821989,1.9083561 3.8484139,1.83502843 C3.91860791,1.76170075 4.00173115,1.72503747 4.09778611,1.72503747 L4.80711151,1.72503747 C4.90316647,1.72503747 4.98628971,1.76170075 5.05648372,1.83502843 C5.12667773,1.9083561 5.16177421,1.99519019 5.16177421,2.09553332 L5.16177421,10.2464421 C5.16177421,10.3467853 5.12667773,10.4336194 5.05648372,10.506947 C4.98628971,10.5802747 4.90316647,10.616938 4.80711151,10.616938 L4.09778611,10.616938 C4.00173115,10.616938 3.91860791,10.5802747 3.8484139,10.506947 C3.77821989,10.4336194 3.74312342,10.3467853 3.74312342,10.2464421 L3.74312342,2.09553332 Z" transform="translate(4.452449, 6.170988) rotate(-90.000000) translate(-4.452449, -6.170988) "></path><path d="M2.57568253,14.6236695 C2.50548852,14.6969971 2.44637866,14.7220826 2.39835118,14.6989264 C2.3503237,14.6757703 2.32631032,14.6140216 2.32631032,14.5136785 L2.32631032,5.99227386 C2.32631032,5.89193073 2.3503237,5.83018204 2.39835118,5.80702594 C2.44637866,5.78386983 2.50548852,5.80895523 2.57568253,5.88228291 L6.51022184,9.99247129 C6.53977721,10.0233461 6.56379059,10.0600094 6.5822627,10.1024622 L6.5822627,10.4034901 C6.56379059,10.4420836 6.53977721,10.4787469 6.51022184,10.5134811 L2.57568253,14.6236695 Z" transform="translate(4.454287, 10.252976) scale(1, -1) rotate(90.000000) translate(-4.454287, -10.252976) "></path></svg>\n'},82:function(e,t,n){"use strict";var i=n(89),s=n.n(i),o=n(128),a={name:"UserAvatarImage",directives:{tooltip:n(12).a},props:{lazy:{type:Boolean,required:!1,default:!1},imgSrc:{type:String,required:!1,default:s.a},cssClasses:{type:String,required:!1,default:""},imgAlt:{type:String,required:!1,default:"user avatar"},size:{type:Number,required:!1,default:20},tooltipText:{type:String,required:!1,default:""},tooltipPlacement:{type:String,required:!1,default:"top"}},computed:{sanitizedSource:function(){var e=""===this.imgSrc||null===this.imgSrc?s.a:this.imgSrc;return-1===e.indexOf("?")&&(e+="?width="+this.size),e},resultantSrcAttribute:function(){return this.lazy?o.b:this.sanitizedSource},tooltipContainer:function(){return this.tooltipText?"body":null},avatarSizeClass:function(){return"s"+this.size}}},r=n(2),l=Object(r.a)(a,function(){var e,t=this,n=t.$createElement;return(t._self._c||n)("img",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"avatar",class:(e={lazy:t.lazy},e[t.avatarSizeClass]=!0,e[t.cssClasses]=!0,e),attrs:{src:t.resultantSrcAttribute,width:t.size,height:t.size,alt:t.imgAlt,"data-src":t.sanitizedSource,"data-container":t.tooltipContainer,"data-placement":t.tooltipPlacement,title:t.tooltipText,"data-boundary":"window"}})},[],!1,null,null,null);t.a=l.exports},876:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n.n(i),o=n(176),a=n(71),r=n(87),l=n(457),d=n(346),c=n(276),u=n(8),f=n(38),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.notes={},this.loading=!1,this.canResolve=!1}return h(e,[{key:"createNote",value:function(e){u.default.set(this.notes,e.noteId,new NoteModel(this.id,e))}},{key:"deleteNote",value:function(e){u.default.delete(this.notes,e)}},{key:"getNote",value:function(e){return this.notes[e]}},{key:"notesCount",value:function(){return Object.keys(this.notes).length}},{key:"isResolved",value:function(){for(var e in this.notes){if(!this.notes[e].resolved)return!1}return!0}},{key:"resolveAllNotes",value:function(e){for(var t in this.notes){var n=this.notes[t];n.resolved||(n.resolved=!0,n.resolved_by=e)}}},{key:"unResolveAllNotes",value:function(){for(var e in this.notes){var t=this.notes[e];t.resolved&&(t.resolved=!1,t.resolved_by=null)}}},{key:"updateHeadline",value:function(e){var t='.discussion[data-discussion-id="'+this.id+'"]',n=s()(t+" .js-discussion-headline");e.discussion_headline_html?(n.length?n.replaceWith(e.discussion_headline_html):s()(t+" .discussion-header").append(e.discussion_headline_html),Object(f.e)(s()(".js-timeago",""+t))):n.remove()}},{key:"isResolvable",value:function(){if(!this.canResolve)return!1;for(var e in this.notes){if(this.notes[e].canResolve)return!0}return!1}}]),e}();window.DiscussionModel=m;n(1027);window.CommentsStore={state:{},get:function(e,t){return this.state[e].getNote(t)},createDiscussion:function(e,t){var n=this.state[e];return this.state[e]||(n=new DiscussionModel(e),u.default.set(this.state,e,n)),void 0!==t&&(n.canResolve=t),n},create:function(e){this.createDiscussion(e.discussionId).createNote(e)},update:function(e,t,n,i){var s=this.state[e].getNote(t);s.resolved=n,s.resolved_by=i},delete:function(e,t){var n=this.state[e];n.deleteNote(t),0===n.notesCount()&&u.default.delete(this.state,e)},unresolvedDiscussionIds:function(){var e=[];for(var t in this.state){var n=this.state[t];n.isResolved()||e.push(n.id)}return e}};var p=n(7),v=(n(389),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}());window.gl=window.gl||{};var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.noteResource=u.default.resource(t+"/notes{/noteId}/resolve?html=true"),this.discussionResource=u.default.resource(t+"/merge_requests{/mergeRequestId}/discussions{/discussionId}/resolve?html=true")}return v(e,[{key:"resolve",value:function(e){return this.noteResource.save({noteId:e},{})}},{key:"unresolve",value:function(e){return this.noteResource.delete({noteId:e},{})}},{key:"toggleResolveForDiscussion",value:function(e,t){var n=CommentsStore.state[t],i=n.isResolved();(i?this.unResolveAll(e,t):this.resolveAll(e,t)).then(function(e){return e.json()}).then(function(e){n.loading=!1;var t=e?e.resolved_by:null;i?n.unResolveAllNotes():n.resolveAllNotes(t),gl.mrWidget&&gl.mrWidget.checkStatus(),n.updateHeadline(e)}).catch(function(){return new p.a("An error occurred when trying to resolve a discussion. Please try again.")})}},{key:"resolveAll",value:function(e,t){return CommentsStore.state[t].loading=!0,this.discussionResource.save({mergeRequestId:e,discussionId:t},{})}},{key:"unResolveAll",value:function(e,t){return CommentsStore.state[t].loading=!0,this.discussionResource.delete({mergeRequestId:e,discussionId:t},{})}}]),e}();gl.DiffNotesResolveServiceClass=g;var y={computed:{discussionCount:function(){return Object.keys(this.discussions).length},resolvedDiscussionCount:function(){var e=0;for(var t in this.discussions){this.discussions[t].isResolved()&&(e+=1)}return e},unresolvedDiscussionCount:function(){var e=0;for(var t in this.discussions){this.discussions[t].isResolved()||(e+=1)}return e}}},b=u.default.extend({props:{discussionId:{type:String,required:!0}},data:function(){return{textareaIsEmpty:!0,discussion:{}}},computed:{showButton:function(){return!!this.discussion&&this.discussion.isResolvable()},isDiscussionResolved:function(){return this.discussion.isResolved()},buttonText:function(){return this.isDiscussionResolved?this.textareaIsEmpty?"Unresolve discussion":"Comment & unresolve discussion":this.textareaIsEmpty?"Resolve discussion":"Comment & resolve discussion"}},created:function(){this.discussionId&&(this.discussion=CommentsStore.state[this.discussionId])},mounted:function(){var e=this;if(this.discussionId){var t=s()(".js-discussion-note-form[data-discussion-id="+this.discussionId+"] .note-textarea");this.textareaIsEmpty=""===t.val(),t.on("input.comment-and-resolve-btn",function(){e.textareaIsEmpty=""===t.val()})}},destroyed:function(){this.discussionId&&s()(".js-discussion-note-form[data-discussion-id="+this.discussionId+"] .note-textarea").off("input.comment-and-resolve-btn")}});u.default.component("comment-and-resolve-btn",b);var w=u.default.extend({mixins:[y],props:{discussionId:{type:String,required:!0}},data:function(){return{discussions:CommentsStore.state,discussion:{}}},computed:{buttonText:function(){return this.discussionId?"Jump to next unresolved discussion":"Jump to first unresolved discussion"},allResolved:function(){return 0===this.unresolvedDiscussionCount},showButton:function(){return this.discussionId?this.unresolvedDiscussionCount>1||this.discussionId!==this.lastResolvedId:this.unresolvedDiscussionCount>=1},lastResolvedId:function(){var e=void 0;for(var t in this.discussions){var n=this.discussions[t];n.isResolved()||(e=n.id)}return e}},created:function(){this.discussion=this.discussions[this.discussionId]},methods:{jumpToNextUnresolvedDiscussion:function(){var e=void 0,t=void 0,n=void 0,i=void 0,o=window.mrTabs.currentAction,a=!0,r=!this.discussionId,l=function(e){return e.map(function(){return s()(this).attr("data-discussion-id")}).toArray()},d=this.discussions;if("diffs"===o){e=".diffs .notes[data-discussion-id]",t=l(s()(e));for(var c=0,u=0;u<t.length;u+=1){var f=d[t[u]];f&&!f.isResolved()&&(c+=1)}this.discussionId&&!this.discussion.isResolved()?1===c&&(a=!1):0===c&&(a=!1)}else"show"!==o&&(a=!1);a||(window.mrTabs.activateTab("show"),o="show",r=!0),"show"===o&&(e=".discussion[data-discussion-id]",t=l(s()(e)));for(var h=!1,m=0;m<t.length;m+=1){var p=t[m],v=d[p];if(v){if(!n&&!v.isResolved()&&(n=p,r))break;if(!r){if(h){if(v.isResolved())continue;i=p;break}p===this.discussionId&&(h=!0)}}}if(i=i||n){var g=s()(e+'[data-discussion-id="'+i+'"]');if("show"===o)(g=g.closest(".note-discussion")).find(".js-toggle-content").is(":hidden")&&g.find(".js-toggle-button i").trigger("click");else if("diffs"===o){g.closest(".content").show();var y=g.closest("tr.notes_holder");y.length>0&&(g=y),g.show();for(var b=void 0,w=0;w<4&&(b=g.prev()).hasClass("line_holder");w+=1)g=b}s.a.scrollTo(g,{offset:-150})}}}});u.default.component("jump-to-discussion",w);var k=u.default.extend({props:{noteId:{type:Number,required:!0},discussionId:{type:String,required:!0},resolved:{type:Boolean,required:!0},canResolve:{type:Boolean,required:!0},resolvedBy:{type:String,required:!0},authorName:{type:String,required:!0},authorAvatar:{type:String,required:!0},noteTruncated:{type:String,required:!0}},data:function(){return{discussions:CommentsStore.state,loading:!1}},computed:{discussion:function(){return this.discussions[this.discussionId]},note:function(){return this.discussion?this.discussion.getNote(this.noteId):{}},buttonText:function(){return this.isResolved?"Resolved by "+this.resolvedByName:this.canResolve?"Mark as resolved":"Unable to resolve"},isResolved:function(){return!!this.note&&this.note.resolved},resolvedByName:function(){return this.note.resolved_by}},watch:{discussions:{handler:"updateTooltip",deep:!0}},mounted:function(){s()(this.$refs.button).tooltip({container:"body"})},beforeDestroy:function(){CommentsStore.delete(this.discussionId,this.noteId)},created:function(){CommentsStore.create({discussionId:this.discussionId,noteId:this.noteId,canResolve:this.canResolve,resolved:this.resolved,resolvedBy:this.resolvedBy,authorName:this.authorName,authorAvatar:this.authorAvatar,noteTruncated:this.noteTruncated})},methods:{updateTooltip:function(){var e=this;this.$nextTick(function(){s()(e.$refs.button).tooltip("hide").tooltip("_fixTitle")})},resolve:function(){var e=this;if(this.canResolve){this.loading=!0,(this.isResolved?ResolveService.unresolve(this.noteId):ResolveService.resolve(this.noteId)).then(function(e){return e.json()}).then(function(t){e.loading=!1;var n=t?t.resolved_by:null;CommentsStore.update(e.discussionId,e.noteId,!e.isResolved,n),e.discussion.updateHeadline(t),gl.mrWidget.checkStatus(),e.updateTooltip()}).catch(function(){return new p.a("An error occurred when trying to resolve a comment. Please try again.")})}}}});u.default.component("resolve-btn",k),window.ResolveCount=u.default.extend({mixins:[y],props:{loggedOut:{type:Boolean,required:!0}},data:function(){return{discussions:CommentsStore.state}},computed:{allResolved:function(){return this.resolvedDiscussionCount===this.discussionCount},resolvedCountText:function(){return 1===this.discussionCount?"discussion":"discussions"}}});var C=u.default.extend({props:{discussionId:{type:String,required:!0},mergeRequestId:{type:Number,required:!0},canResolve:{type:Boolean,required:!0}},data:function(){return{discussion:{}}},computed:{showButton:function(){return!!this.discussion&&this.discussion.isResolvable()},isDiscussionResolved:function(){return!!this.discussion&&this.discussion.isResolved()},buttonText:function(){return this.isDiscussionResolved?"Unresolve discussion":"Resolve discussion"},loading:function(){return!!this.discussion&&this.discussion.loading}},created:function(){CommentsStore.createDiscussion(this.discussionId,this.canResolve),this.discussion=CommentsStore.state[this.discussionId]},methods:{resolve:function(){ResolveService.toggleResolveForDiscussion(this.mergeRequestId,this.discussionId)}}});u.default.component("resolve-discussion-btn",C);var j=n(730),x=n.n(j),E=n(205),_=n(82),N=u.default.extend({components:{userAvatarImage:_.a},props:{discussionId:{type:String,required:!0}},data:function(){return{isVisible:!1,lineType:"",storeState:CommentsStore.state,shownAvatars:3,collapseIcon:x.a}},computed:{discussionClassName:function(){return"js-diff-avatars-"+this.discussionId},notesSubset:function(){var e=this,t=[];return this.discussion&&(t=Object.keys(this.discussion.notes).slice(0,this.shownAvatars).map(function(t){return e.discussion.notes[t]})),t},extraNotesTitle:function(){if(this.discussion){var e=this.discussion.notesCount()-this.shownAvatars;return e+" more comment"+(e>1?"s":"")}return""},discussion:function(){return this.storeState[this.discussionId]},notesCount:function(){return this.discussion?this.discussion.notesCount():0},moreText:function(){return""+(this.notesCount<100?"+":"")+(this.notesCount-this.shownAvatars)}},watch:{storeState:{handler:function(){var e=this;this.$nextTick(function(){s()(".has-tooltip",e.$el).tooltip("_fixTitle"),e.addNoCommentClass()})},deep:!0}},mounted:function(){var e=this;this.$nextTick(function(){e.addNoCommentClass(),e.setDiscussionVisible(),e.lineType=s()(e.$el).closest(".diff-line-num").hasClass("old_line")?"old":"new"}),s()(document).on("toggle.comments",function(){e.$nextTick(function(){e.setDiscussionVisible()})})},beforeDestroy:function(){this.addNoCommentClass(),s()(document).off("toggle.comments")},methods:{clickedAvatar:function(e){var t=this;E.a.instance.onAddDiffNote(e),this.toggleDiscussionsToggleState(),this.$nextTick(function(){t.setDiscussionVisible(),s()(".has-tooltip",t.$el).tooltip("_fixTitle"),s()(".has-tooltip",t.$el).tooltip("hide")})},addNoCommentClass:function(){var e=this.notesCount;s()(this.$el).closest(".js-avatar-container").toggleClass("no-comment-btn",e>0).nextUntil(".js-avatar-container").toggleClass("no-comment-btn",e>0)},toggleDiscussionsToggleState:function(){var e=s()(this.$el).closest(".code").find(".notes_holder"),t=e.filter(":visible");s()(this.$el).closest(".diff-file").find(".js-toggle-diff-comments").toggleClass("active",e.length===t.length)},setDiscussionVisible:function(){this.isVisible=s()('.diffs .notes[data-discussion-id="'+this.discussion.id+'"]').is(":visible")},getTooltipText:function(e){return e.authorName+": "+e.noteTruncated}},template:'\n    <div class="diff-comment-avatar-holders"\n      :class="discussionClassName"\n      v-show="notesCount !== 0">\n      <div v-if="!isVisible">\n        \x3c!-- FIXME: Pass an alt attribute here for accessibility --\x3e\n        <user-avatar-image\n          v-for="note in notesSubset"\n          :key="note.id"\n          class="diff-comment-avatar js-diff-comment-avatar"\n          @click.native="clickedAvatar($event)"\n          :img-src="note.authorAvatar"\n          :tooltip-text="getTooltipText(note)"\n          :data-line-type="lineType"\n          :size="19"\n          data-html="true"\n        />\n        <span v-if="notesCount > shownAvatars"\n          class="diff-comments-more-count has-tooltip js-diff-comment-avatar"\n          data-container="body"\n          data-placement="top"\n          ref="extraComments"\n          role="button"\n          :data-line-type="lineType"\n          :title="extraNotesTitle"\n          @click="clickedAvatar($event)">{{ moreText }}</span>\n      </div>\n      <button class="diff-notes-collapse js-diff-comment-avatar"\n        type="button"\n        aria-label="Show comments"\n        :data-line-type="lineType"\n        @click="clickedAvatar($event)"\n        v-if="isVisible"\n        v-html="collapseIcon">\n      </button>\n    </div>\n  '});u.default.component("diff-note-avatars",N);var T=u.default.extend({props:{discussionId:{type:String,required:!0}},data:function(){return{discussions:CommentsStore.state}},computed:{discussion:function(){return this.discussions[this.discussionId]},showButton:function(){return!!this.discussion&&!this.discussion.isResolved()}}});u.default.component("new-issue-for-discussion-btn",T);var S=n(5),I=n(1);function A(e,t){var n=function(e,t){return 0===e?t+" "+Object(I.d)("merge request","merge requests",t):","}(e,t);return s()("<span />",{class:"append-right-5",text:n})}function D(e){var t=s()("<span />"),n=function(e){return s()("<a />",{class:"append-right-5",href:e.path,text:"!"+e.iid})}(e),i=function(e){return s()("<span />",{text:e.title})}(e);return t.append(n),t.append(i),t}function L(){var e=s()(".merge-requests");S.a.get(e.data("projectCommitPath")).then(function(t){var n=function(e){var t=s()("<span />");return 0===e.length?t.text(Object(I.e)("Commits|No related merge requests found")):e.forEach(function(n){var i=A(t.children().length,e.length),s=D(n);t.append(i),t.append(s)}),t}(t.data);e.html(n)}).catch(function(){return Flash(Object(I.e)("Commits|An error occurred while fetching merge requests data."))})}document.addEventListener("DOMContentLoaded",function(){new o.a,new a.a,new r.a,new l.a({container:".js-commit-pipeline-graph"}).bindEvents(),Object(d.a)();var e;Object(c.a)(document.querySelector(".navbar-gitlab").offsetHeight-16),s()(".commit-info.branches").load(document.querySelector(".js-commit-box").dataset.commitPath),L(),e=(document.querySelector(".merge-request")||document.querySelector(".commit-box")).dataset.projectPath,window.gl=window.gl||{},window.gl.diffNoteApps={},window.ResolveService=new gl.DiffNotesResolveServiceClass(e),gl.diffNotesCompileComponents=function(){s()("diff-note-avatars").each(function(){var e=(new(u.default.extend({template:s()(this).get(0).outerHTML}))).$mount();s()(this).replaceWith(e.$el),s()(e.$el).one("remove.vue",function(){e.$destroy(),e.$el.remove()})});var e=s()("resolve-btn, resolve-discussion-btn, jump-to-discussion, comment-and-resolve-btn, new-issue-for-discussion-btn").filter(function(){return 1!==s()(this).closest("resolve-count").length});e&&e.each(function(){var e=s()(this),t=e.attr(":note-id"),n=e.attr(":discussion-id");if(!e.is("comment-and-resolve-btn")||n){var i=(new(u.default.extend({template:e.get(0).outerHTML}))).$mount();t&&(gl.diffNoteApps["note_"+t]=i),e.replaceWith(i.$el)}})},gl.diffNotesCompileComponents(),s()(window).trigger("resize.nav")})},89:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABLCAAAAAAdJSU2AAACNElEQVR4AdXYBa7jMBCA4b3/JZahzIkjp2qt+BWUWnG5ln2XxaJJb2b5F2ukL4wvzK/rP7bUcbf92u6oftLSe1ldk8efsfaVeEjusZZeC6e1RllaCk/yG6ag1lZ4WwPX69uyD6tAe/g2ipAlNMRS37awDLaFrpcMWxXQOi0jnWCWjFkSZomYJWDWKmatYNZyEWkJsvQimoZYah5NgdaLxagCtF6GRy0DshZPkeYwS/KIJWGWYjwYUzDLxCwDtJ54OKglimBLqHWahii2g1pmHLLGBmwVoRjcKlmgOdw65H5qKuGWCVi5Qlhs6m1sENZi4q3AWNvca5UYy2RjT/SAsiZey6CsIvc0wVlV5lJ0ibPMyLUGCmlxQq0IM0hLdWyro7CWEc3sXsqaK4O2zLxOsmtpfW5Q1u68ZrVmepaaNXEewawtI9X5Xl3U3n1qND6+rfPzvqoIWz/fklNCSLY153YV53J/XUxGCJnKZ1lajsn3/Ffegf6Y5pV2LUsSNL2UHzxUfh3TlYpZqqTpXZm0KZk9zJcqaEmaWPHDw0pxe05K7bWOLHFLWXVetqpYmrjle4+1y0aBaF4UOQ1NU+lYezJClkjLUnSEjqhH6zjAW4OjtY39Ibq+sawUb6W2RQfoqG0VeKuwrRJvlba17faRdbe2pTtYq6Nty/S7yAbGsQjWIq41wVoT1+IdZNy1djUcVdu5lklQWC0xHkt1X31qNEE1Pr3qKv/9XiSNj6Aaifj3/69+AYujsR/MvkpZAAAAAElFTkSuQmCC"},93:function(e,t,n){"use strict";function i(e,t){var n=t.x,i=t.y,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=document.createElement("button");return s.concat(["js-image-badge"]).forEach(function(e){return o.classList.add(e)}),o.setAttribute("type","button"),o.setAttribute("disabled",!0),o.dataset.noteId=e,o.style.left=n+"px",o.style.top=i+"px",o}function s(e,t){var n=t.x,i=t.y,s=document.createElement("button");s.classList.add("btn-transparent"),s.classList.add("comment-indicator"),s.setAttribute("type","button"),s.style.left=n+"px",s.style.top=i+"px",s.innerHTML=gl.utils.spriteIcon("image-comment-dark"),e.appendChild(s)}var o={x:0,y:0,width:0,height:0},a=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.noteId,i=t.discussionId;this.actual=t.actual||o,this.browser=t.browser||o,this.noteId=n,this.discussionId=i,t.imageEl&&!t.browser&&(this.browser=w.resizeCoordinatesToImageElement(t.imageEl,this.actual))},r=n(0),l=n.n(r);var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.canCreateNote=!(!n||!n.canCreateNote),this.renderCommentBadge=!(!n||!n.renderCommentBadge),this.$noteContainer=l()(".note-container",this.el),this.imageBadges=[]}return d(e,[{key:"init",value:function(){this.imageFrameEl=this.el.querySelector(".diff-file .js-image-frame"),this.imageEl=this.imageFrameEl.querySelector("img"),this.bindEvents()}},{key:"bindEvents",value:function(){var e;this.imageClickedWrapper=this.imageClicked.bind(this),this.imageBlurredWrapper=w.removeCommentIndicator.bind(null,this.imageFrameEl),this.addBadgeWrapper=this.addBadge.bind(this),this.removeBadgeWrapper=this.removeBadge.bind(this),this.renderBadgesWrapper=this.renderBadges.bind(this),(e=this.imageEl).complete&&0!==e.naturalHeight?this.renderBadges():this.imageEl.addEventListener("load",this.renderBadgesWrapper),this.$noteContainer.on("click",".js-diff-notes-toggle",w.toggleCollapsed),l()(this.el).on("click",".comment-indicator",w.commentIndicatorOnClick),this.canCreateNote&&(this.el.addEventListener("click.imageDiff",this.imageClickedWrapper),this.el.addEventListener("blur.imageDiff",this.imageBlurredWrapper),this.el.addEventListener("addBadge.imageDiff",this.addBadgeWrapper),this.el.addEventListener("removeBadge.imageDiff",this.removeBadgeWrapper))}},{key:"imageClicked",value:function(e){var t=e.detail,n=w.getTargetSelection(t),i=t.currentTarget;w.setPositionDataAttribute(i,n.actual),w.showCommentIndicator(this.imageFrameEl,n.browser)}},{key:"renderBadges",value:function(){var e=this.el.querySelectorAll(".note-container .discussion-notes .notes");[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e)).forEach(this.renderBadge.bind(this))}},{key:"renderBadge",value:function(e,t){var n=w.generateBadgeFromDiscussionDOM(this.imageFrameEl,e);this.imageBadges.push(n);var i={coordinate:n.browser,noteId:n.noteId};if(this.renderCommentBadge)w.addImageCommentBadge(this.imageFrameEl,i);else{var s=Object.assign({},i,{badgeText:t+1});w.addImageBadge(this.imageFrameEl,s)}}},{key:"addBadge",value:function(e){var t=e.detail,n=t.x,i=t.y,s=t.width,o=t.height,r=t.noteId,l=t.discussionId,d=this.imageBadges.length+1,c=new a({actual:{x:n,y:i,width:s,height:o},imageEl:this.imageFrameEl.querySelector("img"),noteId:r,discussionId:l});this.imageBadges.push(c),w.addImageBadge(this.imageFrameEl,{coordinate:c.browser,badgeText:d,noteId:r}),w.addAvatarBadge(this.el,{detail:{noteId:r,badgeNumber:d}});var u=this.el.querySelector("#discussion_"+l);w.updateDiscussionBadgeNumber(u,d)}},{key:"removeBadge",value:function(e){var t=this,n=e.detail.badgeNumber,i=n-1,s=this.imageFrameEl.querySelectorAll(".badge");this.imageBadges.length!==n&&this.imageBadges.forEach(function(e,n){if(n>i){var o=e.discussionId,a=n,r=t.el.querySelector("#discussion_"+o);s[n].innerText=a,w.updateDiscussionBadgeNumber(r,a),w.updateDiscussionAvatarBadgeNumber(r,a)}}),this.imageBadges.splice(i,1),s[i].remove()}}]),e}(),u={TWO_UP:"TWO_UP",SWIPE:"SWIPE",ONION_SKIN:"ONION_SKIN"};var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c),f(t,[{key:"init",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.TWO_UP;this.imageFrameEls=(h(e={},u.TWO_UP,this.el.querySelector(".two-up .js-image-frame")),h(e,u.SWIPE,this.el.querySelector(".swipe .js-image-frame")),h(e,u.ONION_SKIN,this.el.querySelector(".onion-skin .js-image-frame")),e);var i=this.el.querySelector(".view-modes-menu");this.viewModesEls=(h(t={},u.TWO_UP,i.querySelector(".two-up")),h(t,u.SWIPE,i.querySelector(".swipe")),h(t,u.ONION_SKIN,i.querySelector(".onion-skin")),t),this.currentView=n,this.generateImageEls(),this.bindEvents()}},{key:"generateImageEls",value:function(){var e=this;this.imageEls={},Object.getOwnPropertyNames(u).forEach(function(t){e.imageEls[t]=e.imageFrameEls[t].querySelector("img")})}},{key:"bindEvents",value:function(){(function e(t,n,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,n);if(void 0===s){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in s)return s.value;var a=s.get;return void 0!==a?a.call(i):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bindEvents",this).call(this),this.changeToViewTwoUp=this.changeView.bind(this,u.TWO_UP),this.changeToViewSwipe=this.changeView.bind(this,u.SWIPE),this.changeToViewOnionSkin=this.changeView.bind(this,u.ONION_SKIN),this.viewModesEls[u.TWO_UP].addEventListener("click",this.changeToViewTwoUp),this.viewModesEls[u.SWIPE].addEventListener("click",this.changeToViewSwipe),this.viewModesEls[u.ONION_SKIN].addEventListener("click",this.changeToViewOnionSkin)}},{key:"changeView",value:function(e){if(t=e,Object.getOwnPropertyNames(u).find(function(e){return e===t})){var t,n=w.removeCommentIndicator(this.imageFrameEl);this.currentView=e;var i=this.imageFrameEl.querySelectorAll(".badge");[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(i)).map(function(e){return e.remove()}),this.imageBadges=[],setTimeout(this.renderNewView.bind(this,n),250)}}},{key:"renderNewView",value:function(e){if(this.renderBadges(),e.removed){var t=w.resizeCoordinatesToImageElement(this.imageEl,{x:e.x,y:e.y,width:e.image.width,height:e.image.height});w.showCommentIndicator(this.imageFrameEl,t)}}},{key:"imageEl",get:function(){return this.imageEls[this.currentView]}},{key:"imageFrameEl",get:function(){return this.imageFrameEls[this.currentView]}}]),t}(),p=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,s=!1,o=void 0;try{for(var a,r=e[Symbol.iterator]();!(i=(a=r.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var g=900,y=["two-up","swipe"],b=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.views={"two-up":function(){return l()(".two-up.view .wrap",this.file).each((e=this,function(t,n){return l()("img",n).each(function(){if(l()(this).width()>g/2)return l()(this).width(g/2)}),e.requestImageInfo(l()("img",n),function(e,t){return l()(".image-info .meta-width",n).text(e+"px"),l()(".image-info .meta-height",n).text(t+"px"),l()(".image-info",n).removeClass("hide")})}));var e},swipe:function(){var e,t,n;return t=0,e=0,l()(".swipe.view",this.file).each((n=this,function(i,s){var o,a,r,d,c,u;u=n.prepareFrames(s),o=p(u,2),t=o[0],e=o[1],d=l()(".swipe-frame",s),a=l()(".swipe-wrap",s),r=l()(".swipe-bar",s),d.css({width:t+16,height:e+28}),a.css({width:t+1,height:e+2}),r.css({left:1}),c=parseInt(a.css("right").replace("px",""),10),n.initDraggable(r,c,function(e,n){n>0&&n<d.width()-2*c&&(a.width(t+1-n),r.css("left",n))})}))},"onion-skin":function(){var e,t,n,i;return n=0,t=0,e=l()(".drag-track",this.file).width()-l()(".dragger",this.file).width(),l()(".onion-skin.view",this.file).each((i=this,function(s,o){var a,r,d,c,u,f,h;h=i.prepareFrames(o),a=p(h,2),n=a[0],t=a[1],r=l()(".onion-skin-frame",o),u=l()(".frame.added",o),d=l()(".drag-track",o),c=l()(".dragger",d),r.css({width:n+16,height:t+28}),l()(".swipe-wrap",o).css({width:n+1,height:t+2}),c.css({left:e}),u.css("opacity",1),f=parseInt(u.css("right").replace("px",""),10),i.initDraggable(c,f,function(t,n){var i=n/e;i>=0&&i<=1&&(c.css("left",n),u.css("opacity",i))})}))}},this.file=t,this.requestImageInfo(l()(".two-up.view .frame.deleted img",this.file),(n=this,function(e,t){return n.requestImageInfo(l()(".two-up.view .frame.added img",n.file),function(e,t){n.initViewModes(),l()(".two-up.view img",n.file).waitForImages(function(){n.initView("two-up")})})}))}return v(e,[{key:"initViewModes",value:function(){var e,t=y[0];return l()(".view-modes",this.file).removeClass("hide"),l()(".view-modes-menu",this.file).on("click","li",(e=this,function(t){if(!l()(t.currentTarget).hasClass("active"))return e.activateViewMode(t.currentTarget.className)})),this.activateViewMode(t)}},{key:"activateViewMode",value:function(e){return l()(".view-modes-menu li",this.file).removeClass("active").filter("."+e).addClass("active"),l()(".view:visible:not(."+e+")",this.file).fadeOut(200,(t=this,function(){return l()(".view."+e,t.file).fadeIn(200),t.initView(e)}));var t}},{key:"initView",value:function(e){return this.views[e].call(this)}},{key:"initDraggable",value:function(e,t,n){var i=!1,s=l()("body"),o=e.parent();e.off("mousedown").on("mousedown",function(){i=!0,s.css("user-select","none")}),s.off("mouseup").off("mousemove").on("mouseup",function(){i=!1,s.css("user-select","")}).on("mousemove",function(e){var s;i&&(s=e.pageX-(o.offset().left+t),n(e,s))})}},{key:"prepareFrames",value:function(e){var t,n;return n=0,t=0,l()(".frame",e).each(function(e,i){var s,o;return o=l()(i).width(),s=l()(i).height(),n=o>n?o:n,t=s>t?s:t}).css({width:n,height:t}),[n,t]}},{key:"requestImageInfo",value:function(e,t){var n,i=e.get(0);if(i)return i.complete?t.call(this,i.naturalWidth,i.naturalHeight):e.on("load",(n=this,function(){return t.call(n,i.naturalWidth,i.naturalHeight)}))}}]),e}();var w=t.a={addCommentIndicator:s,removeCommentIndicator:function(e){var t=e.querySelector(".comment-indicator"),n=e.querySelector("img"),i=!!t,s={};return i&&(s={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),image:{width:n.width,height:n.height}},t.remove()),Object.assign({},s,{removed:i})},showCommentIndicator:function(e,t){var n=t.x,i=t.y,o=e.querySelector(".comment-indicator");o?(o.style.left=n+"px",o.style.top=i+"px"):s(e,t)},commentIndicatorOnClick:function(e){e.stopPropagation(),e.currentTarget.closest(".diff-viewer").querySelector(".note-container .note-textarea").focus()},addImageBadge:function(e,t){var n=t.coordinate,s=t.badgeText,o=i(t.noteId,n,["badge"]);o.innerText=s,e.appendChild(o)},addImageCommentBadge:function(e,t){var n=t.coordinate,s=i(t.noteId,n,["image-comment-badge"]);s.innerHTML=gl.utils.spriteIcon("image-comment-dark"),e.appendChild(s)},addAvatarBadge:function(e,t){var n=t.detail,i=n.noteId,s=n.badgeNumber,o=e.querySelector("#"+i+" .badge");o.innerText=s,o.classList.remove("hidden")},setPositionDataAttribute:function(e,t){var n=t.x,i=t.y,s=t.width,o=t.height,a=e.dataset.position,r=Object.assign({},JSON.parse(a),{x:n,y:i,width:s,height:o});e.setAttribute("data-position",JSON.stringify(r))},updateDiscussionAvatarBadgeNumber:function(e,t){e.querySelector(".image-diff-avatar-link .badge").innerText=t},updateDiscussionBadgeNumber:function(e,t){e.querySelector(".badge").innerText=t},toggleCollapsed:function(e){var t=e.currentTarget.closest(".discussion-notes"),n=t.querySelector(".discussion-form"),i=t.classList.contains("collapsed");i?t.classList.remove("collapsed"):t.classList.add("collapsed"),n&&!i?n.style.display="none":n&&i&&(n.style.display="block")},resizeCoordinatesToImageElement:function(e,t){var n=t.x,i=t.y,s=t.width,o=t.height,a=e.width,r=e.height,l=a/s,d=r/o;return{x:Math.round(n*l),y:Math.round(i*d),width:a,height:r}},generateBadgeFromDiscussionDOM:function(e,t){var n=JSON.parse(t.dataset.position),i=t.querySelector(".note");return new a({actual:n,imageEl:e.querySelector("img"),noteId:i.id,discussionId:t.dataset.discussionId})},getTargetSelection:function(e){var t=e.currentTarget.querySelector("img"),n=e.offsetX,i=e.offsetY,s=t.width,o=t.height,a=t.naturalWidth,r=t.naturalHeight,l=a/s,d=r/o,c=Math.max(0,n)&&Math.min(n,s),u=Math.max(0,i)&&Math.min(i,o);return{browser:{x:c,y:u,width:s,height:o},actual:{x:Math.round(c*l),y:Math.round(u*d),width:a,height:r}}},initImageDiff:function(e,t,n){var i={canCreateNote:t,renderCommentBadge:n},s=void 0;return new b(e),e.querySelector(".diff-file .js-single-image")?(s=new c(e,i)).init():e.querySelector(".diff-file .js-replaced-image")&&(s=new m(e,i)).init(),s}}},98:function(e,t,n){"use strict";var i=n(76),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(t,n){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.isLocalStorageAvailable=i.a.isLocalStorageAccessSafe(),null!=n.join&&(n=n.join("/")),this.key="autosave/"+n,this.field.data("autosave",this),this.restore(),this.field.on("input",function(){return s.save()})}return s(e,[{key:"restore",value:function(){if(this.isLocalStorageAvailable&&this.field.length){var e=window.localStorage.getItem(this.key);(null!=e?e.length:void 0)>0&&this.field.val(e),this.field.trigger("input");var t=new Event("change",{bubbles:!0,cancelable:!1}),n=this.field.get(0);n&&n.dispatchEvent(t)}}},{key:"save",value:function(){if(this.field.length){var e=this.field.val();return this.isLocalStorageAvailable&&(null!=e?e.length:void 0)>0?window.localStorage.setItem(this.key,e):this.reset()}}},{key:"reset",value:function(){if(this.isLocalStorageAvailable)return window.localStorage.removeItem(this.key)}},{key:"dispose",value:function(){this.field.off("input")}}]),e}();t.a=o},99:function(e,t){Mousetrap=function(e){var t=e,n=t.stopCallback,i=!0;return t.stopCallback=function(e,t,s){return!i||n(e,t,s)},t.pause=function(){i=!1},t.unpause=function(){i=!0},t}(Mousetrap)}},[[1028,0,1,2,3]]]);
//# sourceMappingURL=pages.projects.commit.show.de3d7f80.chunk.js.map