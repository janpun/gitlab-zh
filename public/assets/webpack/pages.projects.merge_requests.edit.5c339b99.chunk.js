(this.webpackJsonp=this.webpackJsonp||[]).push([[130,4,7,16],{107:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(3),s=n.n(r),o=n(1),l=n(5),u=n(79),d=n(64),c=n(117),h=n(7),f=n(47),p=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var v=function(){function e(t){var n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,i=a()(t),t||(i=a()(".js-label-select")),i.each(function(t,i){var u,m,v,g,b,w,y,k,C,_,D,x,j,E,I,S,O,T,M,F,L,N;N=(m=a()(i)).closest(".labels-filter"),m.find(".dropdown-toggle-text"),x=m.data("namespacePath"),j=m.data("projectPath"),D=m.data("labels"),_=m.data("issueUpdate"),null==(I=m.data("selected"))||m.hasClass("js-multiselect")||(I=I.split(",")),O=m.data("showNo"),S=m.data("showAny"),L=m.data("showMenuAbove"),C=m.data("defaultLabel")||"Label",k=m.data("abilityName"),u=(b=m.closest(".selectbox")).closest(".block"),v=m.closest("form, .js-issuable-update"),w=u.find(".sidebar-collapsed-icon span"),T=u.find(".js-sidebar-labels-tooltip"),y=u.find(".value"),g=u.find(".block-loading").fadeOut(),F=m.data("fieldName"),m.is(".js-issuable-form-dropdown, .js-filter-bulk-update, .js-label-sidebar-dropdown"),M=b.find('input[name="'+m.data("fieldName")+'"]').map(function(){return this.value}).get();var A=r.handleClick;T.tooltip(),m.closest(".dropdown").find(".dropdown-new-label").length&&new c.a(m.closest(".dropdown").find(".dropdown-new-label"),x,j),E=function(){var t,n;n=m.closest(".selectbox").find("input[name='"+F+"']").map(function(){return this.value}).get(),s.a.isEqual(M,n)||(M=n,(t={})[k]={},t[k].label_ids=n,n.length||(t[k].label_ids=[""]),g.removeClass("hidden").fadeIn(),m.trigger("loading.gl.dropdown"),l.a.put(_,t).then(function(t){var n,i,r,s,l=t.data;g.fadeOut(),m.trigger("loaded.gl.dropdown"),b.hide(),l.issueUpdateURL=_,n=0,l.labels.length&&_?(i=e.getLabelTemplate({labels:l.labels,issueUpdateURL:_}),n=l.labels.length):i='<span class="no-value">None</span>',y.removeAttr("style").html(i),w.text(n),l.labels.length?((s=l.labels.map(function(e){return e.title})).length>5&&(s=s.slice(0,5)).push("and "+(l.labels.length-5)+" more"),r=s.join(", ")):r=Object(o.a)("Labels"),T.attr("title",r).tooltip("_fixTitle"),a()(".has-tooltip",y).tooltip({container:"body"})}).catch(function(){return Object(h.a)(Object(o.a)("Error saving label update."))}))},m.glDropdown({showMenuAbove:L,data:function(e,t){l.a.get(D).then(function(e){var n=s.a.chain(e.data).groupBy(function(e){return e.title}).map(function(e){var t;return t=s.a.map(e,function(e){return e.color}),{id:e[0].id,title:e[0].title,color:t,duplicate:t.length>1}}).value();if(m.hasClass("js-extra-options")){var i=[];O&&i.unshift({id:0,title:"No Label"}),S&&i.unshift({isAny:!0,title:"Any Label"}),i.length&&(i.push("divider"),n=i.concat(n))}t(n),L&&m.data("glDropdown").positionMenuAbove()}).catch(function(){return Object(h.a)(Object(o.a)("Error fetching labels."))})},renderRow:function(e,t){var n,i,r,o,l,u,c,h,f,g,b;(i=a()("<li>"),n=a()('<a href="#">'),c=[],u=e.id<=0||null==e.id,m.hasClass("js-filter-bulk-update")?(l=m.data("indeterminate")||[],f=m.data("marked")||[],-1!==l.indexOf(e.id)&&c.push("is-indeterminate"),-1!==f.indexOf(e.id)&&(-1!==(h=c.indexOf("is-indeterminate"))&&c.splice(h,1),c.push("is-active"))):(this.id(e)&&(g=m.data("fieldName"),b=this.id(e).toString().replace(/'/g,"\\'"),v.find("input[type='hidden'][name='"+g+"'][value='"+b+"']").length&&c.push("is-active")),m.hasClass("js-multiselect")&&u&&c.push("dropdown-clear-active")),e.duplicate)?r=d.a.duplicateLabelColor(e.color):null!=e.color&&(r=p(e.color,1)[0]);return o=r?"<span class='dropdown-label-box' style='background: "+r+"'></span>":"",e.id&&(c.push("label-item"),n.attr("data-label-id",e.id)),n.addClass(c.join(" ")).html(o+" "+s.a.escape(e.title)),i.html(n).prop("outerHTML")},search:{fields:["title"]},selectable:!0,filterable:!0,selected:m.data("selected")||[],toggleLabel:function(e,t){var n=m.parent(),i=n.find(".dropdown-input-field"),a=null!==t&&t.hasClass("is-active"),r=e?e.title:null,s=this.selected;if(i.length&&i.val().length&&n.find(".dropdown-input-clear").trigger("click"),e&&0===e.id)return this.selected=[],"No Label";if(a)this.selected.push(r);else if(!a&&r){var o=this.selected.indexOf(r);this.selected.splice(o,1)}return 1===s.length?s:s.length?s[0]+" +"+(s.length-1)+" more":C},fieldName:m.data("fieldName"),id:function(e){return e.id<=0?e.title:m.hasClass("js-issuable-form-dropdown")?e.id:m.hasClass("js-filter-submit")&&null==e.isAny?e.title:e.id},hidden:function(){var e,t,n;e="projects:issues:index"===(n=a()("body").attr("data-page")),t="projects:merge_requests:index"===n,b.hide(),y.removeAttr("style"),m.hasClass("js-issuable-form-dropdown")||a()("html").hasClass("issue-boards-page")||m.hasClass("js-multiselect")&&(m.hasClass("js-filter-submit")&&(e||t)?(m.closest("form").find("input:hidden[name='"+m.data("fieldName")+"']"),Issuable.filterResults(m.closest("form"))):m.hasClass("js-filter-submit")?m.closest("form").submit():m.hasClass("js-filter-bulk-update")||E())},multiSelect:m.hasClass("js-multiselect"),vue:m.hasClass("js-issue-board-sidebar"),clicked:function(e){var t,i,r,s,o=e.$el,l=e.e,u=e.isMarking,d=e.selectedObj,c=function(){g.fadeOut()};if(t="projects:issues:index"===(r=a()("body").attr("data-page")),i="projects:merge_requests:index"===r,m.parent().find(".is-active:not(.dropdown-clear-active)").length&&m.parent().find(".dropdown-clear-active").removeClass("is-active"),!m.hasClass("js-issuable-form-dropdown")){if(m.hasClass("js-filter-bulk-update"))return n.enableBulkLabelDropdown(),void n.setDropdownData(m,u,d.id);if(m.closest(".add-issues-modal").length&&(s=f.a.store.filter),s)return d.isAny?s.label_name=[]:o.hasClass("is-active")&&s.label_name.push(d.title),void l.preventDefault();if(m.hasClass("js-filter-submit")&&(t||i)){if(!m.hasClass("js-multiselect"))return I=d.title,Issuable.filterResults(m.closest("form"))}else{if(m.hasClass("js-filter-submit"))return m.closest("form").submit();if(m.hasClass("js-issue-board-sidebar")){if(o.hasClass("is-active"))gl.issueBoards.BoardsStore.detail.issue.labels.push(new ListLabel({id:d.id,title:d.title,color:d.color[0],textColor:"#fff"}));else{var h=gl.issueBoards.BoardsStore.detail.issue.labels;h=h.filter(function(e){return e.id!==d.id}),gl.issueBoards.BoardsStore.detail.issue.labels=h}g.fadeIn(),gl.issueBoards.BoardsStore.detail.issue.update(m.attr("data-issue-update")).then(c).catch(c)}else if(A)l.preventDefault(),A(d);else if(!m.hasClass("js-multiselect"))return E()}}},opened:function(e){if(m.hasClass("js-issue-board-sidebar")){var t=m.attr("data-selected");this.selected=t?t.split(","):[],m.data("glDropdown").updateLabel()}},preserveContext:!0}),n.setOriginalDropdownData(N,m)}),this.bindEvents()}return m(e,[{key:"bindEvents",value:function(){return a()("body").on("change",".selected_issue",this.onSelectCheckboxIssue)}},{key:"onSelectCheckboxIssue",value:function(){if(!a()(".selected_issue:checked").length)return a()(".issues-bulk-update .labels-filter .dropdown-toggle-text").text("Label")}},{key:"enableBulkLabelDropdown",value:function(){u.a.willUpdateLabels=!0}},{key:"setDropdownData",value:function(e,t,n){var i,a,r,s;a=e.data("marked")||[],r=e.data("unmarked")||[],s=e.data("indeterminate")||[],t?(a.push(n),(i=s.indexOf(n))>-1&&s.splice(i,1),(i=r.indexOf(n))>-1&&r.splice(i,1)):((i=a.indexOf(n))>-1&&a.splice(i,1),u.a.getOriginalIndeterminateIds().indexOf(n)>-1&&r.push(n),u.a.getOriginalCommonIds().indexOf(n)>-1&&r.push(n)),e.data("marked",a),e.data("unmarked",r),e.data("indeterminate",s)}},{key:"setOriginalDropdownData",value:function(e,t){var n=[];e.find('[name="label_name[]"]').map(function(){return n.push(this.value)}),t.data("marked",n)}}],[{key:"getLabelTemplate",value:function(e){return s.a.template(["<% _.each(labels, function(label){ %>",'<a href="<%- issueUpdateURL.slice(0, issueUpdateURL.lastIndexOf("/")) %>?label_name[]=<%- encodeURIComponent(label.title) %>">','<span class="badge label has-tooltip color-label" title="<%- label.description %>" style="background-color: <%- label.color %>; color: <%- label.text_color %>;">',"<%- label.title %>","</span>","</a>","<% }); %>"].join(""))(e)}}]),e}();t.a=v},117:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(33),s=n(45),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var l=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.namespacePath=n,this.projectPath=i,this.$dropdownBack=a()(".dropdown-menu-back",this.$el.closest(".dropdown")),this.$cancelButton=a()(".js-cancel-label-btn",this.$el),this.$newLabelField=a()("#new_label_name",this.$el),this.$newColorField=a()("#new_label_color",this.$el),this.$colorPreview=a()(".js-dropdown-label-color-preview",this.$el),this.$newLabelError=a()(".js-label-error",this.$el),this.$newLabelCreateButton=a()(".js-new-label-btn",this.$el),this.$colorSuggestions=a()(".suggest-colors-dropdown a",this.$el),this.$newLabelError.hide(),this.$newLabelCreateButton.disable(),this.cleanBinding(),this.addBinding()}return o(e,[{key:"cleanBinding",value:function(){this.$colorSuggestions.off("click"),this.$newLabelField.off("keyup change"),this.$newColorField.off("keyup change"),this.$dropdownBack.off("click"),this.$cancelButton.off("click"),this.$newLabelCreateButton.off("click")}},{key:"addBinding",value:function(){var e=this;this.$colorSuggestions.on("click",function(t){var n=a()(this);e.addColorValue(t,n)}),this.$newLabelField.on("keyup change",this.enableLabelCreateButton.bind(this)),this.$newColorField.on("keyup change",this.enableLabelCreateButton.bind(this)),this.$dropdownBack.on("click",this.resetForm.bind(this)),this.$cancelButton.on("click",function(t){t.preventDefault(),t.stopPropagation(),e.resetForm(),e.$dropdownBack.trigger("click")}),this.$newLabelCreateButton.on("click",this.saveLabel.bind(this))}},{key:"addColorValue",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.$newColorField.val(t.data("color")).trigger("change"),this.$colorPreview.css("background-color",t.data("color")).parent().addClass("is-active")}},{key:"enableLabelCreateButton",value:function(){""!==this.$newLabelField.val()&&""!==this.$newColorField.val()?(this.$newLabelError.hide(),this.$newLabelCreateButton.enable()):this.$newLabelCreateButton.disable()}},{key:"resetForm",value:function(){this.$newLabelField.val("").trigger("change"),this.$newColorField.val("").trigger("change"),this.$colorPreview.css("background-color","").parent().removeClass("is-active")}},{key:"saveLabel",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),r.a.newLabel(this.namespacePath,this.projectPath,{title:this.$newLabelField.val(),color:this.$newColorField.val()},function(e){if(t.$newLabelCreateButton.enable(),e.message){var n=void 0;n="string"==typeof e.message?e.message:Object.keys(e.message).map(function(t){return Object(s.h)(t)+" "+e.message[t].join(", ")}).join("<br/>"),t.$newLabelError.html(n).show()}else t.$dropdownBack.trigger("click"),a()(document).trigger("created.label",e)})}}]),e}();t.a=l},176:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(5),s=n(7),o=n(1),l=n(21),u=n(39),d=n.n(u),c={init:function(e){var t=this;this.userCanCreateNote||(this.userCanCreateNote=""===e.closest(".files").data("canCreateNote")),this.isParallelView="parallel"===d.a.get("diff_view"),this.userCanCreateNote&&e.on("mouseover",".diff-line-num, .line_content",function(e){return t.showButton(t.isParallelView,e)}).on("mouseleave",".diff-line-num, .line_content",function(e){return t.hideButton(t.isParallelView,e)})},showButton:function(e,t){var n=this.getButtonParent(t.currentTarget,e);this.validateButtonParent(n)&&(n.classList.add("is-over"),n.nextElementSibling.classList.add("is-over"))},hideButton:function(e,t){var n=this.getButtonParent(t.currentTarget,e);n.classList.remove("is-over"),n.nextElementSibling.classList.remove("is-over")},getButtonParent:function(e,t){if(t){if(!e.classList.contains("diff-line-num"))return e.previousElementSibling}else if(!e.classList.contains("old_line"))return e.parentNode.querySelector(".old_line");return e},validateButtonParent:function(e){return!(e.classList.contains("empty-cell")||e.classList.contains("js-unfold")||e.classList.contains("no-comment-btn")||e.parentNode.classList.contains("diff-expanded"))}},h=n(93),f=n(129),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var m='<div class="diff-content"></div>',v='<i class="fa fa-spinner fa-spin"></i>',g='<div class="nothing-here-block diff-collapsed">This diff is collapsed. <button class="click-to-expand btn btn-link">Click to expand it.</button></div>',b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.toggleDiff=this.toggleDiff.bind(this),this.content=a()(".diff-content",this.file),this.$toggleIcon=a()(".diff-toggle-caret",this.file),this.diffForPath=this.content.find("[data-diff-for-path]").data("diffForPath"),this.isOpen=!this.diffForPath,this.diffForPath?(this.collapsedContent=this.content,this.loadingContent=a()(m).addClass("loading").html(v).hide(),this.content=null,this.collapsedContent.after(this.loadingContent),this.$toggleIcon.addClass("fa-caret-right")):(this.collapsedContent=a()(m).html(g).hide(),this.content.after(this.collapsedContent),this.$toggleIcon.addClass("fa-caret-down")),a()(".js-file-title, .click-to-expand",this.file).on("click",function(e){this.toggleDiff(a()(e.target))}.bind(this))}return p(e,[{key:"toggleDiff",value:function(e,t){if(e.hasClass("js-file-title")||e.hasClass("click-to-expand")||e.hasClass("diff-toggle-caret"))if(this.isOpen=!this.isOpen,this.isOpen||this.hasError){if(!this.content)return this.$toggleIcon.addClass("fa-caret-down").removeClass("fa-caret-right"),this.getContentHTML(t);this.collapsedContent.hide(),this.content.show(),this.$toggleIcon.addClass("fa-caret-down").removeClass("fa-caret-right"),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents()}else this.content.hide(),this.$toggleIcon.addClass("fa-caret-right").removeClass("fa-caret-down"),this.collapsedContent.show(),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents()}},{key:"getContentHTML",value:function(e){var t=this;this.collapsedContent.hide(),this.loadingContent.show(),r.a.get(this.diffForPath).then(function(n){var i=n.data;t.loadingContent.hide(),i.html?(t.content=a()(i.html),Object(f.a)(t.content)):(t.hasError=!0,t.content=a()('<div class="nothing-here-block"><i class="fa fa-warning"></i> Could not load diff</div>')),t.collapsedContent.after(t.content),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents();var r=a()(t.file);c.init(r);var s=r.closest(".files").is("[data-can-create-note]");h.a.initImageDiff(r[0],s),e&&e()}).catch(function(){Object(s.a)(Object(o.a)("An error occurred while retrieving diff"))})}}]),e}(),w=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var k=!1,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=a()(".files .diff-file");t.each(function(e,t){a.a.data(t,"singleFileDiff")||a.a.data(t,"singleFileDiff",new b(t))});var n=document.getElementById("diffs");(!n||n&&n.dataset&&""!==n.dataset.isLocked)&&c.init(t);var i=a()(".files").first().get(0),r=i&&i.hasAttribute("data-can-create-note");t.each(function(e,t){return h.a.initImageDiff(t,r)}),k||(a()(document).on("click",".js-unfold",this.handleClickUnfold.bind(this)).on("click",".diff-line-num a",this.handleClickLineNum.bind(this)).on("mousedown","td.line_content.parallel",this.handleParallelLineDown.bind(this)),k=!0),Object(l.a)()&&this.highlightSelectedLine(),this.openAnchoredDiff()}return y(e,[{key:"handleClickUnfold",value:function(e){var t=a()(e.target),n=this.lineNumbers(t.parent()),i=w(n,2),l=i[0],u=i[1],d=u-l,c=t.hasClass("js-unfold-bottom"),h=void 0,f=void 0,p=!0;if(c){var m=u+1;h=m,f=m+20}else{var v=u-1;h=v-20,f=v;var g=this.lineNumbers(t.parent().prev())[1];h<=g+1&&(h=g+1,p=!1)}var b=t.parents(".diff-file"),y=b.data("blobDiffPath"),k={since:h,to:f,bottom:c,offset:d,unfold:p,view:b.data("view")};r.a.get(y,{params:k}).then(function(e){var n=e.data;return t.parent().replaceWith(n)}).catch(function(){return Object(s.a)(Object(o.a)("An error occurred while loading diff"))})}},{key:"openAnchoredDiff",value:function(e){var t=this,n=Object(l.a)(),i=n&&n.split("_")[0];if(i){var r=a()("#"+i).closest(".diff-file");if(a()(".nothing-here-block:visible",r).length){var s=a()(".js-file-title, .click-to-expand",r);r.data("singleFileDiff").toggleDiff(s,function(){t.highlightSelectedLine(),e&&e()})}else e&&e()}}},{key:"handleClickLineNum",value:function(e){var t=a()(e.currentTarget).attr("href");e.preventDefault(),window.history.pushState?window.history.pushState(null,null,t):window.location.hash=t,this.highlightSelectedLine()}},{key:"handleParallelLineDown",value:function(e){var t=a()(e.currentTarget),n=t.closest("table");n.removeClass("left-side-selected right-side-selected");var i=["left-side","right-side"].filter(function(e){return t.hasClass(e)})[0];i&&n.addClass(i+"-selected")}},{key:"diffViewType",value:function(){return a()(".inline-parallel-buttons a.active").data("viewType")}},{key:"lineNumbers",value:function(e){var t=e.find(".diff-line-num").toArray();return 2!==t.length?[0,0]:t.map(function(e){return parseInt(a()(e).data("linenumber"),10)||0})}},{key:"highlightSelectedLine",value:function(){var e=Object(l.a)(),t=a()(".diff-file");t.find(".hll").removeClass("hll"),e&&t.find("tr#"+e+":not(.match) td, td#"+e+', td[data-line-code="'+e+'"]').addClass("hll")}}]),e}();t.a=C},196:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(33),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.dropdown,i=t.data,r=t.pattern,s=t.wrapper,o=t.editor,l=t.$input;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pattern=r,this.editor=o,this.dropdown=n,this.$dropdownContainer=s,this.$filenameInput=l||a()("#file_name"),this.$dropdownIcon=a()(".fa-chevron-down",n),this.initDropdown(n,i),this.listenForFilenameInput(),this.renderMatchedDropdown(),this.initAutosizeUpdateEvent()}return s(e,[{key:"initDropdown",value:function(e,t){var n=this;return a()(e).glDropdown({data:t,filterable:!0,selectable:!0,toggleLabel:function(e){return e.name},search:{fields:["name"]},clicked:function(e){return n.fetchFileTemplate(e)},text:function(e){return e.name}})}},{key:"initAutosizeUpdateEvent",value:function(){this.autosizeUpdateEvent=document.createEvent("Event"),this.autosizeUpdateEvent.initEvent("autosize:update",!0,!1)}},{key:"listenForFilenameInput",value:function(){var e=this;return this.$filenameInput.on("keyup blur",function(t){return e.renderMatchedDropdown(t)})}},{key:"renderMatchedDropdown",value:function(){return this.$filenameInput.length?this.pattern.test(this.$filenameInput.val().trim())?this.$dropdownContainer.removeClass("hidden"):this.$dropdownContainer.addClass("hidden"):null}},{key:"fetchFileTemplate",value:function(e){var t=e.e,n=e.selectedObj;return t.preventDefault(),this.requestFile(n)}},{key:"requestFile",value:function(e){}},{key:"setEditorContent",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipFocus;if(e){var n=e.content;this.editor.setValue(n,1),t||this.editor.focus(),this.editor instanceof a.a&&this.editor.get(0).dispatchEvent(this.autosizeUpdateEvent)}}},{key:"startLoadingSpinner",value:function(){this.$dropdownIcon.addClass("fa-spinner fa-spin").removeClass("fa-chevron-down")}},{key:"stopLoadingSpinner",value:function(){this.$dropdownIcon.addClass("fa-chevron-down").removeClass("fa-spinner fa-spin")}}]),e}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var u=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s.projectPath=s.dropdown.data("projectPath"),s.namespacePath=s.dropdown.data("namespacePath"),s.issuableType=s.$dropdownContainer.data("issuableType"),s.titleInput=a()("#"+s.issuableType+"_title");var o={name:s.dropdown.data("selected")};return o.name&&s.requestFile(o),a()(".reset-template",s.dropdown.parent()).on("click",function(){s.setInputValueToTemplateContent()}),a()(".no-template",s.dropdown.parent()).on("click",function(){s.currentTemplate.content="",s.setInputValueToTemplateContent(),a()(".dropdown-toggle-text",s.dropdown).text("Choose a template")}),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),l(t,[{key:"requestFile",value:function(e){var t=this;this.startLoadingSpinner(),r.a.issueTemplate(this.namespacePath,this.projectPath,e.name,this.issuableType,function(e,n){t.currentTemplate=n,t.stopLoadingSpinner(),e||t.setInputValueToTemplateContent()})}},{key:"setInputValueToTemplateContent",value:function(){""===this.titleInput.val()?(this.setEditorContent(this.currentTemplate,{skipFocus:!0}),this.titleInput.focus()):this.setEditorContent(this.currentTemplate,{skipFocus:!1})}}]),t}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var c=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.$dropdowns,r=n.editor;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$dropdowns=i||a()(".js-issuable-selector"),this.editor=r||this.initEditor(),this.$dropdowns.each(function(e,n){var i=a()(n);new u({pattern:/(\.md)/,data:i.data("data"),wrapper:i.closest(".js-issuable-selector-wrap"),dropdown:i,editor:t.editor})})}return d(e,[{key:"initEditor",value:function(){var e=a()(".markdown-area");return e.setValue=e.val,e.getValue=e.val,e}}]),e}();t.a=c},222:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(73),s=n.n(r),o=n(98),l=n(81),u=n(53),d=n(71),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var f=0,p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$selectElement=a()(t),this.dropdownClass="js-auto-width-select-dropdown-"+f,f+=1}return h(e,[{key:"init",value:function(){var t=this.dropdownClass;return this.$selectElement.select2(c({dropdownCssClass:t},e.selectOptions(this.dropdownClass))),this}}],[{key:"selectOptions",value:function(e){return{dropdownCss:function(){var t="auto",n=a()("."+e),i=a()(this).parent().offsetParent().width();return n.css("width","auto"),n.outerWidth(!1)>i&&(t=i),{width:t,maxWidth:i}}}}}]),e}(),m=n(36),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},g=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var b=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=t,this.toggleWip=this.toggleWip.bind(this),this.renderWipExplanation=this.renderWipExplanation.bind(this),this.resetAutosave=this.resetAutosave.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.wipRegex=/^\s*(\[WIP\]\s*|WIP:\s*|WIP\s+)+\s*/i,new u.a(gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources).setup(),new l.a,new d.a,this.titleField=this.form.find('input[name*="[title]"]'),this.descriptionField=this.form.find('textarea[name*="[description]"]'),this.titleField.length&&this.descriptionField.length){this.initAutosave(),this.form.on("submit",this.handleSubmit),this.form.on("click",".btn-cancel",this.resetAutosave),this.initWip();var n=a()("#issuable-due-date");if(n.length){var i=new s.a({field:n.get(0),theme:"gitlab-theme animate-picker",format:"yyyy-mm-dd",container:n.parent().get(0),parse:function(e){return Object(m.a)(e)},toString:function(e){return Object(m.b)(e)},onSelect:function(e){return n.val(i.toString(e))}});i.setDate(Object(m.a)(n.val()))}this.$targetBranchSelect=a()(".js-target-branch-select",this.form),this.$targetBranchSelect.length&&this.initTargetBranchDropdown()}}return g(e,[{key:"initAutosave",value:function(){return new o.a(this.titleField,[document.location.pathname,document.location.search,"title"]),new o.a(this.descriptionField,[document.location.pathname,document.location.search,"description"])}},{key:"handleSubmit",value:function(){return this.resetAutosave()}},{key:"resetAutosave",value:function(){return this.titleField.data("autosave").reset(),this.descriptionField.data("autosave").reset()}},{key:"initWip",value:function(){if(this.$wipExplanation=this.form.find(".js-wip-explanation"),this.$noWipExplanation=this.form.find(".js-no-wip-explanation"),this.$wipExplanation.length&&this.$noWipExplanation.length)return this.form.on("click",".js-toggle-wip",this.toggleWip),this.titleField.on("keyup blur",this.renderWipExplanation),this.renderWipExplanation()}},{key:"workInProgress",value:function(){return this.wipRegex.test(this.titleField.val())}},{key:"renderWipExplanation",value:function(){return this.workInProgress()?(this.$wipExplanation.show(),this.$noWipExplanation.hide()):(this.$wipExplanation.hide(),this.$noWipExplanation.show())}},{key:"toggleWip",value:function(e){return e.preventDefault(),this.workInProgress()?this.removeWip():this.addWip(),this.renderWipExplanation()}},{key:"removeWip",value:function(){return this.titleField.val(this.titleField.val().replace(this.wipRegex,""))}},{key:"addWip",value:function(){this.titleField.val("WIP: "+this.titleField.val())}},{key:"initTargetBranchDropdown",value:function(){this.$targetBranchSelect.select2(v({},p.selectOptions("js-target-branch-select"),{ajax:{url:this.$targetBranchSelect.data("endpoint"),dataType:"JSON",quietMillis:250,data:function(e){return{search:e}},results:function(e){return{results:e[Object.keys(e)[0]].map(function(e){return{id:e,text:e}})}}},initSelection:function(e,t){var n=e.val();t({id:n,text:n})}}))}}]),e}();t.a=b},343:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(176),s=n(87),o=n(65),l=n(222),u=n(107),d=n(132),c=n(196);t.a=function(){new r.a,new s.a,new o.a(a()(".merge-request-form")),new l.a(a()(".merge-request-form")),new u.a,new d.a,new c.a}},36:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r});var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return("0"+e).slice(-t)},a=function(e){var t=e.split("-"),n=parseInt(t[0],10),i=parseInt(t[1]-1,10),a=parseInt(t[2],10);return new Date(n,i,a)},r=function(e){var t=i(e.getDate()),n=i(e.getMonth()+1);return e.getFullYear()+"-"+n+"-"+t}},65:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(50),s=n.n(r),o=n(53),l=n(24),u=n.n(l),d=n(3),c=n.n(d),h=(n(157),n(66)),f=n(5);function p(e){var t=e.find(".button-attach-file"),n=e.find(".attaching-file-message"),i=e.find(".button-cancel-uploading-files"),r=e.find(".retry-uploading-link"),s=e.find(".uploading-progress"),o=e.find(".uploading-error-container"),l=e.find(".uploading-error-message"),d=e.find(".uploading-progress-container"),p=window.uploads_path||null,m=gon.max_file_size||10,v=e.find(".js-gfm-input"),g=void 0,b=void 0,w=void 0,y=void 0,k=void 0,C=void 0,_=void 0;v.wrap('<div class="div-dropzone"></div>'),v.on("paste",function(e){return g(e)});var D=v.closest(".md-area");e.setupMarkdownPreview();var x=e.find(".div-dropzone");if(x.parent().addClass("div-dropzone-wrapper"),x.append('<div class="div-dropzone-hover"></div>'),x.find(".div-dropzone-hover").append('<i class="fa fa-paperclip div-dropzone-icon"></i>'),p){var j=x.dropzone({url:p,dictDefaultMessage:"",clickable:!0,paramName:"file",maxFilesize:m,uploadMultiple:!1,headers:h.a.headers,previewContainer:!1,processing:function(){return a()(".div-dropzone-alert").alert("close")},dragover:function(){D.addClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",.7)},dragleave:function(){D.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0)},drop:function(){D.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0),v.focus()},success:function(e,n){var i=this.getQueuedFiles().length+this.getUploadingFiles().length,a=i>=1;b(n.link.markdown,a),i||t.removeClass("hide"),w(n.link.url)},error:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Attaching the file failed.",a=arguments[2],r=a?a.responseText:n;o.removeClass("hide"),l.html(r),t.addClass("hide"),i.addClass("hide")},totaluploadprogress:function(e){y(this.files,n),s.text(Math.round(e)+"%")},sending:function(){t.addClass("hide"),o.addClass("hide"),d.removeClass("hide"),i.removeClass("hide")},removedfile:function(){t.removeClass("hide"),i.addClass("hide"),d.addClass("hide"),o.addClass("hide")},queuecomplete:function(){a()(".dz-preview").remove(),a()(".markdown-area").trigger("input"),d.addClass("hide"),i.addClass("hide")}}),E=a()(j[0]).children("textarea");i.on("click",function(e){e.preventDefault(),e.stopPropagation(),u.a.forElement(x.get(0)).removeAllFiles(!0)}),r.on("click",function(e){var t=u.a.forElement(e.target.closest(".js-main-target-form").querySelector(".div-dropzone")),n=t.files;e.preventDefault(),t.removeAllFiles(!0),n.map(function(e){var n=e;return n.status===u.a.ERROR&&(n.status=void 0,n.accepted=void 0),t.addFile(n)})}),g=function(e){var t=e.originalEvent;if(t.clipboardData&&t.clipboardData.items){var n=k(t);if(n){e.preventDefault();var i=C(t)||"image.png";return b("{{"+i+"}}"),_(n.getAsFile(),i)}}},k=function(e){for(var t=0;t<e.clipboardData.items.length;){var n=e.clipboardData.items[t];if(-1!==n.type.indexOf("image"))return n;t+=1}return!1},b=function(e,t){var n=e;t&&(n+="\n\n");var i=E.get(0),r=i.selectionStart,s=i.selectionEnd,o=a()(E).val().length,l=a()(E).val().substring(0,r),u=a()(E).val().substring(s,o);return a()(E).val(l+n+u),i.setSelectionRange(r+n.length,s+n.length),i.style.height=i.scrollHeight+"px",v.get(0).dispatchEvent(new Event("input")),v.trigger("input")},w=function(t){a()(e).append('<input type="hidden" name="files[]" value="'+c.a.escape(t)+'">')},C=function(e){var t=void 0;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),(t=t.split("\r"))[0]};var I=function(){return d.addClass("hide")};_=function(t,n){var i=new FormData;i.append("file",t,n),d.removeClass("hide"),e.find(".div-dropzone-alert").alert("close"),f.a.post(p,i).then(function(e){var t=e.data.link.markdown;!function(e,t){var n=a()(E);n.val(function(n,i){return i.replace("{{"+e+"}}",t)}),n.trigger("change")}(n,t),I()}).catch(function(e){var t;t=e.response.data.message,o.removeClass("hide"),l.html(t),I()})},y=function(e,t){var n=void 0,i=e.filter(function(e){return"uploading"===e.status||"queued"===e.status}).length;n=i>1?"Attaching "+i+" files -":"Attaching a file -",t.text(n)},e.find(".markdown-selector").click(function(e){e.preventDefault(),a()(this).closest(".gfm-form").find(".div-dropzone").click(),v.focus()})}else x.addClass("js-invalid-dropzone")}u.a.autoDiscover=!1;var m=n(11);function v(e,t,n,i){var r,s,o;return e=(r=a()(e)).get(0),s=function(e,t){return e.substring(t.selectionStart,t.selectionEnd)}(o=r.val(),e),r.focus(),function(e,t,n,i,a,r){var s,o,l,u,d,c,h;return u=!1,d=!1,c=!1,0===a.indexOf("\n")&&(d=!0,a=a.replace(/\n+/,"")),e.selectionEnd-e.selectionStart>a.replace(/\n$/,"").length&&(u=!0,a=a.replace(/\n$/,"")),o=a.split("\n"),r||(h=e.value.substr(0,e.selectionStart).lastIndexOf("\n"),/^\s*$/.test(e.value.substring(h,e.selectionStart))&&(c=!0)),l=!r&&!c&&e.selectionStart>0?"\n":"",s=o.length>1&&(!r||null!=i&&""!==i)?null!=i&&""!==i?function(e,t,n,i){var a=function(e,t){var n;return(n=e.substring(0,t.selectionStart).trim().split("\n"))[n.length-1]}(e,t),r=function(e,t){return e.substring(t.selectionEnd).trim().split("\n")[0]}(e,t);return a===n&&r===n?(null!=n&&(t.selectionStart=t.selectionStart-(n.length+1),t.selectionEnd=t.selectionEnd+(n.length+1)),i):n+"\n"+i+"\n"+n}(t,e,i,a):o.map(function(e){return 0===e.indexOf(n)?""+e.replace(n,""):""+n+e}).join("\n"):""+l+n+a+(r?n:" "),d&&(s="\n"+s),u&&(s+="\n"),Object(m.p)(e,s),function(e,t,n,i){var a;if(e.setSelectionRange)return e.selectionStart===e.selectionEnd?(a=n?e.selectionStart-t.length:e.selectionStart,i&&(a-=1),e.setSelectionRange(a,a)):void 0}(e,n,r,u)}(e,o,t,n,s,i)}var g=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var b=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=t,this.textarea=this.form.find("textarea.js-gfm-input"),this.enableGFM=Object.assign({},o.b,i);var a=gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources||{};Object.keys(this.enableGFM).forEach(function(e){"emojis"!==e&&(n.enableGFM[e]=!!a[e])}),this.destroy(),this.setupForm(),this.form.data("glForm",this)}return g(e,[{key:"destroy",value:function(){this.clearEventListeners(),this.autoComplete&&this.autoComplete.destroy(),this.form.data("glForm",null)}},{key:"setupForm",value:function(){var e,t=this.form.is(":not(.gfm-form)");this.form.removeClass("js-new-note-form"),t&&(this.form.find(".div-dropzone").remove(),this.form.addClass("gfm-form"),gl.utils.disableButtonIfEmptyField(this.form.find(".js-note-text"),this.form.find(".js-comment-button, .js-note-new-discussion")),this.autoComplete=new o.a(gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources),this.autoComplete.setup(this.form.find(".js-gfm-input"),this.enableGFM),p(this.form),s()(this.textarea)),this.addEventListeners(),e=this.form,a()(".js-md",e).off("click").on("click",function(){var e=a()(this);return v(e.closest(".md-area").find("textarea"),e.data("mdTag"),e.data("mdBlock"),!e.data("mdPrepend"))}),this.form.find(".js-note-discard").hide(),this.form.show(),this.isAutosizeable&&this.setupAutosize()}},{key:"setupAutosize",value:function(){var e=this;this.textarea.off("autosize:resized").on("autosize:resized",this.setHeightData.bind(this)),this.textarea.off("mouseup.autosize").on("mouseup.autosize",this.destroyAutosize.bind(this)),setTimeout(function(){s()(e.textarea),e.textarea.css("resize","vertical")},0)}},{key:"setHeightData",value:function(){this.textarea.data("height",this.textarea.outerHeight())}},{key:"destroyAutosize",value:function(){var e=this.textarea.outerHeight();this.textarea.data("height")!==e&&(s.a.destroy(this.textarea),this.textarea.data("height",e),this.textarea.outerHeight(e),this.textarea.css("max-height",window.outerHeight))}},{key:"clearEventListeners",value:function(){var e;this.textarea.off("focus"),this.textarea.off("blur"),e=this.form,a()(".js-md",e).off("click")}},{key:"addEventListeners",value:function(){this.textarea.on("focus",function(){a()(this).closest(".md-area").addClass("is-focused")}),this.textarea.on("blur",function(){a()(this).closest(".md-area").removeClass("is-focused")})}}]),e}();t.a=b},71:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=(n(158),n(24)),s=n.n(r),o=n(29),l=n.n(o),u=(n(99),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}());s.a.autoDiscover=!1;var d=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active_backdrop=null,this.active_textarea=null,a()(document).on("click",".js-zen-enter",function(e){return e.preventDefault(),a()(e.currentTarget).trigger("zen_mode:enter")}),a()(document).on("click",".js-zen-leave",function(e){return e.preventDefault(),a()(e.currentTarget).trigger("zen_mode:leave")}),a()(document).on("zen_mode:enter",(t=this,function(e){return t.enter(a()(e.target).closest(".md-area").find(".zen-backdrop"))})),a()(document).on("zen_mode:leave",function(e){return function(t){return e.exit()}}(this)),a()(document).on("keydown",function(e){if(27===e.keyCode)return e.preventDefault(),a()(document).trigger("zen_mode:leave")})}return u(e,[{key:"enter",value:function(e){l.a.pause(),this.active_backdrop=a()(e),this.active_backdrop.addClass("fullscreen"),this.active_textarea=this.active_backdrop.find("textarea"),this.active_textarea.removeAttr("style"),this.active_textarea.focus()}},{key:"exit",value:function(){if(this.active_textarea){l.a.unpause(),this.active_textarea.closest(".zen-backdrop").removeClass("fullscreen"),this.scrollTo(this.active_textarea),this.active_textarea=null,this.active_backdrop=null;var e=a()(".div-dropzone");e&&!e.hasClass("js-invalid-dropzone")&&s.a.forElement(".div-dropzone").enable()}}},{key:"scrollTo",value:function(e){return a.a.scrollTo(e,0,{offset:-150})}}]),e}();t.a=d},73:function(e,t,n){
/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
!function(t,i){"use strict";var a;try{a=n(!function(){var e=new Error("Cannot find module 'moment'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){}e.exports=function(e){var t="function"==typeof e,n=!!window.addEventListener,i=window.document,a=window.setTimeout,r=function(e,t,i,a){n?e.addEventListener(t,i,!!a):e.attachEvent("on"+t,i)},s=function(e,t,i,a){n?e.removeEventListener(t,i,!!a):e.detachEvent("on"+t,i)},o=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},l=function(e){return/Array/.test(Object.prototype.toString.call(e))},u=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},d=function(e){var t=e.getDay();return 0===t||6===t},c=function(e,t){return[31,function(e){return e%4==0&&e%100!=0||e%400==0}(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},h=function(e){u(e)&&e.setHours(0,0,0,0)},f=function(e,t){return e.getTime()===t.getTime()},p=function(e,t,n){var i,a;for(i in t)(a=void 0!==e[i])&&"object"==typeof t[i]&&null!==t[i]&&void 0===t[i].nodeName?u(t[i])?n&&(e[i]=new Date(t[i].getTime())):l(t[i])?n&&(e[i]=t[i].slice(0)):e[i]=p({},t[i],n):!n&&a||(e[i]=t[i]);return e},m=function(e,t,n){var a;i.createEvent?((a=i.createEvent("HTMLEvents")).initEvent(t,!0,!1),a=p(a,n),e.dispatchEvent(a)):i.createEventObject&&(a=i.createEventObject(),a=p(a,n),e.fireEvent("on"+t,a))},v=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},g={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null},b=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},w=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},y=function(e,t,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},k=function(e,t,n,i,a,r){var s,o,u,d,c,h=e._o,f=n===h.minYear,p=n===h.maxYear,m='<div id="'+r+'" class="pika-title" role="heading" aria-live="assertive">',v=!0,g=!0;for(u=[],s=0;s<12;s++)u.push('<option value="'+(n===a?s-t:12+s-t)+'"'+(s===i?' selected="selected"':"")+(f&&s<h.minMonth||p&&s>h.maxMonth?'disabled="disabled"':"")+">"+h.i18n.months[s]+"</option>");for(d='<div class="pika-label">'+h.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+u.join("")+"</select></div>",l(h.yearRange)?(s=h.yearRange[0],o=h.yearRange[1]+1):(s=n-h.yearRange,o=1+n+h.yearRange),u=[];s<o&&s<=h.maxYear;s++)s>=h.minYear&&u.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+n+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+u.join("")+"</select></div>",h.showMonthAfterYear?m+=c+d:m+=d+c,f&&(0===i||h.minMonth>=i)&&(v=!1),p&&(11===i||h.maxMonth<=i)&&(g=!1),0===t&&(m+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),m+="</div>"},C=function(s){var l=this,d=l.config(s);l._onMouseDown=function(e){if(l._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(o(t,"is-disabled")||(!o(t,"pika-button")||o(t,"is-empty")||o(t.parentNode,"is-disabled")?o(t,"pika-prev")?l.prevMonth():o(t,"pika-next")&&l.nextMonth():(l.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),d.bound&&a(function(){l.hide(),d.blurFieldOnSelect&&d.field&&d.field.blur()},100))),o(t,"pika-select"))l._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},l._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(o(t,"pika-select-month")?l.gotoMonth(t.value):o(t,"pika-select-year")&&l.gotoYear(t.value))},l._onKeyChange=function(e){if(e=e||window.event,l.isVisible())switch(e.keyCode){case 13:case 27:d.field&&d.field.blur();break;case 37:e.preventDefault(),l.adjustDate("subtract",1);break;case 38:l.adjustDate("subtract",7);break;case 39:l.adjustDate("add",1);break;case 40:l.adjustDate("add",7)}},l._onInputChange=function(n){var i;n.firedBy!==l&&(i=d.parse?d.parse(d.field.value,d.format):t?(i=e(d.field.value,d.format,d.formatStrict))&&i.isValid()?i.toDate():null:new Date(Date.parse(d.field.value)),u(i)&&l.setDate(i),l._v||l.show())},l._onInputFocus=function(){l.show()},l._onInputClick=function(){l.show()},l._onInputBlur=function(){var e=i.activeElement;do{if(o(e,"pika-single"))return}while(e=e.parentNode);l._c||(l._b=a(function(){l.hide()},50)),l._c=!1},l._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,i=t;if(t){!n&&o(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),r(t,"change",l._onChange)));do{if(o(i,"pika-single")||i===d.trigger)return}while(i=i.parentNode);l._v&&t!==d.trigger&&i!==d.trigger&&l.hide()}},l.el=i.createElement("div"),l.el.className="pika-single"+(d.isRTL?" is-rtl":"")+(d.theme?" "+d.theme:""),r(l.el,"mousedown",l._onMouseDown,!0),r(l.el,"touchend",l._onMouseDown,!0),r(l.el,"change",l._onChange),r(i,"keydown",l._onKeyChange),d.field&&(d.container?d.container.appendChild(l.el):d.bound?i.body.appendChild(l.el):d.field.parentNode.insertBefore(l.el,d.field.nextSibling),r(d.field,"change",l._onInputChange),d.defaultDate||(t&&d.field.value?d.defaultDate=e(d.field.value,d.format).toDate():d.defaultDate=new Date(Date.parse(d.field.value)),d.setDefaultDate=!0));var c=d.defaultDate;u(c)?d.setDefaultDate?l.setDate(c,!0):l.gotoDate(c):l.gotoDate(new Date),d.bound?(this.hide(),l.el.className+=" is-bound",r(d.trigger,"click",l._onInputClick),r(d.trigger,"focus",l._onInputFocus),r(d.trigger,"blur",l._onInputBlur)):this.show()};return C.prototype={config:function(e){this._o||(this._o=p({},g,!0));var t=p(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,u(t.minDate)||(t.minDate=!1),u(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),l(t.yearRange)){var i=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||i,t.yearRange[1]=parseInt(t.yearRange[1],10)||i}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||g.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,u(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,i){t&&e.isMoment(n)&&this.setDate(n.toDate(),i)},getDate:function(){return u(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",m(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),u(e)){var n=this._o.minDate,i=this._o.maxDate;u(n)&&e<n?e=n:u(i)&&e>i&&(e=i),this._d=new Date(e.getTime()),h(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),m(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(u(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),a=e.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),t=a<n.getTime()||i.getTime()<a}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,i=this.getDate()||new Date,a=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(i.valueOf()+a):"subtract"===e&&(n=new Date(i.valueOf()-a)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=v(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=v({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(h(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=g.minDate,this._o.minYear=g.minYear,this._o.minMonth=g.minMonth,this._o.startRange=g.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(h(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=g.maxDate,this._o.maxYear=g.maxYear,this._o.maxMonth=g.maxMonth,this._o.endRange=g.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,i=n.minYear,r=n.maxYear,s=n.minMonth,o=n.maxMonth,l="";this._y<=i&&(this._y=i,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+k(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,t)+this.render(this.calendars[u].year,this.calendars[u].month,t)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&a(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var e,t,n,a,r,s,o,l,u,d;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,a=this.el.offsetHeight,r=window.innerWidth||i.documentElement.clientWidth,s=window.innerHeight||i.documentElement.clientHeight,o=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,"function"==typeof e.getBoundingClientRect)l=(d=e.getBoundingClientRect()).left+window.pageXOffset,u=d.bottom+window.pageYOffset;else for(l=t.offsetLeft,u=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,u+=t.offsetTop;(this._o.reposition&&l+n>r||this._o.position.indexOf("right")>-1&&l-n+e.offsetWidth>0)&&(l=l-n+e.offsetWidth),(this._o.reposition&&u+a>s+o||this._o.position.indexOf("top")>-1&&u-a-e.offsetHeight>0)&&(u=u-a-e.offsetHeight),this.el.style.left=l+"px",this.el.style.top=u+"px"}},render:function(e,t,n){var i=this._o,a=new Date,r=c(e,t),s=new Date(e,t,1).getDay(),o=[],l=[];h(a),i.firstDay>0&&(s-=i.firstDay)<0&&(s+=7);for(var p=0===t?11:t-1,m=11===t?0:t+1,v=0===t?e-1:e,g=11===t?e+1:e,k=c(v,p),C=r+s,_=C;_>7;)_-=7;C+=7-_;for(var D,x,j,E,I=!1,S=0,O=0;S<C;S++){var T=new Date(e,t,S-s+1),M=!!u(this._d)&&f(T,this._d),F=f(T,a),L=-1!==i.events.indexOf(T.toDateString()),N=S<s||S>=r+s,A=S-s+1,B=t,P=e,$=i.startRange&&f(i.startRange,T),R=i.endRange&&f(i.endRange,T),W=i.startRange&&i.endRange&&i.startRange<T&&T<i.endRange,U=i.minDate&&T<i.minDate||i.maxDate&&T>i.maxDate||i.disableWeekends&&d(T)||i.disableDayFn&&i.disableDayFn(T);N&&(S<s?(A=k+A,B=p,P=v):(A-=r,B=m,P=g));var z={day:A,month:B,year:P,hasEvent:L,isSelected:M,isToday:F,isDisabled:U,isEmpty:N,isStartRange:$,isEndRange:R,isInRange:W,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&M&&(I=!0),l.push(w(z)),7==++O&&(i.showWeekNumber&&l.unshift((D=S-s,x=t,j=e,E=void 0,E=new Date(j,0,1),'<td class="pika-week">'+Math.ceil(((new Date(j,x,D)-E)/864e5+E.getDay()+1)/7)+"</td>")),o.push(y(l,i.isRTL,i.pickWholeWeek,I)),l=[],O=0,I=!1)}return function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+b(e,t)+'">'+b(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody>")+"</table>"}(i,o,n)},isVisible:function(){return this._v},show:function(){var e,t,n;this.isVisible()||(this._v=!0,this.draw(),e=this.el,t="is-hidden",e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,""),this._o.bound&&(r(i,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e,t,n=this._v;!1!==n&&(this._o.bound&&s(i,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",e=this.el,o(e,t="is-hidden")||(e.className=""===e.className?t:e.className+" "+t),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),s(i,"keydown",this._onKeyChange),this._o.field&&(s(this._o.field,"change",this._onInputChange),this._o.bound&&(s(this._o.trigger,"click",this._onInputClick),s(this._o.trigger,"focus",this._onInputFocus),s(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},C}(a)}()},79:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(3),s=n.n(r),o=n(5),l=n(7);t.a={init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.container,e.form),n=e.issues,i=e.prefixId;this.prefixId=i||"issue_",this.form=t||this.getElement(".bulk-update"),this.$labelDropdown=this.form.find(".js-label-select"),this.issues=n||this.getElement(".issues-list .issue"),this.willUpdateLabels=!1,this.bindEvents()},bindEvents:function(){return this.form.off("submit").on("submit",this.onFormSubmit.bind(this))},onFormSubmit:function(e){return e.preventDefault(),this.submit()},submit:function(){var e=this;o.a[this.form.attr("method")](this.form.attr("action"),this.getFormDataAsObject()).then(function(){return window.location.reload()}).catch(function(){return e.onFormSubmitFailure()})},onFormSubmitFailure:function(){return this.form.find('[type="submit"]').enable(),new l.a("Issue update failed")},getSelectedIssues:function(){return this.issues.has(".selected_issue:checked")},getLabelsFromSelection:function(){var e=[];return this.getSelectedIssues().map(function(){var t=a()(this).data("labels");if(t)return t.map(function(t){if(-1===e.indexOf(t))return e.push(t)})}),e},getUnmarkedIndeterminedLabels:function(){var e=[],t=this.$labelDropdown.data("indeterminate");return this.getLabelsFromSelection().forEach(function(n){-1===t.indexOf(n)&&e.push(n)}),e},getFormDataAsObject:function(){var e={update:{state_event:this.form.find('input[name="update[state_event]"]').val(),assignee_id:this.form.find('input[name="update[assignee_id]"]').val(),assignee_ids:[this.form.find('input[name="update[assignee_ids][]"]').val()],milestone_id:this.form.find('input[name="update[milestone_id]"]').val(),issuable_ids:this.form.find('input[name="update[issuable_ids]"]').val(),subscription_event:this.form.find('input[name="update[subscription_event]"]').val(),add_label_ids:[],remove_label_ids:[]}};return this.willUpdateLabels&&(e.update.add_label_ids=this.$labelDropdown.data("marked"),e.update.remove_label_ids=this.$labelDropdown.data("unmarked")),e},setOriginalDropdownData:function(){var e=a()(".bulk-update .js-label-select");e.data("common",this.getOriginalCommonIds()),e.data("marked",this.getOriginalMarkedIds()),e.data("indeterminate",this.getOriginalIndeterminateIds())},getOriginalCommonIds:function(){var e=this,t=[];return this.getElement(".selected_issue:checked").each(function(n,i){t.push(e.getElement("#"+e.prefixId+i.dataset.id).data("labels"))}),s.a.intersection.apply(this,t)},getOriginalMarkedIds:function(){var e=this,t=[];return this.getElement(".selected_issue:checked").each(function(n,i){t.push(e.getElement("#"+e.prefixId+i.dataset.id).data("labels"))}),s.a.intersection.apply(this,t)},getOriginalIndeterminateIds:function(){var e=this,t=[],n=[],i=[];return this.getElement(".selected_issue:checked").each(function(a,r){(i=e.getElement("#"+e.prefixId+r.dataset.id).data("labels")).forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),n.push(i)}),n.unshift(t),s.a.difference(t,s.a.intersection.apply(this,n))},getElement:function(e){return this.scopeEl=this.scopeEl||a()(".content"),this.scopeEl.find(e)}}},81:function(e,t,n){"use strict";var i=n(0),a=n.n(i),r=n(3),s=n.n(r),o=n(5),l=n(1),u=n(47),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.users=this.users.bind(this),this.user=this.user.bind(this),this.usersPath="/autocomplete/users.json",this.userPath="/autocomplete/users/:id.json",null!=e&&("object"===(void 0===e?"undefined":d(e))?this.currentUser=e:this.currentUser=JSON.parse(e));var r,c=i.handleClick;n=a()(t),t||(n=a()(".js-user-search")),n.each((r=this,function(e,t){var n,i,d,h,f,p,m,v,g,b,w,y,k,C,_,D,x,j,E,I={};d=a()(t),I.projectId=d.data("projectId"),I.groupId=d.data("groupId"),I.showCurrentUser=d.data("currentUser"),I.todoFilter=d.data("todoFilter"),I.todoStateFilter=d.data("todoStateFilter"),j=d.data("nullUser"),y=d.data("nullUserDefault"),E=d.data("showMenuAbove"),x=d.data("anyUser"),k=d.data("firstUser"),I.authorId=d.data("authorId"),w=d.data("defaultLabel"),C=d.data("issueUpdate"),f=d.closest(".selectbox"),n=f.closest(".block"),m=d.data("abilityName"),p=n.find(".value"),i=n.find(".sidebar-collapsed-user"),h=n.find(".block-loading").fadeOut(),D=y&&j?0:null,void 0===(_=d.data("selected"))&&(_=D);var S=function(){var e=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"'][value=0]");e&&e.remove();var t=document.createElement("input");t.type="hidden",t.name=d.data("fieldName");var n=d.data("currentUserInfo");n?(t.value=n.id,t.dataset.meta=s.a.escape(n.name)):r.currentUser&&(t.value=r.currentUser.id),f?d.parent().before(t):d.after(t)};n[0]&&n[0].addEventListener("assignYourself",S);var O=function(){return f.find('input[name="'+d.data("fieldName")+'"]')},T=function(){return O().map(function(e,t){return parseInt(t.value,10)}).get()},M=function(){var e=d.data("maxSelect");if(e){var t=T();if(t.length>e){var n=t[0];d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"'][value="+n+"]").remove(),emitSidebarEvent("sidebar.removeAssignee",{id:n})}}},F=function(e,t){var n=T().filter(function(e){return 0!==e}),i=O().map(function(e,t){return{name:t.dataset.meta,value:parseInt(t.value,10)}}).filter(function(e){return 0!==e.id}).get(0);if(0===n.length)return"Unassigned";if(1===n.length)return i.name;if(t){var a=n.filter(function(t){return t!==e.id});return e.name+" + "+a.length+" more"}return i.name+" + "+(n.length-1)+" more"};return a()(".assign-to-me-link").on("click",function(e){if(e.preventDefault(),a()(e.currentTarget).hide(),d.data("multiSelect")){S(),M();var t=d.data("currentUserInfo");d.find(".dropdown-toggle-text").text(F(t)).removeClass("is-default")}else{var n=a()('input[name="'+d.data("fieldName")+'"]');n.val(gon.current_user_id),_=n.val(),d.find(".dropdown-toggle-text").text(gon.current_user_fullname).removeClass("is-default")}}),n.on("click",".js-assign-yourself",function(e){return e.preventDefault(),v(r.currentUser.id)}),v=function(e){var t;return(t={})[m]={},t[m].assignee_id=null!=e?e:null,h.removeClass("hidden").fadeIn(),d.trigger("loading.gl.dropdown"),o.a.put(C,t).then(function(e){var t,n,a=e.data;return d.trigger("loaded.gl.dropdown"),h.fadeOut(),a.assignee?(t={name:a.assignee.name,username:a.assignee.username,avatar:a.assignee.avatar_url},n=s.a.escape(t.name)):(t={name:"Unassigned",username:"",avatar:""},n=Object(l.a)("Assignee")),p.html(g(t)),i.attr("title",n).tooltip("_fixTitle"),i.html(b(t))})},b=s.a.template('<% if( avatar ) { %> <a class="author-link" href="/<%- username %>"> <img width="24" class="avatar avatar-inline s24" alt="" src="<%- avatar %>"> </a> <% } else { %> <i class="fa fa-user"></i> <% } %>'),g=s.a.template('<% if (username) { %> <a class="author-link bold" href="/<%- username %>"> <% if( avatar ) { %> <img width="32" class="avatar avatar-inline s32" alt="" src="<%- avatar %>"> <% } %> <span class="author"><%- name %></span> <span class="username"> @<%- username %> </span> </a> <% } else { %> <span class="no-value assign-yourself"> No assignee - <a href="#" class="js-assign-yourself"> assign yourself </a> </span> <% } %>'),d.glDropdown({showMenuAbove:E,data:function(e,t){return r.users(e,I,function(n){(this.instance||this.options.instance).options.processData(e,n,t)}.bind(this))},processData:function(e,t,n){var i=t;if(d.hasClass("js-multiselect")&&0===e.length){var a=O(),r=s.a.uniq(a,!1,function(e){return e.value}).filter(function(e){var t=parseInt(e.value,10);return!i.find(function(e){return e.id===t})&&0!==t}).map(function(e){var t=parseInt(e.value,10),n=e.dataset,i=n.avatarUrl,a=n.avatar_url,r=n.name,s=n.username;return{avatar_url:i||a,id:t,name:r,username:s}});i=t.concat(r)}var o=void 0,l=void 0,u=void 0,c=void 0,h=void 0,f=void 0;if(0===e.length){if(f=0,k)for(l=0,u=i.length;l<u;l+=1)if((h=i[l]).username===k){i.splice(l,1),i.unshift(h);break}if(j&&(f+=1,i.unshift({beforeDivider:!0,name:"Unassigned",id:0})),x&&(f+=1,!0===(c=x)&&(c="Any User"),o={beforeDivider:!0,name:c,id:null},i.unshift(o)),f&&i.splice(f,0,"divider"),d.hasClass("js-multiselect")){var p=T().filter(function(e){return 0!==e});if(p.length>0){d.data("dropdownHeader")&&(f+=1,i.splice(f,0,{header:d.data("dropdownHeader")}));var m=i.filter(function(e){return-1!==p.indexOf(e.id)}).sort(function(e,t){return e.name>t.name});i=i.filter(function(e){return-1===p.indexOf(e.id)}),m.forEach(function(e){f+=1,i.splice(f,0,e)}),i.splice(f+1,0,"divider")}}}n(i),E&&d.data("glDropdown").positionMenuAbove()},filterable:!0,filterRemote:!0,search:{fields:["name","username"]},selectable:!0,fieldName:d.data("fieldName"),toggleLabel:function(e,t,n){var i=n.filterInput.val();if(this.multiSelect&&""===i){var r=n.filteredFullData(),s=n.parseData.bind(n);this.processData(i,r,s)}return this.multiSelect?F(e,a()(t).hasClass("is-active")):e&&"id"in e&&a()(t).hasClass("is-active")?(d.find(".dropdown-toggle-text").removeClass("is-default"),e.text?e.text:e.name):(d.find(".dropdown-toggle-text").addClass("is-default"),w)},defaultLabel:w,hidden:function(e){d.hasClass("js-multiselect")&&emitSidebarEvent("sidebar.saveAssignees"),d.data("alwaysShowSelectbox")||(f.hide(),n=f.closest(".block"),(p=n.find(".value")).css("display",""))},multiSelect:d.hasClass("js-multiselect"),inputMeta:d.data("inputMeta"),clicked:function(e){var t,n,i,r,s=e.$el,o=e.e,l=e.isMarking,h=e.selectedObj;if(d.hasClass("js-multiselect")){var f=s.hasClass("is-active"),p=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"'][value!=0]");if(M(),h.beforeDivider&&"unassigned"===h.name.toLowerCase())p.each(function(e,t){parseInt(t.value,10),t.remove()}),emitSidebarEvent("sidebar.removeAllAssignees");else if(f){emitSidebarEvent("sidebar.addAssignee",h);var m=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"'][value=0]");m&&m.remove()}else 0===p.length&&this.addInput(d.data("fieldName"),0,{}),emitSidebarEvent("sidebar.removeAssignee",h);T().find(function(e){return e===gon.current_user_id})?a()(".assign-to-me-link").hide():a()(".assign-to-me-link").show()}if(t="projects:issues:index"===(i=a()("body").attr("data-page")),n=i==i&&"projects:merge_requests:index"===i,d.hasClass("js-filter-bulk-update")||d.hasClass("js-issuable-form-dropdown")){o.preventDefault();var g=h.id!==_;(_=g?h.id:D)===gon.current_user_id?a()(".assign-to-me-link").hide():a()(".assign-to-me-link").show()}else{if(s.closest(".add-issues-modal").length)u.a.store.filter[d.data("fieldName")]=h.id;else if(c)o.preventDefault(),c(h,l);else{if(d.hasClass("js-filter-submit")&&(t||n))return Issuable.filterResults(d.closest("form"));if(d.hasClass("js-filter-submit"))return d.closest("form").submit();if(!d.hasClass("js-multiselect"))return r=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"']").val(),v(r)}d.data("maxSelect")&&T().length===d.data("maxSelect")&&d.dropdown("toggle")}},id:function(e){return e.id},opened:function(e){var t=a()(e.currentTarget),n=T();function i(e){t.find('li[data-user-id="'+e+'"] .dropdown-menu-user-link').addClass("is-active")}d.hasClass("js-issue-board-sidebar")&&0===n.length&&this.addInput(d.data("fieldName"),0,{}),t.find(".is-active").removeClass("is-active"),n.length>0?T().forEach(function(e){return i(e)}):d.hasClass("js-issue-board-sidebar")?i(0):i(_)},updateLabel:d.data("dropdownTitle"),renderRow:function(e){var t,n,i;i=e.username?"@"+e.username:"",t=e.avatar_url?e.avatar_url:gon.default_avatar_url;var a=!1;if(this.multiSelect){a=T().find(function(t){return e.id===t});var r=this.fieldName;d.closest(".selectbox").find("input[name='"+r+"'][value='"+e.id+"']").length&&(a=!0)}else a=e.id===_;return n="",null!=e.beforeDivider?s.a.escape(e.name):n="<img src='"+t+"' class='avatar avatar-inline' width='32' />","\n            <li data-user-id="+e.id+">\n              <a href='#' class='dropdown-menu-user-link "+(!0===a?"is-active":"")+"'>\n                "+n+"\n                <strong class='dropdown-menu-user-full-name'>\n                  "+s.a.escape(e.name)+"\n                </strong>\n                "+(i?"<span class='dropdown-menu-user-username'>"+i+"</span>":"")+"\n              </a>\n            </li>\n          "}})})),a()(".ajax-users-select").each(function(e){return function(t,n){var i,r,s,o,l={};return l.skipLdap=a()(n).hasClass("skip_ldap"),l.projectId=a()(n).data("projectId"),l.groupId=a()(n).data("groupId"),l.showCurrentUser=a()(n).data("currentUser"),l.authorId=a()(n).data("authorId"),l.skipUsers=a()(n).data("skipUsers"),o=a()(n).data("nullUser"),r=a()(n).data("anyUser"),s=a()(n).data("emailUser"),i=a()(n).data("firstUser"),a()(n).select2({placeholder:"Search for a user",multiple:a()(n).hasClass("multiselect"),minimumInputLength:0,query:function(t){return e.users(t.term,l,function(e){var n,a,l,u,d,c,h,f,p;if(a={results:e},0===t.term.length){if(i)for(u=0,d=(p=a.results).length;u<d;u+=1)if((f=p[u]).username===i){a.results.splice(u,1),a.results.unshift(f);break}o&&(h={name:"Unassigned",id:0},a.results.unshift(h)),r&&(!0===(c=r)&&(c="Any User"),n={name:c,id:null},a.results.unshift(n))}if(s&&0===a.results.length&&t.term.match(/^[^@]+@[^@]+$/)){var m=t.term.trim();l={name:'Invite "'+t.term+'" by email',username:m,id:m,invite:!0},a.results.unshift(l)}return t.callback(a)})},initSelection:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.initSelection.apply(e,t)},formatResult:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.formatResult.apply(e,t)},formatSelection:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.formatSelection.apply(e,t)},dropdownCssClass:"ajax-users-dropdown",escapeMarkup:function(e){return e}})}}(this))}window.emitSidebarEvent=window.emitSidebarEvent||a.a.noop,c.prototype.initSelection=function(e,t){var n;return"0"===(n=a()(e).val())?t({name:"Unassigned"}):""!==n?this.user(n,t):void 0},c.prototype.formatResult=function(e){var t;return t=e.avatar_url?e.avatar_url:gon.default_avatar_url,"<div class='user-result "+(e.username?void 0:"no-username")+"'> <div class='user-image'><img class='avatar avatar-inline s32' src='"+t+"'></div> <div class='user-name dropdown-menu-user-full-name'>"+s.a.escape(e.name)+"</div> <div class='user-username dropdown-menu-user-username'>"+(e.invite?"":"@"+s.a.escape(e.username))+"</div> </div>"},c.prototype.formatSelection=function(e){return s.a.escape(e.name)},c.prototype.user=function(e,t){return!!/^\d+$/.test(e)&&(n=(n=this.buildUrl(this.userPath)).replace(":id",e),o.a.get(n).then(function(e){var n=e.data;t(n)}));var n},c.prototype.users=function(e,t,n){var i=this.buildUrl(this.usersPath),a={search:e,active:!0,project_id:t.projectId||null,group_id:t.groupId||null,skip_ldap:t.skipLdap||null,todo_filter:t.todoFilter||null,todo_state_filter:t.todoStateFilter||null,current_user:t.showCurrentUser||null,author_id:t.authorId||null,skip_users:t.skipUsers||null};return o.a.get(i,{params:a}).then(function(e){var t=e.data;n(t)})},c.prototype.buildUrl=function(e){return null!=gon.relative_url_root&&(e=gon.relative_url_root.replace(/\/$/,"")+e),e},t.a=c},93:function(e,t,n){"use strict";function i(e,t){var n=t.x,i=t.y,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=document.createElement("button");return a.concat(["js-image-badge"]).forEach(function(e){return r.classList.add(e)}),r.setAttribute("type","button"),r.setAttribute("disabled",!0),r.dataset.noteId=e,r.style.left=n+"px",r.style.top=i+"px",r}function a(e,t){var n=t.x,i=t.y,a=document.createElement("button");a.classList.add("btn-transparent"),a.classList.add("comment-indicator"),a.setAttribute("type","button"),a.style.left=n+"px",a.style.top=i+"px",a.innerHTML=gl.utils.spriteIcon("image-comment-dark"),e.appendChild(a)}var r={x:0,y:0,width:0,height:0},s=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.noteId,i=t.discussionId;this.actual=t.actual||r,this.browser=t.browser||r,this.noteId=n,this.discussionId=i,t.imageEl&&!t.browser&&(this.browser=y.resizeCoordinatesToImageElement(t.imageEl,this.actual))},o=n(0),l=n.n(o);var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.canCreateNote=!(!n||!n.canCreateNote),this.renderCommentBadge=!(!n||!n.renderCommentBadge),this.$noteContainer=l()(".note-container",this.el),this.imageBadges=[]}return u(e,[{key:"init",value:function(){this.imageFrameEl=this.el.querySelector(".diff-file .js-image-frame"),this.imageEl=this.imageFrameEl.querySelector("img"),this.bindEvents()}},{key:"bindEvents",value:function(){var e;this.imageClickedWrapper=this.imageClicked.bind(this),this.imageBlurredWrapper=y.removeCommentIndicator.bind(null,this.imageFrameEl),this.addBadgeWrapper=this.addBadge.bind(this),this.removeBadgeWrapper=this.removeBadge.bind(this),this.renderBadgesWrapper=this.renderBadges.bind(this),(e=this.imageEl).complete&&0!==e.naturalHeight?this.renderBadges():this.imageEl.addEventListener("load",this.renderBadgesWrapper),this.$noteContainer.on("click",".js-diff-notes-toggle",y.toggleCollapsed),l()(this.el).on("click",".comment-indicator",y.commentIndicatorOnClick),this.canCreateNote&&(this.el.addEventListener("click.imageDiff",this.imageClickedWrapper),this.el.addEventListener("blur.imageDiff",this.imageBlurredWrapper),this.el.addEventListener("addBadge.imageDiff",this.addBadgeWrapper),this.el.addEventListener("removeBadge.imageDiff",this.removeBadgeWrapper))}},{key:"imageClicked",value:function(e){var t=e.detail,n=y.getTargetSelection(t),i=t.currentTarget;y.setPositionDataAttribute(i,n.actual),y.showCommentIndicator(this.imageFrameEl,n.browser)}},{key:"renderBadges",value:function(){var e=this.el.querySelectorAll(".note-container .discussion-notes .notes");[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e)).forEach(this.renderBadge.bind(this))}},{key:"renderBadge",value:function(e,t){var n=y.generateBadgeFromDiscussionDOM(this.imageFrameEl,e);this.imageBadges.push(n);var i={coordinate:n.browser,noteId:n.noteId};if(this.renderCommentBadge)y.addImageCommentBadge(this.imageFrameEl,i);else{var a=Object.assign({},i,{badgeText:t+1});y.addImageBadge(this.imageFrameEl,a)}}},{key:"addBadge",value:function(e){var t=e.detail,n=t.x,i=t.y,a=t.width,r=t.height,o=t.noteId,l=t.discussionId,u=this.imageBadges.length+1,d=new s({actual:{x:n,y:i,width:a,height:r},imageEl:this.imageFrameEl.querySelector("img"),noteId:o,discussionId:l});this.imageBadges.push(d),y.addImageBadge(this.imageFrameEl,{coordinate:d.browser,badgeText:u,noteId:o}),y.addAvatarBadge(this.el,{detail:{noteId:o,badgeNumber:u}});var c=this.el.querySelector("#discussion_"+l);y.updateDiscussionBadgeNumber(c,u)}},{key:"removeBadge",value:function(e){var t=this,n=e.detail.badgeNumber,i=n-1,a=this.imageFrameEl.querySelectorAll(".badge");this.imageBadges.length!==n&&this.imageBadges.forEach(function(e,n){if(n>i){var r=e.discussionId,s=n,o=t.el.querySelector("#discussion_"+r);a[n].innerText=s,y.updateDiscussionBadgeNumber(o,s),y.updateDiscussionAvatarBadgeNumber(o,s)}}),this.imageBadges.splice(i,1),a[i].remove()}}]),e}(),c={TWO_UP:"TWO_UP",SWIPE:"SWIPE",ONION_SKIN:"ONION_SKIN"};var h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d),h(t,[{key:"init",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.TWO_UP;this.imageFrameEls=(f(e={},c.TWO_UP,this.el.querySelector(".two-up .js-image-frame")),f(e,c.SWIPE,this.el.querySelector(".swipe .js-image-frame")),f(e,c.ONION_SKIN,this.el.querySelector(".onion-skin .js-image-frame")),e);var i=this.el.querySelector(".view-modes-menu");this.viewModesEls=(f(t={},c.TWO_UP,i.querySelector(".two-up")),f(t,c.SWIPE,i.querySelector(".swipe")),f(t,c.ONION_SKIN,i.querySelector(".onion-skin")),t),this.currentView=n,this.generateImageEls(),this.bindEvents()}},{key:"generateImageEls",value:function(){var e=this;this.imageEls={},Object.getOwnPropertyNames(c).forEach(function(t){e.imageEls[t]=e.imageFrameEls[t].querySelector("img")})}},{key:"bindEvents",value:function(){(function e(t,n,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,i)}if("value"in a)return a.value;var s=a.get;return void 0!==s?s.call(i):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bindEvents",this).call(this),this.changeToViewTwoUp=this.changeView.bind(this,c.TWO_UP),this.changeToViewSwipe=this.changeView.bind(this,c.SWIPE),this.changeToViewOnionSkin=this.changeView.bind(this,c.ONION_SKIN),this.viewModesEls[c.TWO_UP].addEventListener("click",this.changeToViewTwoUp),this.viewModesEls[c.SWIPE].addEventListener("click",this.changeToViewSwipe),this.viewModesEls[c.ONION_SKIN].addEventListener("click",this.changeToViewOnionSkin)}},{key:"changeView",value:function(e){if(t=e,Object.getOwnPropertyNames(c).find(function(e){return e===t})){var t,n=y.removeCommentIndicator(this.imageFrameEl);this.currentView=e;var i=this.imageFrameEl.querySelectorAll(".badge");[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(i)).map(function(e){return e.remove()}),this.imageBadges=[],setTimeout(this.renderNewView.bind(this,n),250)}}},{key:"renderNewView",value:function(e){if(this.renderBadges(),e.removed){var t=y.resizeCoordinatesToImageElement(this.imageEl,{x:e.x,y:e.y,width:e.image.width,height:e.image.height});y.showCommentIndicator(this.imageFrameEl,t)}}},{key:"imageEl",get:function(){return this.imageEls[this.currentView]}},{key:"imageFrameEl",get:function(){return this.imageFrameEls[this.currentView]}}]),t}(),m=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var g=900,b=["two-up","swipe"],w=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.views={"two-up":function(){return l()(".two-up.view .wrap",this.file).each((e=this,function(t,n){return l()("img",n).each(function(){if(l()(this).width()>g/2)return l()(this).width(g/2)}),e.requestImageInfo(l()("img",n),function(e,t){return l()(".image-info .meta-width",n).text(e+"px"),l()(".image-info .meta-height",n).text(t+"px"),l()(".image-info",n).removeClass("hide")})}));var e},swipe:function(){var e,t,n;return t=0,e=0,l()(".swipe.view",this.file).each((n=this,function(i,a){var r,s,o,u,d,c;c=n.prepareFrames(a),r=m(c,2),t=r[0],e=r[1],u=l()(".swipe-frame",a),s=l()(".swipe-wrap",a),o=l()(".swipe-bar",a),u.css({width:t+16,height:e+28}),s.css({width:t+1,height:e+2}),o.css({left:1}),d=parseInt(s.css("right").replace("px",""),10),n.initDraggable(o,d,function(e,n){n>0&&n<u.width()-2*d&&(s.width(t+1-n),o.css("left",n))})}))},"onion-skin":function(){var e,t,n,i;return n=0,t=0,e=l()(".drag-track",this.file).width()-l()(".dragger",this.file).width(),l()(".onion-skin.view",this.file).each((i=this,function(a,r){var s,o,u,d,c,h,f;f=i.prepareFrames(r),s=m(f,2),n=s[0],t=s[1],o=l()(".onion-skin-frame",r),c=l()(".frame.added",r),u=l()(".drag-track",r),d=l()(".dragger",u),o.css({width:n+16,height:t+28}),l()(".swipe-wrap",r).css({width:n+1,height:t+2}),d.css({left:e}),c.css("opacity",1),h=parseInt(c.css("right").replace("px",""),10),i.initDraggable(d,h,function(t,n){var i=n/e;i>=0&&i<=1&&(d.css("left",n),c.css("opacity",i))})}))}},this.file=t,this.requestImageInfo(l()(".two-up.view .frame.deleted img",this.file),(n=this,function(e,t){return n.requestImageInfo(l()(".two-up.view .frame.added img",n.file),function(e,t){n.initViewModes(),l()(".two-up.view img",n.file).waitForImages(function(){n.initView("two-up")})})}))}return v(e,[{key:"initViewModes",value:function(){var e,t=b[0];return l()(".view-modes",this.file).removeClass("hide"),l()(".view-modes-menu",this.file).on("click","li",(e=this,function(t){if(!l()(t.currentTarget).hasClass("active"))return e.activateViewMode(t.currentTarget.className)})),this.activateViewMode(t)}},{key:"activateViewMode",value:function(e){return l()(".view-modes-menu li",this.file).removeClass("active").filter("."+e).addClass("active"),l()(".view:visible:not(."+e+")",this.file).fadeOut(200,(t=this,function(){return l()(".view."+e,t.file).fadeIn(200),t.initView(e)}));var t}},{key:"initView",value:function(e){return this.views[e].call(this)}},{key:"initDraggable",value:function(e,t,n){var i=!1,a=l()("body"),r=e.parent();e.off("mousedown").on("mousedown",function(){i=!0,a.css("user-select","none")}),a.off("mouseup").off("mousemove").on("mouseup",function(){i=!1,a.css("user-select","")}).on("mousemove",function(e){var a;i&&(a=e.pageX-(r.offset().left+t),n(e,a))})}},{key:"prepareFrames",value:function(e){var t,n;return n=0,t=0,l()(".frame",e).each(function(e,i){var a,r;return r=l()(i).width(),a=l()(i).height(),n=r>n?r:n,t=a>t?a:t}).css({width:n,height:t}),[n,t]}},{key:"requestImageInfo",value:function(e,t){var n,i=e.get(0);if(i)return i.complete?t.call(this,i.naturalWidth,i.naturalHeight):e.on("load",(n=this,function(){return t.call(n,i.naturalWidth,i.naturalHeight)}))}}]),e}();var y=t.a={addCommentIndicator:a,removeCommentIndicator:function(e){var t=e.querySelector(".comment-indicator"),n=e.querySelector("img"),i=!!t,a={};return i&&(a={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),image:{width:n.width,height:n.height}},t.remove()),Object.assign({},a,{removed:i})},showCommentIndicator:function(e,t){var n=t.x,i=t.y,r=e.querySelector(".comment-indicator");r?(r.style.left=n+"px",r.style.top=i+"px"):a(e,t)},commentIndicatorOnClick:function(e){e.stopPropagation(),e.currentTarget.closest(".diff-viewer").querySelector(".note-container .note-textarea").focus()},addImageBadge:function(e,t){var n=t.coordinate,a=t.badgeText,r=i(t.noteId,n,["badge"]);r.innerText=a,e.appendChild(r)},addImageCommentBadge:function(e,t){var n=t.coordinate,a=i(t.noteId,n,["image-comment-badge"]);a.innerHTML=gl.utils.spriteIcon("image-comment-dark"),e.appendChild(a)},addAvatarBadge:function(e,t){var n=t.detail,i=n.noteId,a=n.badgeNumber,r=e.querySelector("#"+i+" .badge");r.innerText=a,r.classList.remove("hidden")},setPositionDataAttribute:function(e,t){var n=t.x,i=t.y,a=t.width,r=t.height,s=e.dataset.position,o=Object.assign({},JSON.parse(s),{x:n,y:i,width:a,height:r});e.setAttribute("data-position",JSON.stringify(o))},updateDiscussionAvatarBadgeNumber:function(e,t){e.querySelector(".image-diff-avatar-link .badge").innerText=t},updateDiscussionBadgeNumber:function(e,t){e.querySelector(".badge").innerText=t},toggleCollapsed:function(e){var t=e.currentTarget.closest(".discussion-notes"),n=t.querySelector(".discussion-form"),i=t.classList.contains("collapsed");i?t.classList.remove("collapsed"):t.classList.add("collapsed"),n&&!i?n.style.display="none":n&&i&&(n.style.display="block")},resizeCoordinatesToImageElement:function(e,t){var n=t.x,i=t.y,a=t.width,r=t.height,s=e.width,o=e.height,l=s/a,u=o/r;return{x:Math.round(n*l),y:Math.round(i*u),width:s,height:o}},generateBadgeFromDiscussionDOM:function(e,t){var n=JSON.parse(t.dataset.position),i=t.querySelector(".note");return new s({actual:n,imageEl:e.querySelector("img"),noteId:i.id,discussionId:t.dataset.discussionId})},getTargetSelection:function(e){var t=e.currentTarget.querySelector("img"),n=e.offsetX,i=e.offsetY,a=t.width,r=t.height,s=t.naturalWidth,o=t.naturalHeight,l=s/a,u=o/r,d=Math.max(0,n)&&Math.min(n,a),c=Math.max(0,i)&&Math.min(i,r);return{browser:{x:d,y:c,width:a,height:r},actual:{x:Math.round(d*l),y:Math.round(c*u),width:s,height:o}}},initImageDiff:function(e,t,n){var i={canCreateNote:t,renderCommentBadge:n},a=void 0;return new w(e),e.querySelector(".diff-file .js-single-image")?(a=new d(e,i)).init():e.querySelector(".diff-file .js-replaced-image")&&(a=new p(e,i)).init(),a}}},956:function(e,t,n){"use strict";n.r(t);var i=n(343);document.addEventListener("DOMContentLoaded",i.a)},957:function(e,t,n){n(31),n(57),e.exports=n(956)},98:function(e,t,n){"use strict";var i=n(76),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.isLocalStorageAvailable=i.a.isLocalStorageAccessSafe(),null!=n.join&&(n=n.join("/")),this.key="autosave/"+n,this.field.data("autosave",this),this.restore(),this.field.on("input",function(){return a.save()})}return a(e,[{key:"restore",value:function(){if(this.isLocalStorageAvailable&&this.field.length){var e=window.localStorage.getItem(this.key);(null!=e?e.length:void 0)>0&&this.field.val(e),this.field.trigger("input");var t=new Event("change",{bubbles:!0,cancelable:!1}),n=this.field.get(0);n&&n.dispatchEvent(t)}}},{key:"save",value:function(){if(this.field.length){var e=this.field.val();return this.isLocalStorageAvailable&&(null!=e?e.length:void 0)>0?window.localStorage.setItem(this.key,e):this.reset()}}},{key:"reset",value:function(){if(this.isLocalStorageAvailable)return window.localStorage.removeItem(this.key)}},{key:"dispose",value:function(){this.field.off("input")}}]),e}();t.a=r},99:function(e,t){Mousetrap=function(e){var t=e,n=t.stopCallback,i=!0;return t.stopCallback=function(e,t,a){return!i||n(e,t,a)},t.pause=function(){i=!1},t.unpause=function(){i=!0},t}(Mousetrap)}},[[957,0,1,2,3]]]);
//# sourceMappingURL=pages.projects.merge_requests.edit.5c339b99.chunk.js.map