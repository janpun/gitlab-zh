{"version":3,"sources":["webpack:///./create_item_dropdown.js","webpack:///./toggle_buttons.js","webpack:///./behaviors/secret_values.js","webpack:///./ci_variable_list/ci_variable_list.js","webpack:///./ref_select_dropdown.js","webpack:///./ci_variable_list/native_form_variable_list.js","webpack:///./new_branch_form.js","webpack:///./pages/projects/pipelines/new/index.js"],"names":["CreateItemDropdown","options","_classCallCheck","this","defaultToggleLabel","fieldName","onSelect","getDataOption","getData","getDataRemote","filterRemote","createNewItemFromValueOption","createNewItemFromValue","$dropdown","$dropdownContainer","parent","$dropdownFooter","find","$createButton","buildDropdown","bindEvents","toggleFooter","_this","glDropdown","data","bind","filterable","search","fields","selectable","toggleLabel","selected","underscore__WEBPACK_IMPORTED_MODULE_0___default","a","escape","title","text","item","id","onFilter","toggleCreateNewButton","clicked","e","preventDefault","html","val","on","onClickCreateWildcard","refreshData","selectRowAtIndex","remote","execute","term","callback","_this2","arguments","length","undefined","uniqueData","selectedItem","some","concat","newValue","toggleState","toggleClass","updateToggle","toggle","isOn","classList","setupToggleButtons","container","clickCallback","querySelectorAll","forEach","input","querySelector","Object","_lib_utils_common_utils__WEBPACK_IMPORTED_MODULE_3__","value","addEventListener","previousIsOn","setAttribute","Promise","resolve","then","catch","removeAttribute","jquery__WEBPACK_IMPORTED_MODULE_0___default","trigger","_flash__WEBPACK_IMPORTED_MODULE_1__","_locale__WEBPACK_IMPORTED_MODULE_2__","SecretValues","_ref","_ref$valueSelector","valueSelector","_ref$placeholderSelec","placeholderSelector","revealButton","isRevealed","_lib_utils_common_utils__WEBPACK_IMPORTED_MODULE_1__","dataset","secretRevealStatus","updateDom","onRevealButtonClicked","previousIsRevealed","values","placeholder","textContent","_locale__WEBPACK_IMPORTED_MODULE_0__","ALL_ENVIRONMENTS_STRING","createEnvironmentItem","VariableList","formField","$container","environmentDropdownMap","WeakMap","inputMap","selector","default","key","secret_value","protected","environment_scope","_destroy","secretValues","_behaviors_secret_values__WEBPACK_IMPORTED_MODULE_5__","init","each","index","rowEl","initRow","removeRow","currentTarget","closest","inputSelector","keys","map","name","join","$row","is","checkIfRowTouched","$lastRow","last","insertRow","_toggle_buttons__WEBPACK_IMPORTED_MODULE_3__","css","$environmentSelect","createItemDropdown","_create_item_dropdown__WEBPACK_IMPORTED_MODULE_4__","getEnvironmentValues","refreshDropdownData","clearDropdown","set","_this3","$rowClone","clone","removeAttr","entry","remove","after","row","attr","hide","_this4","$el","isEnabled","_this5","toArray","slice","resultant","$input","valueMap","reduce","prevValueMap","envInput","_extends","_this6","environmentDropdown","get","__webpack_exports__","RefSelectDropdown","$dropdownButton","availableRefs","availableRefsValue","JSON","parse","document","getElementById","innerHTML","filterByText","filterInput","isSelectable","branch","hasClass","$fieldInput","$","$filterInput","keyCode","which","ref","trim","removeClass","setupNativeFormVariableList","_ref$formField","variableList","_ci_variable_list__WEBPACK_IMPORTED_MODULE_1__","NewBranchForm","form","validate","branchNameError","_ref_select_dropdown__WEBPACK_IMPORTED_MODULE_1__","setupRestrictions","addBinding","endsWith","invalid","single","startsWith","pattern","prefix","conjunction","restrictions","errorMessage","errors","formatter","unique","validator","indexOf","empty","call","push","restriction","formatted","test","matched","match","append","_new_branch_form__WEBPACK_IMPORTED_MODULE_1__","_ci_variable_list_native_form_variable_list__WEBPACK_IMPORTED_MODULE_2__"],"mappings":"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","file":"pages.projects.pipelines.new.0166d2c1.chunk.js","sourcesContent":["import _ from 'underscore';\n\nexport default class CreateItemDropdown {\n  /**\n   * @param {Object} options containing\n   *                         `$dropdown` target element\n   *                          `onSelect` event callback\n   * $dropdown must be an element created using `dropdown_tag()` rails helper\n   */\n  constructor(options) {\n    this.defaultToggleLabel = options.defaultToggleLabel;\n    this.fieldName = options.fieldName;\n    this.onSelect = options.onSelect || (() => {});\n    this.getDataOption = options.getData;\n    this.getDataRemote = !!options.filterRemote;\n    this.createNewItemFromValueOption = options.createNewItemFromValue;\n    this.$dropdown = options.$dropdown;\n    this.$dropdownContainer = this.$dropdown.parent();\n    this.$dropdownFooter = this.$dropdownContainer.find('.dropdown-footer');\n    this.$createButton = this.$dropdownContainer.find('.js-dropdown-create-new-item');\n\n    this.buildDropdown();\n    this.bindEvents();\n\n    // Hide footer\n    this.toggleFooter(true);\n  }\n\n  buildDropdown() {\n    this.$dropdown.glDropdown({\n      data: this.getData.bind(this),\n      filterable: true,\n      filterRemote: this.getDataRemote,\n      search: {\n        fields: ['text'],\n      },\n      selectable: true,\n      toggleLabel(selected) {\n        return (selected && 'id' in selected) ? _.escape(selected.title) : this.defaultToggleLabel;\n      },\n      fieldName: this.fieldName,\n      text(item) {\n        return _.escape(item.text);\n      },\n      id(item) {\n        return _.escape(item.id);\n      },\n      onFilter: this.toggleCreateNewButton.bind(this),\n      clicked: (options) => {\n        options.e.preventDefault();\n        this.onSelect();\n      },\n    });\n  }\n\n  clearDropdown() {\n    this.$dropdownContainer.find('.dropdown-content').html('');\n    this.$dropdownContainer.find('.dropdown-input-field').val('');\n  }\n\n  bindEvents() {\n    this.$createButton.on('click', this.onClickCreateWildcard.bind(this));\n  }\n\n  onClickCreateWildcard(e) {\n    e.preventDefault();\n\n    this.refreshData();\n    this.$dropdown.data('glDropdown').selectRowAtIndex();\n  }\n\n  refreshData() {\n    // Refresh the dropdown's data, which ends up calling `getData`\n    this.$dropdown.data('glDropdown').remote.execute();\n  }\n\n  getData(term, callback) {\n    this.getDataOption(term, (data = []) => {\n      // Ensure the selected item isn't already in the data to avoid duplicates\n      const alreadyHasSelectedItem = this.selectedItem && data.some(item =>\n        item.id === this.selectedItem.id,\n      );\n\n      let uniqueData = data;\n      if (!alreadyHasSelectedItem) {\n        uniqueData = data.concat(this.selectedItem || []);\n      }\n\n      callback(uniqueData);\n    });\n  }\n\n  createNewItemFromValue(newValue) {\n    if (this.createNewItemFromValueOption) {\n      return this.createNewItemFromValueOption(newValue);\n    }\n\n    return {\n      title: newValue,\n      id: newValue,\n      text: newValue,\n    };\n  }\n\n  toggleCreateNewButton(newValue) {\n    if (newValue) {\n      this.selectedItem = this.createNewItemFromValue(newValue);\n\n      this.$dropdownContainer\n        .find('.js-dropdown-create-new-item code')\n        .text(newValue);\n    }\n\n    this.toggleFooter(!newValue);\n  }\n\n  toggleFooter(toggleState) {\n    this.$dropdownFooter.toggleClass('hidden', toggleState);\n  }\n}\n","import $ from 'jquery';\nimport Flash from './flash';\nimport { __ } from './locale';\nimport { convertPermissionToBoolean } from './lib/utils/common_utils';\n\n/*\n example HAML:\n ```\n  %button.js-project-feature-toggle.project-feature-toggle{ type: \"button\",\n    class: \"#{'is-checked' if enabled?}\",\n    'aria-label': _('Toggle Kubernetes Cluster') }\n    %input{ type: \"hidden\", class: 'js-project-feature-toggle-input', value: enabled? }\n  ```\n*/\n\nfunction updateToggle(toggle, isOn) {\n  toggle.classList.toggle('is-checked', isOn);\n}\n\nfunction onToggleClicked(toggle, input, clickCallback) {\n  const previousIsOn = convertPermissionToBoolean(input.value);\n\n  // Visually change the toggle and start loading\n  updateToggle(toggle, !previousIsOn);\n  toggle.setAttribute('disabled', true);\n  toggle.classList.toggle('is-loading', true);\n\n  Promise.resolve(clickCallback(!previousIsOn, toggle))\n    .then(() => {\n      // Actually change the input value\n      input.setAttribute('value', !previousIsOn);\n    })\n    .catch(() => {\n      // Revert the visuals if something goes wrong\n      updateToggle(toggle, previousIsOn);\n    })\n    .then(() => {\n      // Remove the loading indicator in any case\n      toggle.removeAttribute('disabled');\n      toggle.classList.toggle('is-loading', false);\n\n      $(input).trigger('trigger-change');\n    })\n    .catch(() => {\n      Flash(__('Something went wrong when toggling the button'));\n    });\n}\n\nexport default function setupToggleButtons(container, clickCallback = () => {}) {\n  const toggles = container.querySelectorAll('.js-project-feature-toggle');\n\n  toggles.forEach((toggle) => {\n    const input = toggle.querySelector('.js-project-feature-toggle-input');\n    const isOn = convertPermissionToBoolean(input.value);\n\n    // Get the visible toggle in sync with the hidden input\n    updateToggle(toggle, isOn);\n\n    toggle.addEventListener('click', onToggleClicked.bind(null, toggle, input, clickCallback));\n  });\n}\n","import { n__ } from '../locale';\nimport { convertPermissionToBoolean } from '../lib/utils/common_utils';\n\nexport default class SecretValues {\n  constructor({\n    container,\n    valueSelector = '.js-secret-value',\n    placeholderSelector = '.js-secret-value-placeholder',\n  }) {\n    this.container = container;\n    this.valueSelector = valueSelector;\n    this.placeholderSelector = placeholderSelector;\n  }\n\n  init() {\n    this.revealButton = this.container.querySelector('.js-secret-value-reveal-button');\n\n    if (this.revealButton) {\n      const isRevealed = convertPermissionToBoolean(this.revealButton.dataset.secretRevealStatus);\n      this.updateDom(isRevealed);\n\n      this.revealButton.addEventListener('click', this.onRevealButtonClicked.bind(this));\n    }\n  }\n\n  onRevealButtonClicked() {\n    const previousIsRevealed = convertPermissionToBoolean(\n      this.revealButton.dataset.secretRevealStatus,\n    );\n    this.updateDom(!previousIsRevealed);\n  }\n\n  updateDom(isRevealed) {\n    const values = this.container.querySelectorAll(this.valueSelector);\n    values.forEach((value) => {\n      value.classList.toggle('hide', !isRevealed);\n    });\n\n    const placeholders = this.container.querySelectorAll(this.placeholderSelector);\n    placeholders.forEach((placeholder) => {\n      placeholder.classList.toggle('hide', isRevealed);\n    });\n\n    this.revealButton.textContent = isRevealed ? n__('Hide value', 'Hide values', values.length) : n__('Reveal value', 'Reveal values', values.length);\n    this.revealButton.dataset.secretRevealStatus = isRevealed;\n  }\n}\n","import $ from 'jquery';\nimport { convertPermissionToBoolean } from '../lib/utils/common_utils';\nimport { s__ } from '../locale';\nimport setupToggleButtons from '../toggle_buttons';\nimport CreateItemDropdown from '../create_item_dropdown';\nimport SecretValues from '../behaviors/secret_values';\n\nconst ALL_ENVIRONMENTS_STRING = s__('CiVariable|All environments');\n\nfunction createEnvironmentItem(value) {\n  return {\n    title: value === '*' ? ALL_ENVIRONMENTS_STRING : value,\n    id: value,\n    text: value === '*' ? s__('CiVariable|* (All environments)') : value,\n  };\n}\n\nexport default class VariableList {\n  constructor({\n    container,\n    formField,\n  }) {\n    this.$container = $(container);\n    this.formField = formField;\n    this.environmentDropdownMap = new WeakMap();\n\n    this.inputMap = {\n      id: {\n        selector: '.js-ci-variable-input-id',\n        default: '',\n      },\n      key: {\n        selector: '.js-ci-variable-input-key',\n        default: '',\n      },\n      secret_value: {\n        selector: '.js-ci-variable-input-value',\n        default: '',\n      },\n      protected: {\n        selector: '.js-ci-variable-input-protected',\n        default: 'false',\n      },\n      environment_scope: {\n        // We can't use a `.js-` class here because\n        // gl_dropdown replaces the <input> and doesn't copy over the class\n        // See https://gitlab.com/gitlab-org/gitlab-ce/issues/42458\n        selector: `input[name=\"${this.formField}[variables_attributes][][environment_scope]\"]`,\n        default: '*',\n      },\n      _destroy: {\n        selector: '.js-ci-variable-input-destroy',\n        default: '',\n      },\n    };\n\n    this.secretValues = new SecretValues({\n      container: this.$container[0],\n      valueSelector: '.js-row:not(:last-child) .js-secret-value',\n      placeholderSelector: '.js-row:not(:last-child) .js-secret-value-placeholder',\n    });\n  }\n\n  init() {\n    this.bindEvents();\n    this.secretValues.init();\n  }\n\n  bindEvents() {\n    this.$container.find('.js-row').each((index, rowEl) => {\n      this.initRow(rowEl);\n    });\n\n    this.$container.on('click', '.js-row-remove-button', (e) => {\n      e.preventDefault();\n      this.removeRow($(e.currentTarget).closest('.js-row'));\n    });\n\n    const inputSelector = Object.keys(this.inputMap)\n      .map(name => this.inputMap[name].selector)\n      .join(',');\n\n    // Remove any empty rows except the last row\n    this.$container.on('blur', inputSelector, (e) => {\n      const $row = $(e.currentTarget).closest('.js-row');\n\n      if ($row.is(':not(:last-child)') && !this.checkIfRowTouched($row)) {\n        this.removeRow($row);\n      }\n    });\n\n    // Always make sure there is an empty last row\n    this.$container.on('input trigger-change', inputSelector, () => {\n      const $lastRow = this.$container.find('.js-row').last();\n\n      if (this.checkIfRowTouched($lastRow)) {\n        this.insertRow($lastRow);\n      }\n    });\n  }\n\n  initRow(rowEl) {\n    const $row = $(rowEl);\n\n    setupToggleButtons($row[0]);\n\n    // Reset the resizable textarea\n    $row.find(this.inputMap.secret_value.selector).css('height', '');\n\n    const $environmentSelect = $row.find('.js-variable-environment-toggle');\n    if ($environmentSelect.length) {\n      const createItemDropdown = new CreateItemDropdown({\n        $dropdown: $environmentSelect,\n        defaultToggleLabel: ALL_ENVIRONMENTS_STRING,\n        fieldName: `${this.formField}[variables_attributes][][environment_scope]`,\n        getData: (term, callback) => callback(this.getEnvironmentValues()),\n        createNewItemFromValue: createEnvironmentItem,\n        onSelect: () => {\n          // Refresh the other dropdowns in the variable list\n          // so they have the new value we just picked\n          this.refreshDropdownData();\n\n          $row.find(this.inputMap.environment_scope.selector).trigger('trigger-change');\n        },\n      });\n\n      // Clear out any data that might have been left-over from the row clone\n      createItemDropdown.clearDropdown();\n\n      this.environmentDropdownMap.set($row[0], createItemDropdown);\n    }\n  }\n\n  insertRow($row) {\n    const $rowClone = $row.clone();\n    $rowClone.removeAttr('data-is-persisted');\n\n    // Reset the inputs to their defaults\n    Object.keys(this.inputMap).forEach((name) => {\n      const entry = this.inputMap[name];\n      $rowClone.find(entry.selector).val(entry.default);\n    });\n\n    // Close any dropdowns\n    $rowClone.find('.dropdown-menu.show').each((index, $dropdown) => {\n      $dropdown.classList.remove('show');\n    });\n\n    this.initRow($rowClone);\n\n    $row.after($rowClone);\n  }\n\n  removeRow(row) {\n    const $row = $(row);\n    const isPersisted = convertPermissionToBoolean($row.attr('data-is-persisted'));\n\n    if (isPersisted) {\n      $row.hide();\n      $row\n        // eslint-disable-next-line no-underscore-dangle\n        .find(this.inputMap._destroy.selector)\n        .val(true);\n    } else {\n      $row.remove();\n    }\n\n    // Refresh the other dropdowns in the variable list\n    // so any value with the variable deleted is gone\n    this.refreshDropdownData();\n  }\n\n  checkIfRowTouched($row) {\n    return Object.keys(this.inputMap).some((name) => {\n      const entry = this.inputMap[name];\n      const $el = $row.find(entry.selector);\n      return $el.length && $el.val() !== entry.default;\n    });\n  }\n\n  toggleEnableRow(isEnabled = true) {\n    this.$container.find(this.inputMap.key.selector).attr('disabled', !isEnabled);\n    this.$container.find('.js-row-remove-button').attr('disabled', !isEnabled);\n  }\n\n  hideValues() {\n    this.secretValues.updateDom(false);\n  }\n\n  getAllData() {\n    // Ignore the last empty row because we don't want to try persist\n    // a blank variable and run into validation problems.\n    const validRows = this.$container.find('.js-row').toArray().slice(0, -1);\n\n    return validRows.map((rowEl) => {\n      const resultant = {};\n      Object.keys(this.inputMap).forEach((name) => {\n        const entry = this.inputMap[name];\n        const $input = $(rowEl).find(entry.selector);\n        if ($input.length) {\n          resultant[name] = $input.val();\n        }\n      });\n\n      return resultant;\n    });\n  }\n\n  getEnvironmentValues() {\n    const valueMap = this.$container.find(this.inputMap.environment_scope.selector).toArray()\n      .reduce((prevValueMap, envInput) => ({\n        ...prevValueMap,\n        [envInput.value]: envInput.value,\n      }), {});\n\n    return Object.keys(valueMap).map(createEnvironmentItem);\n  }\n\n  refreshDropdownData() {\n    this.$container.find('.js-row').each((index, rowEl) => {\n      const environmentDropdown = this.environmentDropdownMap.get(rowEl);\n      if (environmentDropdown) {\n        environmentDropdown.refreshData();\n      }\n    });\n  }\n}\n","import $ from 'jquery';\n\nclass RefSelectDropdown {\n  constructor($dropdownButton, availableRefs) {\n    const availableRefsValue = availableRefs || JSON.parse(document.getElementById('availableRefs').innerHTML);\n    $dropdownButton.glDropdown({\n      data: availableRefsValue,\n      filterable: true,\n      filterByText: true,\n      remote: false,\n      fieldName: $dropdownButton.data('fieldName'),\n      filterInput: 'input[type=\"search\"]',\n      selectable: true,\n      isSelectable(branch, $el) {\n        return !$el.hasClass('is-active');\n      },\n      text(branch) {\n        return branch;\n      },\n      id(branch) {\n        return branch;\n      },\n      toggleLabel(branch) {\n        return branch;\n      },\n    });\n\n    const $dropdownContainer = $dropdownButton.closest('.dropdown');\n    const $fieldInput = $(`input[name=\"${$dropdownButton.data('fieldName')}\"]`, $dropdownContainer);\n    const $filterInput = $('input[type=\"search\"]', $dropdownContainer);\n\n    $filterInput.on('keyup', (e) => {\n      const keyCode = e.keyCode || e.which;\n      if (keyCode !== 13) return;\n\n      const ref = $filterInput.val().trim();\n      if (ref === '') {\n        return;\n      }\n\n      $fieldInput.val(ref);\n      $('.dropdown-toggle-text', $dropdownButton).text(ref);\n\n      $dropdownContainer.removeClass('open');\n    });\n  }\n}\n\nexport default RefSelectDropdown;\n","import $ from 'jquery';\nimport VariableList from './ci_variable_list';\n\n// Used for the variable list on scheduled pipeline edit page\nexport default function setupNativeFormVariableList({\n  container,\n  formField = 'variables',\n}) {\n  const $container = $(container);\n\n  const variableList = new VariableList({\n    container: $container,\n    formField,\n  });\n  variableList.init();\n\n  // Clear out the names in the empty last row so it\n  // doesn't get submitted and throw validation errors\n  $container.closest('form').on('submit trigger-submit', () => {\n    const $lastRow = $container.find('.js-row').last();\n\n    const isTouched = variableList.checkIfRowTouched($lastRow);\n    if (!isTouched) {\n      $lastRow.find('input, textarea').attr('name', '');\n    }\n  });\n}\n","/* eslint-disable func-names, no-var, one-var, max-len, wrap-iife, consistent-return, comma-dangle, one-var-declaration-per-line, quotes, no-return-assign, prefer-arrow-callback, prefer-template, no-shadow, no-else-return, max-len */\n\nimport $ from 'jquery';\nimport RefSelectDropdown from './ref_select_dropdown';\n\nexport default class NewBranchForm {\n  constructor(form, availableRefs) {\n    this.validate = this.validate.bind(this);\n    this.branchNameError = form.find('.js-branch-name-error');\n    this.name = form.find('.js-branch-name');\n    this.ref = form.find('#ref');\n    new RefSelectDropdown($('.js-branch-select'), availableRefs); // eslint-disable-line no-new\n    this.setupRestrictions();\n    this.addBinding();\n    this.init();\n  }\n\n  addBinding() {\n    return this.name.on('blur', this.validate);\n  }\n\n  init() {\n    if (this.name.length && this.name.val().length > 0) {\n      return this.name.trigger('blur');\n    }\n  }\n\n  setupRestrictions() {\n    var endsWith, invalid, single, startsWith;\n    startsWith = {\n      pattern: /^(\\/|\\.)/g,\n      prefix: \"can't start with\",\n      conjunction: \"or\"\n    };\n    endsWith = {\n      pattern: /(\\/|\\.|\\.lock)$/g,\n      prefix: \"can't end in\",\n      conjunction: \"or\"\n    };\n    invalid = {\n      pattern: /(\\s|~|\\^|:|\\?|\\*|\\[|\\\\|\\.\\.|@\\{|\\/{2,}){1}/g,\n      prefix: \"can't contain\",\n      conjunction: \", \"\n    };\n    single = {\n      pattern: /^@+$/g,\n      prefix: \"can't be\",\n      conjunction: \"or\"\n    };\n    return this.restrictions = [startsWith, invalid, endsWith, single];\n  }\n\n  validate() {\n    var errorMessage, errors, formatter, unique, validator;\n    const { indexOf } = [];\n\n    this.branchNameError.empty();\n    unique = function(values, value) {\n      if (indexOf.call(values, value) === -1) {\n        values.push(value);\n      }\n      return values;\n    };\n    formatter = function(values, restriction) {\n      var formatted;\n      formatted = values.map(function(value) {\n        switch (false) {\n          case !/\\s/.test(value):\n            return 'spaces';\n          case !/\\/{2,}/g.test(value):\n            return 'consecutive slashes';\n          default:\n            return \"'\" + value + \"'\";\n        }\n      });\n      return restriction.prefix + \" \" + (formatted.join(restriction.conjunction));\n    };\n    validator = (function(_this) {\n      return function(errors, restriction) {\n        var matched;\n        matched = _this.name.val().match(restriction.pattern);\n        if (matched) {\n          return errors.concat(formatter(matched.reduce(unique, []), restriction));\n        } else {\n          return errors;\n        }\n      };\n    })(this);\n    errors = this.restrictions.reduce(validator, []);\n    if (errors.length > 0) {\n      errorMessage = $(\"<span/>\").text(errors.join(', '));\n      return this.branchNameError.append(errorMessage);\n    }\n  }\n}\n","import $ from 'jquery';\nimport NewBranchForm from '~/new_branch_form';\nimport setupNativeFormVariableList from '~/ci_variable_list/native_form_variable_list';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  new NewBranchForm($('.js-new-pipeline-form')); // eslint-disable-line no-new\n\n  setupNativeFormVariableList({\n    container: $('.js-ci-variable-list-section'),\n    formField: 'variables_attributes',\n  });\n});\n"],"sourceRoot":""}