(this.webpackJsonp=this.webpackJsonp||[]).push([[89],{118:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=(n(243),n(5)),a=n(7),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector,this.dataType=t.dataType,this.fieldName=t.fieldName,this.onSuccess=t.onSuccess||function(){},this.onError=function(e){var t="";return e.response.data&&"object"===r(e.response.data)&&(t=e.response.data.errors.join(" ")),new a.a(t||"Update failed","alert")},this.init()}return l(e,[{key:"init",value:function(){this.disable(),s()(this.selector+" .js-task-list-container").taskList("enable"),s()(document).on("tasklist:changed",this.selector+" .js-task-list-container",this.update.bind(this))}},{key:"disable",value:function(){s()(this.selector+" .js-task-list-container").taskList("disable"),s()(document).off("tasklist:changed",this.selector+" .js-task-list-container")}},{key:"update",value:function(e){var t,n,i,a=this,r=s()(e.target),l={};return l[this.dataType]=(t={},n=this.fieldName,i=r.val(),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t),o.a.patch(r.data("updateUrl")||s()("form.js-issuable-update").attr("action"),l).then(function(e){var t=e.data;return a.onSuccess(t)}).catch(function(e){return a.onError(e)})}}]),e}();t.a=c},119:function(e,t,n){"use strict";var i={props:{small:{type:Boolean,required:!1,default:!1},lines:{type:Number,required:!1,default:3}},computed:{lineClasses:function(){return new Array(this.lines).fill().map(function(e,t){return"skeleton-line-"+(t+1)})}}},s=n(2),o=Object(s.a)(i,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"animation-container",class:{"animation-container-small":this.small}},this._l(this.lineClasses,function(e,n){return t("div",{key:n,class:e})}))},[],!1,null,null,null);t.a=o.exports},143:function(e,t,n){"use strict";var i={init:function(e){this.hook=e,this.destroyed=!1,this.config=e.config.InputSetter||(this.hook.config.InputSetter={}),this.eventWrapper={},this.addEvents()},addEvents:function(){this.eventWrapper.setInputs=this.setInputs.bind(this),this.hook.list.list.addEventListener("click.dl",this.eventWrapper.setInputs)},removeEvents:function(){this.hook.list.list.removeEventListener("click.dl",this.eventWrapper.setInputs)},setInputs:function(e){var t=this;if(!this.destroyed){var n=e.detail.selected;Array.isArray(this.config)||(this.config=[this.config]),this.config.forEach(function(e){return t.setInput(e,n)})}},setInput:function(e,t){var n=e.input||this.hook.trigger,i=t.getAttribute(e.valueAttribute),s=e.inputAttribute;return n.hasAttribute(s)?n.setAttribute(s,i):"INPUT"===n.tagName?n.value=i:n.textContent=i},destroy:function(){this.destroyed=!0,this.removeEvents()}};t.a=i},198:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(7),a=n(11),r=n(5),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.initAuxiliaryViewer(),e.initRichViewer(),this.initMainViewers()}return l(e,[{key:"initMainViewers",value:function(){this.$fileHolder=s()(".file-holder"),this.$fileHolder.length&&(this.switcher=document.querySelector(".js-blob-viewer-switcher"),this.switcherBtns=document.querySelectorAll(".js-blob-viewer-switch-btn"),this.copySourceBtn=document.querySelector(".js-copy-blob-source-btn"),this.simpleViewer=this.$fileHolder[0].querySelector('.blob-viewer[data-type="simple"]'),this.richViewer=this.$fileHolder[0].querySelector('.blob-viewer[data-type="rich"]'),this.initBindings(),this.switchToInitialViewer())}},{key:"switchToInitialViewer",value:function(){var e=this.$fileHolder[0].querySelector(".blob-viewer:not(.hidden)").getAttribute("data-type");this.switcher&&0===window.location.hash.indexOf("#L")&&(e="simple"),this.switchToViewer(e)}},{key:"initBindings",value:function(){var e=this;this.switcherBtns.length&&Array.from(this.switcherBtns).forEach(function(t){t.addEventListener("click",e.switchViewHandler.bind(e))}),this.copySourceBtn&&this.copySourceBtn.addEventListener("click",function(){return e.copySourceBtn.classList.contains("disabled")?e.copySourceBtn.blur():e.switchToViewer("simple")})}},{key:"switchViewHandler",value:function(e){var t=e.currentTarget;e.preventDefault(),this.switchToViewer(t.getAttribute("data-viewer"))}},{key:"toggleCopyButtonState",value:function(){this.copySourceBtn&&(this.simpleViewer.getAttribute("data-loaded")?(this.copySourceBtn.setAttribute("title","Copy source to clipboard"),this.copySourceBtn.classList.remove("disabled")):this.activeViewer===this.simpleViewer?(this.copySourceBtn.setAttribute("title","Wait for the source to load to copy it to the clipboard"),this.copySourceBtn.classList.add("disabled")):(this.copySourceBtn.setAttribute("title","Switch to the source to copy it to the clipboard"),this.copySourceBtn.classList.add("disabled")),s()(this.copySourceBtn).tooltip("_fixTitle"))}},{key:"switchToViewer",value:function(t){var n=this,i=this.$fileHolder[0].querySelector(".blob-viewer[data-type='"+t+"']");if(this.activeViewer!==i){var r=document.querySelector(".js-blob-viewer-switch-btn.active"),l=document.querySelector(".js-blob-viewer-switch-btn[data-viewer='"+t+"']"),c=this.$fileHolder[0].querySelector(".blob-viewer:not([data-type='"+t+"'])");r&&r.classList.remove("active"),l&&(l.classList.add("active"),l.blur()),c&&c.classList.add("hidden"),i.classList.remove("hidden"),this.activeViewer=i,this.toggleCopyButtonState(),e.loadViewer(i).then(function(e){s()(e).renderGFM(),n.$fileHolder.trigger("highlight:line"),Object(a.n)(),n.toggleCopyButtonState()}).catch(function(){return new o.a("Error loading viewer")})}}}],[{key:"initAuxiliaryViewer",value:function(){var t=document.querySelector('.blob-viewer[data-type="auxiliary"]');t&&e.loadViewer(t)}},{key:"initRichViewer",value:function(){var e=document.querySelector('.blob-viewer[data-type="rich"]');if(e&&e.dataset.richType){var t=function(t){return t.then(function(t){return t.default(e)}).catch(function(e){throw Object(o.a)("Error loading file viewer."),e})};switch(e.dataset.richType){case"balsamiq":t(Promise.all([n.e(14),n.e(36),n.e(43)]).then(n.bind(null,418)));break;case"notebook":t(Promise.all([n.e(14),n.e(35),n.e(42)]).then(n.bind(null,422)));break;case"pdf":t(Promise.all([n.e(32),n.e(41)]).then(n.bind(null,421)));break;case"sketch":t(Promise.all([n.e(14),n.e(34),n.e(40)]).then(n.bind(null,419)));break;case"stl":t(Promise.all([n.e(29),n.e(39)]).then(n.bind(null,420)))}}}},{key:"loadViewer",value:function(e){var t=e,n=t.getAttribute("data-url");return!n||t.getAttribute("data-loaded")||t.getAttribute("data-loading")?Promise.resolve(t):(t.setAttribute("data-loading","true"),r.a.get(n).then(function(e){var n=e.data;return t.innerHTML=n.html,t.setAttribute("data-loaded","true"),t}))}}]),e}();t.a=c},205:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(3),a=n.n(o),r=n(39),l=n.n(r),c=n(50),d=n.n(c),u=(n(391),n(390),n(149)),h=n(8),f=n(129),p=n(119),v=n(5),m=n(21),g=n(7),y=n(53),b=n(159),w=n(143),k=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var j=Object.assign({},w.a),C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dropdownTrigger=t.dropdownTrigger,this.dropdownList=t.dropdownList,this.noteTypeInput=t.noteTypeInput,this.submitButton=t.submitButton,this.closeButton=t.closeButton,this.reopenButton=t.reopenButton}return k(e,[{key:"initDroplab",value:function(){this.droplab=new b.a;var e=this.setConfig();this.droplab.init(this.dropdownTrigger,this.dropdownList,[j],e)}},{key:"setConfig",value:function(){var e={InputSetter:[{input:this.noteTypeInput,valueAttribute:"data-value"},{input:this.submitButton,valueAttribute:"data-submit-text"}]};return this.closeButton&&e.InputSetter.push({input:this.closeButton,valueAttribute:"data-close-text"},{input:this.closeButton,valueAttribute:"data-close-text",inputAttribute:"data-alternative-text"}),this.reopenButton&&e.InputSetter.push({input:this.reopenButton,valueAttribute:"data-reopen-text"},{input:this.reopenButton,valueAttribute:"data-reopen-text",inputAttribute:"data-alternative-text"}),e}}]),e}(),_=n(65),E=n(190),x=n(98),N=n(118),T=n(11),S=(n(93),n(38)),A=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function D(e){return e.replace(/\r\n/g,"\n")}window.autosize=d.a;var F=/^\/\w+.*$/gm,L=function(){function e(t,n,i,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y.b;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.updateTargetButtons=this.updateTargetButtons.bind(this),this.updateComment=this.updateComment.bind(this),this.visibilityChange=this.visibilityChange.bind(this),this.cancelDiscussionForm=this.cancelDiscussionForm.bind(this),this.onAddDiffNote=this.onAddDiffNote.bind(this),this.onAddImageDiffNote=this.onAddImageDiffNote.bind(this),this.setupDiscussionNoteForm=this.setupDiscussionNoteForm.bind(this),this.onReplyToDiscussionNote=this.onReplyToDiscussionNote.bind(this),this.removeNote=this.removeNote.bind(this),this.cancelEdit=this.cancelEdit.bind(this),this.updateNote=this.updateNote.bind(this),this.addDiscussionNote=this.addDiscussionNote.bind(this),this.addNoteError=this.addNoteError.bind(this),this.addNote=this.addNote.bind(this),this.resetMainTargetForm=this.resetMainTargetForm.bind(this),this.refresh=this.refresh.bind(this),this.keydownNoteText=this.keydownNoteText.bind(this),this.toggleCommitList=this.toggleCommitList.bind(this),this.postComment=this.postComment.bind(this),this.clearFlashWrapper=this.clearFlash.bind(this),this.onHashChange=this.onHashChange.bind(this),this.notes_url=t,this.note_ids=n,this.enableGFM=a,this.updatedNotesTrackingMap={},this.last_fetched_at=i,this.noteable_url=document.URL,this.notesCountBadge||(this.notesCountBadge=s()(".issuable-details").find(".notes-tab .badge")),this.basePollingInterval=15e3,this.maxPollingSteps=4,this.$wrapperEl=Object(T.t)()?s()(document).find(".diffs"):s()(document),this.cleanBinding(),this.addBinding(),this.setPollingInterval(),this.setupMainTargetNoteForm(a),this.taskList=new N.a({dataType:"note",fieldName:"note",selector:".notes"}),this.collapseLongCommitList(),this.setViewType(o),"merge_requests"===Object(T.i)(1)&&s()(".note-edit-form").clone().addClass("mr-note-edit-form").insertAfter(".note-edit-form");var r=Object(m.a)(),l=r&&document.getElementById(r);l&&this.loadLazyDiff({currentTarget:l})}return A(e,null,[{key:"initialize",value:function(t,n,i,s,o){this.instance||(this.instance=new e(t,n,i,s,o))}},{key:"getInstance",value:function(){return this.instance}}]),A(e,[{key:"setViewType",value:function(e){this.view=l.a.get("diff_view")||e}},{key:"addBinding",value:function(){this.$wrapperEl.on("click",".js-note-edit",this.showEditForm.bind(this)),this.$wrapperEl.on("click",".note-edit-cancel",this.cancelEdit),this.$wrapperEl.on("click",".js-comment-submit-button",this.postComment),this.$wrapperEl.on("click",".js-comment-save-button",this.updateComment),this.$wrapperEl.on("keyup input",".js-note-text",this.updateTargetButtons),this.$wrapperEl.on("click",".js-comment-resolve-button",this.postComment),this.$wrapperEl.on("click",".js-note-delete",this.removeNote),this.$wrapperEl.on("click",".js-note-attachment-delete",this.removeAttachment),this.$wrapperEl.on("click",".js-note-discard",this.resetMainTargetForm),this.$wrapperEl.on("change",".js-note-attachment-input",this.updateFormAttachment),this.$wrapperEl.on("click",".js-discussion-reply-button",this.onReplyToDiscussionNote),this.$wrapperEl.on("click",".js-add-diff-note-button",this.onAddDiffNote),this.$wrapperEl.on("click",".js-add-image-diff-note-button",this.onAddImageDiffNote),this.$wrapperEl.on("click",".js-close-discussion-note-form",this.cancelDiscussionForm),this.$wrapperEl.on("click",".system-note-commit-list-toggler",this.toggleCommitList),this.$wrapperEl.on("click",".js-toggle-lazy-diff",this.loadLazyDiff),this.$wrapperEl.on("click",".js-toggle-lazy-diff-retry-button",this.onClickRetryLazyLoad.bind(this)),this.$wrapperEl.on("visibilitychange",this.visibilityChange),this.$wrapperEl.on("issuable:change",this.refresh),this.$wrapperEl.on("ajax:success",".js-main-target-form",this.addNote),this.$wrapperEl.on("ajax:success",".js-discussion-note-form",this.addDiscussionNote),this.$wrapperEl.on("ajax:success",".js-main-target-form",this.resetMainTargetForm),this.$wrapperEl.on("ajax:complete",".js-main-target-form",this.reenableTargetFormSubmitButton),this.$wrapperEl.on("keydown",".js-note-text",this.keydownNoteText),s()(window).on("hashchange",this.onHashChange)}},{key:"cleanBinding",value:function(){this.$wrapperEl.off("click",".js-note-edit"),this.$wrapperEl.off("click",".note-edit-cancel"),this.$wrapperEl.off("click",".js-note-delete"),this.$wrapperEl.off("click",".js-note-attachment-delete"),this.$wrapperEl.off("click",".js-discussion-reply-button"),this.$wrapperEl.off("click",".js-add-diff-note-button"),this.$wrapperEl.off("click",".js-add-image-diff-note-button"),this.$wrapperEl.off("visibilitychange"),this.$wrapperEl.off("keyup input",".js-note-text"),this.$wrapperEl.off("click",".js-note-target-reopen"),this.$wrapperEl.off("click",".js-note-target-close"),this.$wrapperEl.off("click",".js-note-discard"),this.$wrapperEl.off("keydown",".js-note-text"),this.$wrapperEl.off("click",".js-comment-resolve-button"),this.$wrapperEl.off("click",".system-note-commit-list-toggler"),this.$wrapperEl.off("click",".js-toggle-lazy-diff"),this.$wrapperEl.off("click",".js-toggle-lazy-diff-retry-button"),this.$wrapperEl.off("ajax:success",".js-main-target-form"),this.$wrapperEl.off("ajax:success",".js-discussion-note-form"),this.$wrapperEl.off("ajax:complete",".js-main-target-form"),s()(window).off("hashchange",this.onHashChange)}},{key:"keydownNoteText",value:function(e){var t,n,i,o;if(!Object(T.x)(e))switch(t=s()(e.target),e.which){case 38:if(""!==t.val())return;if((o=s()("li.note[data-author-id='"+gon.current_user_id+"'][data-editable]:last",t.closest(".note, .notes_holder, #notes"))).length)return o.find(".js-note-edit").trigger("click",[!0,o]);break;case 27:if((n=t.closest(".js-discussion-note-form")).length){if(""!==t.val()&&!window.confirm("Are you sure you want to cancel creating this comment?"))return;return void this.removeDiscussionNoteForm(n)}if((i=t.closest(".note")).length){if(t.closest("form").data("originalNote")!==t.val()&&!window.confirm("Are you sure you want to cancel editing this comment?"))return;return this.removeNoteEditForm(i)}}}},{key:"initRefresh",value:function(){return e.interval&&clearInterval(e.interval),e.interval=setInterval((t=this,function(){return t.refresh()}),this.pollingInterval);var t}},{key:"refresh",value:function(){if(!document.hidden)return this.getContent()}},{key:"getContent",value:function(){var e=this;this.refreshing||(this.refreshing=!0,v.a.get(this.notes_url+"?html=true",{headers:{"X-Last-Fetched-At":this.last_fetched_at}}).then(function(t){var n=t.data,i=n.notes;e.last_fetched_at=n.last_fetched_at,e.setPollingInterval(n.notes.length),s.a.each(i,function(t,n){return e.renderNote(n)}),e.refreshing=!1}).catch(function(){e.refreshing=!1}))}},{key:"setPollingInterval",value:function(e){var t;return null==e&&(e=!0),t=this.basePollingInterval*Math.pow(2,this.maxPollingSteps-1),e?this.pollingInterval=this.basePollingInterval:this.pollingInterval<t&&(this.pollingInterval*=2),this.initRefresh()}},{key:"handleQuickActions",value:function(t){var n;t.commands_changes&&("merge"in t.commands_changes&&e.checkMergeRequestStatus(),"emoji_award"in t.commands_changes&&(n=s()(".js-awards-block").eq(0),Object(E.b)().then(function(e){e.addAwardToEmojiBar(n,t.commands_changes.emoji_award),e.scrollToAwards()}).catch(function(){})))}},{key:"setupNewNote",value:function(t){Object(S.e)(t.find(".js-timeago"),!1),this.collapseLongCommitList(),this.taskList.init(),e.updateNoteTargetSelector(t),this.$noteToCleanHighlight=t}},{key:"onHashChange",value:function(){this.$noteToCleanHighlight&&e.updateNoteTargetSelector(this.$noteToCleanHighlight),this.$noteToCleanHighlight=null}},{key:"renderNote",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s()(".main-notes-list");if(t.discussion_html)return this.renderDiscussionNote(t,n);if(t.valid){var o=i.find("#note_"+t.id);if(e.isNewNote(t,this.note_ids)){if(Object(T.t)())return;this.note_ids.push(t.id),i.length&&i.find(".system-note.being-posted").remove();var a=e.animateAppendNote(t.html,i);return this.setupNewNote(a),this.refresh(),this.updateNotesCount(1)}if(e.isUpdatedNote(t,o)){var r=o.hasClass("is-editing"),l=D(o.find(".original-note-content").text().trim()),c=o.find(".js-note-text"),d=c.val(),u=D(t.note),h=d===l||d===u;if(r&&h)c.val(t.note),this.updatedNotesTrackingMap[t.id]=t;else if(r&&!h)this.putConflictEditWarningInPlace(t,o),this.updatedNotesTrackingMap[t.id]=t;else{var f=e.animateUpdateNote(t.html,o);this.setupNewNote(f)}}}else t.errors&&t.errors.commands_only&&(t.commands_changes&&Object.keys(t.commands_changes).length>0&&i.find(".system-note.being-posted").remove(),this.addFlash(t.errors.commands_only,"notice",this.parentTimeline.get(0)),this.refresh())}},{key:"isParallelView",value:function(){return"parallel"===l.a.get("diff_view")}},{key:"renderDiscussionNote",value:function(t,n){var i,o,a,r,l;if(e.isNewNote(t,this.note_ids)){if(this.note_ids.push(t.id),a=(o=n||s()('.js-discussion-note-form[data-discussion-id="'+t.discussion_id+'"]')).length||!t.discussion_line_code?o.closest("tr"):s()("#"+t.discussion_line_code),t.on_image&&(a=o),r=this.isParallelView()?o.find("#line_type").val():"old",l=a.prevAll(".line_holder").first().find(".js-avatar-container."+r+"_line"),(i=s()('.notes[data-discussion-id="'+t.discussion_id+'"]')).length||(i=o.closest(".discussion").find(".notes")),0===i.length)if(t.diff_discussion_html){var c=s()(t.diff_discussion_html).renderGFM();if(!this.isParallelView()||a.hasClass("js-temp-notes-holder")||t.on_image)a.after(c);else{var d=c.find('.notes[data-discussion-id="'+t.discussion_id+'"]'),u="."+d.closest(".notes_content").attr("class").split(" ").join(".");a.find(u+" .content").append(d.closest(".content").children())}}else e.animateAppendNote(t.discussion_html,s()(".main-notes-list"));else e.animateAppendNote(t.html,i);return void 0!==gl.diffNotesCompileComponents&&t.discussion_resolvable&&(gl.diffNotesCompileComponents(),this.renderDiscussionAvatar(l,t)),Object(S.e)(s()(".js-timeago"),!1),e.checkMergeRequestStatus(),this.updateNotesCount(1)}}},{key:"getLineHolder",value:function(e){return s()(e).closest(".notes_holder").prevAll(".line_holder").first().get(0)}},{key:"renderDiscussionAvatar",value:function(e,t){var n=e.find(".diff-comment-avatar-holders");n.length||((n=document.createElement("diff-note-avatars")).setAttribute("discussion-id",t.discussion_id),e.append(n),gl.diffNotesCompileComponents())}},{key:"resetMainTargetForm",value:function(e){var t;(t=s()(".js-main-target-form")).find(".js-errors").remove(),t.find(".js-md-write-button").click(),t.find(".js-note-text").val("").trigger("input"),t.find(".js-note-text").data("autosave").reset();var n=document.createEvent("Event");n.initEvent("autosize:update",!0,!1),t.find(".js-autosize")[0].dispatchEvent(n),this.updateTargetButtons(e)}},{key:"reenableTargetFormSubmitButton",value:function(){return s()(".js-main-target-form").find(".js-note-text").trigger("input")}},{key:"setupMainTargetNoteForm",value:function(t){var n;n=s()(".js-new-note-form"),this.formClone=n.clone(),this.setupNoteForm(n,t),n.removeClass("js-new-note-form"),n.addClass("js-main-target-form"),n.find("#note_line_code").remove(),n.find("#note_position").remove(),n.find("#note_type").val(""),n.find("#note_project_id").remove(),n.find("#in_reply_to_discussion_id").remove(),n.find(".js-comment-resolve-button").closest("comment-and-resolve-btn").remove(),this.parentTimeline=n.parents(".timeline"),n.length&&e.initCommentTypeToggle(n.get(0))}},{key:"setupNoteForm",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.b;return this.glForm=new _.a(e,i),t=e.find(".js-note-text"),n=["Note",e.find("#note_noteable_type").val(),e.find("#note_noteable_id").val(),e.find("#note_commit_id").val(),e.find("#note_type").val(),e.find("#note_project_id").val(),e.find("#in_reply_to_discussion_id").val(),e.find("#note_line_code").val(),e.find("#note_position").val()],new x.a(t,n)}},{key:"addNote",value:function(e,t){return this.renderNote(t)}},{key:"addNoteError",value:function(e){var t=void 0;return e.hasClass("js-main-target-form")?t=e.parents(".timeline"):e.hasClass("js-discussion-note-form")&&(t=e.closest(".discussion-notes").find(".notes")),this.addFlash("Your comment could not be submitted! Please check your network connection and try again.","alert",t.get(0))}},{key:"updateNoteError",value:function(e){new g.a("Your comment could not be updated! Please check your network connection and try again.")}},{key:"addDiscussionNote",value:function(e,t,n){if(null!=e.attr("data-resolve-all")){e.data("projectPath");var i=e.data("discussionId"),s=e.data("noteableIid");null!=ResolveService&&ResolveService.toggleResolveForDiscussion(s,i)}this.renderNote(t,e),n&&this.removeDiscussionNoteForm(e)}},{key:"updateNote",value:function(e,t){var n;n=s()(e.html),this.revertNoteEditForm(t),n.renderGFM(),s()(".note-row-"+e.id).replaceWith(n),this.setupNewNote(n),void 0!==gl.diffNotesCompileComponents&&gl.diffNotesCompileComponents()}},{key:"checkContentToAllowEditing",value:function(e){var t=e.find(".original-note-content").text().trim(),n=!0;if(e.find(".js-note-text").val()===t)this.removeNoteEditForm(e);else{e.find(".note-form-actions");Object(T.v)(e.get(0))||Object(T.F)(e),e.find(".js-finish-edit-warning").show(),n=!1}return n}},{key:"showEditForm",value:function(e,t,n){e.preventDefault();var i=s()(e.target),o=s()(this.getEditFormSelector(i)),a=i.closest(".note"),r=s()(".note.is-editing:visible");if(r.length&&!this.checkContentToAllowEditing(r))return;a.find(".js-note-attachment-delete").show(),o.addClass("current-note-edit-form"),a.addClass("is-editing"),this.putEditFormInPlace(i)}},{key:"cancelEdit",value:function(e){e.preventDefault();var t=s()(e.target),n=t.closest(".note"),i=n.attr("data-note-id");if(this.revertNoteEditForm(t),this.updatedNotesTrackingMap[i]){var o=s()(this.updatedNotesTrackingMap[i].html);n.replaceWith(o),this.setupNewNote(o),delete this.updatedNotesTrackingMap[i]}else n.find(".js-finish-edit-warning").hide(),this.removeNoteEditForm(n)}},{key:"revertNoteEditForm",value:function(e){e=e||s()(".note.is-editing:visible");var t=this.getEditFormSelector(e),n=s()(t);n.insertBefore(".diffs"),n.find(".js-comment-save-button").enable(),n.find(".js-finish-edit-warning").hide()}},{key:"getEditFormSelector",value:function(e){var t=".note-edit-form:not(.mr-note-edit-form)";return e.parents("#diffs").length&&(t=".note-edit-form.mr-note-edit-form"),t}},{key:"removeNoteEditForm",value:function(e){var t=e.find(".diffs .current-note-edit-form");return e.removeClass("is-editing"),t.removeClass("current-note-edit-form"),t.find(".js-finish-edit-warning").hide(),t.find(".js-note-text").val(t.find("form.edit-note").data("originalNote"))}},{key:"removeNote",value:function(t){var n,i;return i=s()(t.currentTarget).closest(".note"),n=i.attr("id"),i.attr("data-note-id"),s()(t.currentTarget).closest(".notes[data-discussion-id]").closest(".notes_holder").prev(".line_holder"),s()('.note[id="'+n+'"]').each(function(e,t){var i,o;o=(i=s()(t)).closest(".discussion-notes");var a=s()(".notes",o).data("discussionId");if(void 0!==gl.diffNotesCompileComponents&&gl.diffNoteApps[n]&&gl.diffNoteApps[n].$destroy(),i.remove(),0===o.find(".note").length){var r=o.closest("tr");if(o.closest(".timeline-entry").remove(),s()(".js-diff-avatars-"+a).trigger("remove.vue"),r.find(".discussion-notes").length>1||0===r.length){var l=o.closest(".diff-file");if(l.length>0){var c=new CustomEvent("removeBadge.imageDiff",{detail:{badgeNumber:o.index()+1}});l[0].dispatchEvent(c)}o.remove()}else r.length>0&&r.remove()}}),e.checkMergeRequestStatus(),this.updateNotesCount(-1)}},{key:"removeAttachment",value:function(){var e=s()(this).closest(".note");return e.find(".note-attachment").remove(),e.find(".note-body > .note-text").show(),e.find(".note-header").show(),e.find(".diffs .current-note-edit-form").remove()}},{key:"onReplyToDiscussionNote",value:function(e){this.replyToDiscussionNote(e.target)}},{key:"replyToDiscussionNote",value:function(e){var t,n;return t=this.cleanForm(this.formClone.clone()),(n=s()(e).closest(".js-discussion-reply-button")).closest(".discussion-reply-holder").hide().after(t),this.setupDiscussionNoteForm(n,t)}},{key:"setupDiscussionNoteForm",value:function(e,t){var n=e.closest(".text-file");0===n.length&&(n=e.closest(".image"));var i=e.data("discussionId");(i&&(t.attr("data-discussion-id",i),t.find("#in_reply_to_discussion_id").val(i)),t.find("#note_project_id").val(e.data("discussionProjectId")),t.attr("data-line-code",e.data("lineCode")),t.find("#line_type").val(e.data("lineType")),t.find("#note_noteable_type").val(n.data("noteableType")),t.find("#note_noteable_id").val(n.data("noteableId")),t.find("#note_commit_id").val(n.data("commitId")),t.find("#note_type").val(e.data("noteType")),t.find("#note_line_code").val(e.data("lineCode")),t.find("#note_position").val(e.attr("data-position")),t.find(".js-note-discard").show().removeClass("js-note-discard").addClass("js-close-discussion-note-form").text(t.find(".js-close-discussion-note-form").data("cancelText")),t.find(".js-note-target-close").remove(),t.find(".js-note-new-discussion").remove(),this.setupNoteForm(t),t.removeClass("js-main-target-form").addClass("discussion-form js-discussion-note-form"),void 0!==gl.diffNotesCompileComponents)&&(t.find("comment-and-resolve-btn").attr(":discussion-id","'"+i+"'"),gl.diffNotesCompileComponents());t.find(".js-note-text").focus(),t.find(".js-comment-resolve-button").attr("data-discussion-id",i)}},{key:"onAddDiffNote",value:function(e){e.preventDefault();var t=e.currentTarget||e.target,n=s()(t),i=!n.hasClass("js-diff-comment-avatar");this.toggleDiffNote({target:n,lineType:t.dataset.lineType,showReplyInput:i})}},{key:"onAddImageDiffNote",value:function(e){var t=s()(e.currentTarget||e.target),n=t.closest(".diff-file"),i=new CustomEvent("click.imageDiff",{detail:e});n[0].dispatchEvent(i);var o=void 0,a=t.closest(".diff-viewer").find(".note-container"),r=a.find("> .discussion-form");0===r.length?(o=this.cleanForm(this.formClone.clone())).appendTo(a):o=r,this.setupDiscussionNoteForm(t,o)}},{key:"toggleDiffNote",value:function(e){var t,n,i,o,a,r,l,c=e.target,d=e.lineType,u=e.forceShow,h=e.showReplyInput,f=void 0!==h&&h,p=(r=(t=s()(c)).closest("tr")).next(),v=r;p.is(".notes_holder")&&(v=p),i=p.is(".notes_holder"),n=!1;var m="";l='<tr class="notes_holder js-temp-notes-holder"><td class="notes_line" colspan="2"></td><td class="notes_content"><div class="content"></div></td></tr>',this.isParallelView()&&(m="."+d,l='<tr class="notes_holder js-temp-notes-holder"><td class="notes_line old"></td><td class="notes_content parallel old"><div class="content"></div></td><td class="notes_line new"></td><td class="notes_content parallel new"><div class="content"></div></td></tr>');var g=".notes_content"+m+" .content",y=v.find(g);if(i&&f)v.show(),(y=v.find(g)).length&&(y.show(),(a=y.find(".js-discussion-reply-button:visible")).length?this.replyToDiscussionNote(a[0]):0===y.find(".js-discussion-note-form").length&&(n=!0));else if(f)r.after(l),y=(v=r.next()).find(g),n=!0;else{var b=v.find(".content:not(:empty)").is(":visible"),w=!0===u||!b&&!(!0===u||!1===u);v.toggleClass("hide",!w),y.toggleClass("hide",!w)}if(n)return(o=this.cleanForm(this.formClone.clone())).appendTo(y),this.setupDiscussionNoteForm(t,o)}},{key:"removeDiscussionNoteForm",value:function(e){var t;return t=e.closest("tr"),e.data("glForm").destroy(),e.find(".js-note-text").data("autosave").reset(),e.prev(".discussion-reply-holder").show(),t.is(".js-temp-notes-holder")?t.remove():e.remove()}},{key:"cancelDiscussionForm",value:function(e){e.preventDefault();var t=s()(e.target).closest(".js-discussion-note-form");if(0===s()(e.target).closest(".discussion-notes").length){var n=t.closest(".diff-file");if(n.length>0){var i=new CustomEvent("blur.imageDiff",{detail:e});n[0].dispatchEvent(i)}}return this.removeDiscussionNoteForm(t)}},{key:"updateFormAttachment",value:function(){var e,t;return t=s()(this).closest("form"),e=s()(this).val().replace(/^.*[\\\/]/,""),t.find(".js-attachment-filename").text(e)}},{key:"visibilityChange",value:function(){return this.refresh()}},{key:"updateTargetButtons",value:function(e){var t,n,i,o,a,r,l;if(a=(o=(l=s()(e.target)).parents("form")).find(".js-note-target-reopen"),t=o.find(".js-note-target-close"),i=o.find(".js-note-discard"),l.val().trim().length>0){if(r=a.attr("data-alternative-text"),n=t.attr("data-alternative-text"),a.text()!==r&&a.text(r),t.text()!==n&&t.text(n),a.is(":not(.btn-comment-and-reopen)")&&a.addClass("btn-comment-and-reopen"),t.is(":not(.btn-comment-and-close)")&&t.addClass("btn-comment-and-close"),i.is(":hidden"))return i.show()}else if(r=a.data("originalText"),n=t.data("originalText"),a.text()!==r&&a.text(r),t.text()!==n&&t.text(n),a.is(".btn-comment-and-reopen")&&a.removeClass("btn-comment-and-reopen"),t.is(".btn-comment-and-close")&&t.removeClass("btn-comment-and-close"),i.is(":visible"))return i.hide()}},{key:"putEditFormInPlace",value:function(e){var t=s()(this.getEditFormSelector(e)),n=e.closest(".note");t.insertAfter(n.find(".note-text"));var i=n.find(".original-note-content"),o=i.text().trim(),a=i.data("postUrl"),r=i.data("targetId"),l=i.data("targetType"),c=i.data("markdownVersion");this.glForm=new _.a(t.find("form"),this.enableGFM),t.find("form").attr("action",a+"?html=true").attr("data-remote","true").attr("data-markdown-version",c),t.find(".js-form-target-id").val(r),t.find(".js-form-target-type").val(l),t.find(".js-note-text").focus().val(o),t.find(".js-md-write-button").trigger("click"),t.find(".referenced-users").hide()}},{key:"putConflictEditWarningInPlace",value:function(e,t){0===t.find(".js-conflict-edit-warning").length&&s()('<div class="js-conflict-edit-warning alert alert-danger">\n        This comment has changed since you started editing, please review the\n        <a href="#note_'+e.id+'" target="_blank" rel="noopener noreferrer">\n          updated comment\n        </a>\n        to ensure information is not lost\n      </div>').insertAfter(t.find(".note-text"))}},{key:"updateNotesCount",value:function(e){return this.notesCountBadge.text(parseInt(this.notesCountBadge.text(),10)+e)}},{key:"onClickRetryLazyLoad",value:function(e){var t=s()(e.currentTarget);return t.prop("disabled",!0),this.loadLazyDiff(e).then(function(){t.prop("disabled",!1)})}},{key:"loadLazyDiff",value:function(t){var n=s()(t.currentTarget).closest(".js-toggle-container");if(e.renderPlaceholderComponent(n),n.find(".js-toggle-lazy-diff").removeClass("js-toggle-lazy-diff"),0!==n.find("tbody").length){var i=n.find(".file-holder").data("linesPath"),o=n.find(".js-error-lazy-load-diff"),a=n.find(".js-success-lazy-load");return i?v.a.get(i).then(function(t){var i=t.data;a.removeClass("hidden"),o.addClass("hidden"),e.renderDiffContent(n,i)}).catch(function(){a.addClass("hidden"),o.removeClass("hidden")}):Promise.resolve()}}},{key:"toggleCommitList",value:function(e){var t=s()(e.currentTarget),n=t.siblings(".system-note-commit-list");t.find(".fa").toggleClass("fa-angle-down").toggleClass("fa-angle-up"),n.toggleClass("hide-shade")}},{key:"collapseLongCommitList",value:function(){var e=s()("#notes-list").find("li.system-note").has("ul");s.a.each(e,function(e,t){var n=s()(t),i=n.find(".note-text").find("p:first").text().replace(":","");n.find(".note-header .system-note-message").html(i),n.find("li").length>3?(n.find(".note-text").addClass("system-note-commit-list"),n.find(".system-note-commit-list-toggler").show()):n.find(".note-text").addClass("system-note-commit-list hide-shade")})}},{key:"addFlash",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.flashContainer=new(Function.prototype.bind.apply(g.a,[null].concat(t)))}},{key:"clearFlash",value:function(){this.flashContainer&&(this.flashContainer.style.display="none",this.flashContainer=null)}},{key:"cleanForm",value:function(e){return e.find(".js-comment-type-dropdown").removeClass("btn-group"),e.find(".dropdown-menu").remove(),e}},{key:"getFormData",value:function(e){var t=e.find(".js-note-text").val();return{formData:e.serialize(),formContent:a.a.escape(t),formAction:e.attr("action"),formContentOriginal:t}}},{key:"hasQuickActions",value:function(e){return F.test(e)}},{key:"stripQuickActions",value:function(e){return e.replace(F,"").trim()}},{key:"getQuickActionDescription",value:function(e){var t=void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(function(t,n){return new RegExp("/"+t.name).test(e)});n&&n.length?t=n.length>1?"Applying multiple commands":"Applying command to "+n[0].description.toLowerCase():t="Applying command";return t}},{key:"createPlaceholderNote",value:function(e){var t=e.formContent,n=e.uniqueId,i=e.isDiscussionNote,o=e.currentUsername,r=e.currentUserFullname,l=e.currentUserAvatar,c=i?"discussion":"",d=s()('<li id="'+n+'" class="note being-posted fade-in-half timeline-entry">\n         <div class="timeline-entry-inner">\n            <div class="timeline-icon">\n               <a href="/'+a.a.escape(o)+'">\n                 <img class="avatar s40" src="'+l+'" />\n               </a>\n            </div>\n            <div class="timeline-content '+c+'">\n               <div class="note-header">\n                  <div class="note-header-info">\n                     <a href="/'+a.a.escape(o)+'">\n                       <span class="d-none d-sm-inline-block">'+a.a.escape(o)+'</span>\n                       <span class="note-headline-light">'+a.a.escape(o)+'</span>\n                     </a>\n                  </div>\n               </div>\n               <div class="note-body">\n                 <div class="note-text">\n                   <p>'+t+"</p>\n                 </div>\n               </div>\n            </div>\n         </div>\n      </li>");return d.find(".d-none.d-sm-inline-block").text(a.a.escape(r)),d.find(".note-headline-light").text("@"+a.a.escape(o)),d}},{key:"createPlaceholderSystemNote",value:function(e){var t=e.formContent,n=e.uniqueId;return s()('<li id="'+n+'" class="note system-note timeline-entry being-posted fade-in-half">\n         <div class="timeline-entry-inner">\n           <div class="timeline-content">\n             <i>'+t+"</i>\n           </div>\n         </div>\n       </li>")}},{key:"postComment",value:function(e){var t=this;e.preventDefault();var n=s()(e.target);n.prop("disabled",!0);var i=n.parents("form"),o=i.find(".js-note-target-close"),r="discussion"===n.parent().find("li.droplab-item-selected").attr("id"),l=i.hasClass("js-main-target-form"),c=i.hasClass("js-discussion-note-form"),d=n.hasClass("js-comment-resolve-button"),h=this.getFormData(i),f=h.formData,p=h.formContent,m=h.formAction,g=h.formContentOriginal,y=void 0,b=void 0,w=!1,k=void 0,j=void 0;return c?k=i.parent(".discussion-notes").find(".notes"):l&&(k=s()("ul.main-notes-list")),d&&i.find(".js-comment-submit-button").disable(),j=p,this.hasQuickActions(p)&&(j=this.stripQuickActions(p),w=!0),j&&(y=a.a.uniqueId("tempNote_"),k.append(this.createPlaceholderNote({formContent:j,uniqueId:y,isDiscussionNote:r,currentUsername:gon.current_username,currentUserFullname:gon.current_user_fullname,currentUserAvatar:gon.current_user_avatar_url}))),w&&(b=a.a.uniqueId("tempSystemNote_"),k.append(this.createPlaceholderSystemNote({formContent:this.getQuickActionDescription(p,u.a.get(gl.GfmAutoComplete.dataSources.commands)),uniqueId:b}))),k.length&&(l?this.resetMainTargetForm(e):c&&this.removeDiscussionNoteForm(i)),o.text(o.data("originalText")),v.a.post(m+"?html=true",f).then(function(s){var o=s.data;n.prop("disabled",!1),k.find("#"+y).remove();var a=i.closest(".diff-file");if(a.length>0){var r=new CustomEvent("blur.imageDiff",{detail:e});a[0].dispatchEvent(r)}if(w&&i.find("textarea.js-note-text").trigger("clear-commands-cache.atwho"),t.clearFlashWrapper(),c){k.find(".flash-container").remove(),d&&i.attr("data-discussion-id",n.data("discussionId")).attr("data-resolve-all","true").attr("data-project-path",n.data("projectPath"));var u=0===k.length;if(t.addDiscussionNote(i,o,u),u){var h=i.find("#note_position").val();if(a.length>0&&h.length>0){var f=JSON.parse(h),p=f.x,v=f.y,m=f.width,g=f.height,b=new CustomEvent("addBadge.imageDiff",{detail:{x:p,y:v,width:m,height:g,noteId:"note_"+o.id,discussionId:o.discussion_id}});a[0].dispatchEvent(b)}}k.length&&k.append('<div class="flash-container" style="display: none;"></div>')}else l&&(t.addNote(i,o),t.reenableTargetFormSubmitButton(e));o.commands_changes&&t.handleQuickActions(o),i.trigger("ajax:success",[o])}).catch(function(){k.find("#"+y).remove(),n.prop("disabled",!1);var s=new CustomEvent("blur.imageDiff",{detail:e}),o=i.closest(".diff-file");if(o.length&&o[0].dispatchEvent(s),w&&k.find("#"+b).remove(),c&&k.length){var a=k.parent().find(".js-discussion-reply-button");t.replyToDiscussionNote(a[0]),i=k.parent().find("form")}i.find(".js-note-text").val(g),t.reenableTargetFormSubmitButton(e),t.addNoteError(i)})}},{key:"updateComment",value:function(e){var t=this;e.preventDefault();var n=s()(e.target).parents("form"),i=n.find(".js-note-target-close"),o=n.parents(".note.is-editing"),r=o.find(".js-task-list-container").find(".note-text"),l=this.getFormData(n),c=l.formData,d=l.formContent,u=l.formAction,h=(n.closest(".diff-file"),n.closest(".notes"),r.html());return r.html(d),o.removeClass("is-editing fade-in-full").addClass("being-posted fade-in-half"),o.find(".note-headline-meta a").html('<i class="fa fa-spinner fa-spin" aria-label="Comment is being updated" aria-hidden="true"></i>'),v.a.post(u+"?html=true",c).then(function(e){var n=e.data;t.updateNote(n,o)}).catch(function(){r.html(a.a.escape(h)),o.removeClass("being-posted fade-in"),o.find(".fa.fa-spinner").remove(),t.updateNoteError()}),i.text(i.data("originalText"))}}],[{key:"initCommentTypeToggle",value:function(e){var t=e.querySelector(".js-comment-type-dropdown .dropdown-toggle"),n=e.querySelector(".js-comment-type-dropdown .dropdown-menu"),i=e.querySelector("#note_type"),s=e.querySelector(".js-comment-type-dropdown .js-comment-submit-button"),o=e.querySelector(".js-note-target-close"),a=e.querySelector(".js-note-target-reopen");new C({dropdownTrigger:t,dropdownList:n,noteTypeInput:i,submitButton:s,closeButton:o,reopenButton:a}).initDroplab()}},{key:"updateNoteTargetSelector",value:function(e){var t=Object(m.a)(),n=Boolean(t&&e.filter("#"+t).length>0);e.toggleClass("target",n)}},{key:"renderPlaceholderComponent",value:function(e){var t=e.find(".js-code-placeholder").get(0);new h.default({el:t,components:{SkeletonLoadingContainer:p.a},render:function(e){return e("skeleton-loading-container")}})}},{key:"renderDiffContent",value:function(e,t){var n=t.discussion_html,i=s()(n).find(".line_holder");i.addClass("fade-in"),e.find(".diff-content > table > tbody").prepend(i);var o=e.find(".file-holder");e.find(".line-holder-placeholder").remove(),Object(f.a)(o)}},{key:"isNewNote",value:function(e,t){return-1===s.a.inArray(e.id,t)}},{key:"isUpdatedNote",value:function(e,t){return D(e.note.trim())!==D(t.find(".original-note-content").first().text().trim())}},{key:"checkMergeRequestStatus",value:function(){"merge_requests"===Object(T.i)(1)&&gl.mrWidget&&gl.mrWidget.checkStatus()}},{key:"animateAppendNote",value:function(e,t){var n=s()(e);return n.addClass("fade-in-full").renderGFM(),t.append(n),n}},{key:"animateUpdateNote",value:function(e,t){var n=s()(e);return n.addClass("fade-in").renderGFM(),t.replaceWith(n),n}}]),e}();t.a=L;window.Notes=L},243:function(e,t,n){(function(t){var n;n=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,n){var i,s,o,a,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};i=function(e){return Array.prototype.slice.apply(e)},o=function(e,t){for(;e&&!e.classList.contains(t);)e=e.parentNode;return e},a=function(e,t){var n;return"function"==typeof Event?(n=new Event(e,{bubbles:!0,cancelable:!0})).detail=t:(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,t),n},s=function(){function e(e){var t;this.el=e,this.container=o(this.el,"js-task-list-container"),this.field=this.container.querySelector(".js-task-list-field"),this.container.addEventListener("change",(t=this,function(e){if(e.target.classList.contains("task-list-item-checkbox"))return t.updateTaskList(e.target)})),this.enable()}return e.prototype.enable=function(){var e;if(this.container.querySelectorAll(".js-task-list-field").length>0)return i(this.container.querySelectorAll(".task-list-item")).forEach(function(e){return e.classList.add("enabled")}),i(this.container.querySelectorAll(".task-list-item-checkbox")).forEach(function(e){return e.disabled=!1}),this.container.classList.add("is-task-list-enabled"),e=a("tasklist:enabled"),this.container.dispatchEvent(e)},e.prototype.disable=function(){var e;return i(this.container.querySelectorAll(".task-list-item")).forEach(function(e){return e.classList.remove("enabled")}),i(this.container.querySelectorAll(".task-list-item-checkbox")).forEach(function(e){return e.disabled=!0}),this.container.classList.remove("is-task-list-enabled"),e=a("tasklist:disabled"),this.container.dispatchEvent(e)},e.prototype.updateTaskList=function(t){var n,s,o,r;if(o=this.container.querySelectorAll(".task-list-item-checkbox"),r=1+i(o).indexOf(t),n=a("tasklist:change",{index:r,checked:t.checked}),this.field.dispatchEvent(n),!n.defaultPrevented)return this.field.value=e.updateSource(this.field.value,r,t.checked),n=a("change"),this.field.dispatchEvent(n),s=a("tasklist:changed",{index:r,checked:t.checked}),this.field.dispatchEvent(s)},e.incomplete="[ ]",e.complete="[x]",e.escapePattern=function(e){return e.replace(/([\[\]])/g,"\\$1").replace(/\s/,"\\s").replace("x","[xX]")},e.incompletePattern=RegExp(""+e.escapePattern(e.incomplete)),e.completePattern=RegExp(""+e.escapePattern(e.complete)),e.itemPattern=RegExp("^(?:\\s*(?:>\\s*)*(?:[-+*]|(?:\\d+\\.)))\\s*("+e.escapePattern(e.complete)+"|"+e.escapePattern(e.incomplete)+")\\s+(?!\\(.*?\\))(?=(?:\\[.*?\\]\\s*(?:\\[.*?\\]|\\(.*?\\))\\s*)*(?:[^\\[]|$))"),e.startFencesPattern=/^`{3}.*$/,e.endFencesPattern=/^`{3}$/,e.itemsInParasPattern=RegExp("^("+e.escapePattern(e.complete)+"|"+e.escapePattern(e.incomplete)+").+$","g"),e.updateSource=function(e,t,n){var i,s,o,a;return i=e.replace(/\r/g,"").replace(this.itemsInParasPattern,"").split("\n"),o=0,s=!1,function(){var l,c,d,u;for(u=[],l=0,c=(d=e.split("\n")).length;l<c;l++)a=d[l],s?a.match(this.endFencesPattern)&&(s=!1):a.match(this.startFencesPattern)?s=!0:r.call(i,a)>=0&&a.match(this.itemPattern)&&(o+=1)===t&&(a=n?a.replace(this.incompletePattern,this.complete):a.replace(this.completePattern,this.incomplete)),u.push(a);return u}.call(this).join("\n")},e}(),void 0!==t&&(t.fn.taskList=function(e){return this.each(function(n,i){var o;if((o=t(i).data("task-list"))||(o=new s(i),t(i).data("task-list",o),e&&"enable"!==e))return o[e||"enable"]()})}),e.exports=s}])},e.exports=n()}).call(this,n(0))},281:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.highlightLineClass=e.highlightLineClass||"hll",e.fileHolderSelector=e.fileHolderSelector||".file-holder",e.scrollFileHolder=e.scrollFileHolder||!1,e.hash=e.hash||window.location.hash,this.options=e,this._hash=e.hash,this.highlightLineClass=e.highlightLineClass,this.setHash=this.setHash.bind(this),this.highlightLine=this.highlightLine.bind(this),this.clickHandler=this.clickHandler.bind(this),this.highlightHash=this.highlightHash.bind(this),this.bindEvents(),this.highlightHash()};o.prototype.bindEvents=function(){var e=s()(this.options.fileHolderSelector);e.on("click","a[data-line-number]",this.clickHandler),e.on("highlight:line",this.highlightHash)},o.prototype.highlightHash=function(e){var t=void 0;if(e&&"string"==typeof e&&(this._hash=e),this.clearHighlight(),""!==this._hash&&(t=this.hashToRange(this._hash))[0]){this.highlightRange(t);var n="#L"+t[0],i={offset:-150};this.options.scrollFileHolder?s()(this.options.fileHolderSelector).scrollTo(n,i):s.a.scrollTo(n,i)}},o.prototype.clickHandler=function(e){var t,n,i;return e.preventDefault(),this.clearHighlight(),n=s()(e.target).closest("a").data("lineNumber"),(t=this.hashToRange(this._hash))[0]&&e.shiftKey?e.shiftKey?(i=n<t[0]?[n,t[0]]:[t[0],n],this.setHash(i[0],i[1]),this.highlightRange(i)):void 0:(this.setHash(n),this.highlightLine(n))},o.prototype.clearHighlight=function(){return s()("."+this.highlightLineClass).removeClass(this.highlightLineClass)},o.prototype.hashToRange=function(e){var t;return(t=e.match(/^#?L(\d+)(?:-(\d+))?$/))&&t.length?[parseInt(t[1],10),t[2]?parseInt(t[2],10):null]:[null,null]},o.prototype.highlightLine=function(e){return s()("#LC"+e).addClass(this.highlightLineClass)},o.prototype.highlightRange=function(e){if(e[1]){for(var t=[],n=e[0]<=e[1]?e:e.reverse(),i=e[0];i<=n[1];i+=1)t.push(this.highlightLine(i));return t}return this.highlightLine(e[0])},o.prototype.setHash=function(e,t){var n;return n=t?"#L"+e+"-"+t:"#L"+e,this._hash=n,this.__setLocationHash__(n)},o.prototype.__setLocationHash__=function(e){return window.history.pushState({url:e},document.title,e)},t.a=o},346:function(e,t,n){"use strict";var i=n(205);t.a=function(){var e=document.querySelector(".js-notes-data"),t=JSON.parse(e.innerHTML),n=t.notesUrl,s=t.notesIds,o=t.now,a=t.diffView,r=t.enableGFM;i.a.initialize(n,s,o,a,r)}},448:function(e,t,n){"use strict";t.a=function(){var e=window.location,t=e.protocol,n=e.host,i=e.pathname,s=document.querySelector(".js-share-btn"),o=document.querySelector(".js-embed-btn"),a=document.querySelector(".js-snippet-url-area"),r=document.querySelector(".js-embed-action"),l=t+"//"+(n+i);s.addEventListener("click",function(){s.classList.add("is-active"),o.classList.remove("is-active"),a.value=l,r.innerText="Share"}),o.addEventListener("click",function(){o.classList.add("is-active"),s.classList.remove("is-active");var e='<script src="'+l+'.js"><\/script>';a.value=e,r.innerText="Embed"})}},65:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=n(50),a=n.n(o),r=n(53),l=n(24),c=n.n(l),d=n(3),u=n.n(d),h=(n(157),n(66)),f=n(5);function p(e){var t=e.find(".button-attach-file"),n=e.find(".attaching-file-message"),i=e.find(".button-cancel-uploading-files"),o=e.find(".retry-uploading-link"),a=e.find(".uploading-progress"),r=e.find(".uploading-error-container"),l=e.find(".uploading-error-message"),d=e.find(".uploading-progress-container"),p=window.uploads_path||null,v=gon.max_file_size||10,m=e.find(".js-gfm-input"),g=void 0,y=void 0,b=void 0,w=void 0,k=void 0,j=void 0,C=void 0;m.wrap('<div class="div-dropzone"></div>'),m.on("paste",function(e){return g(e)});var _=m.closest(".md-area");e.setupMarkdownPreview();var E=e.find(".div-dropzone");if(E.parent().addClass("div-dropzone-wrapper"),E.append('<div class="div-dropzone-hover"></div>'),E.find(".div-dropzone-hover").append('<i class="fa fa-paperclip div-dropzone-icon"></i>'),p){var x=E.dropzone({url:p,dictDefaultMessage:"",clickable:!0,paramName:"file",maxFilesize:v,uploadMultiple:!1,headers:h.a.headers,previewContainer:!1,processing:function(){return s()(".div-dropzone-alert").alert("close")},dragover:function(){_.addClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",.7)},dragleave:function(){_.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0)},drop:function(){_.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0),m.focus()},success:function(e,n){var i=this.getQueuedFiles().length+this.getUploadingFiles().length,s=i>=1;y(n.link.markdown,s),i||t.removeClass("hide"),b(n.link.url)},error:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Attaching the file failed.",s=arguments[2],o=s?s.responseText:n;r.removeClass("hide"),l.html(o),t.addClass("hide"),i.addClass("hide")},totaluploadprogress:function(e){w(this.files,n),a.text(Math.round(e)+"%")},sending:function(){t.addClass("hide"),r.addClass("hide"),d.removeClass("hide"),i.removeClass("hide")},removedfile:function(){t.removeClass("hide"),i.addClass("hide"),d.addClass("hide"),r.addClass("hide")},queuecomplete:function(){s()(".dz-preview").remove(),s()(".markdown-area").trigger("input"),d.addClass("hide"),i.addClass("hide")}}),N=s()(x[0]).children("textarea");i.on("click",function(e){e.preventDefault(),e.stopPropagation(),c.a.forElement(E.get(0)).removeAllFiles(!0)}),o.on("click",function(e){var t=c.a.forElement(e.target.closest(".js-main-target-form").querySelector(".div-dropzone")),n=t.files;e.preventDefault(),t.removeAllFiles(!0),n.map(function(e){var n=e;return n.status===c.a.ERROR&&(n.status=void 0,n.accepted=void 0),t.addFile(n)})}),g=function(e){var t=e.originalEvent;if(t.clipboardData&&t.clipboardData.items){var n=k(t);if(n){e.preventDefault();var i=j(t)||"image.png";return y("{{"+i+"}}"),C(n.getAsFile(),i)}}},k=function(e){for(var t=0;t<e.clipboardData.items.length;){var n=e.clipboardData.items[t];if(-1!==n.type.indexOf("image"))return n;t+=1}return!1},y=function(e,t){var n=e;t&&(n+="\n\n");var i=N.get(0),o=i.selectionStart,a=i.selectionEnd,r=s()(N).val().length,l=s()(N).val().substring(0,o),c=s()(N).val().substring(a,r);return s()(N).val(l+n+c),i.setSelectionRange(o+n.length,a+n.length),i.style.height=i.scrollHeight+"px",m.get(0).dispatchEvent(new Event("input")),m.trigger("input")},b=function(t){s()(e).append('<input type="hidden" name="files[]" value="'+u.a.escape(t)+'">')},j=function(e){var t=void 0;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),(t=t.split("\r"))[0]};var T=function(){return d.addClass("hide")};C=function(t,n){var i=new FormData;i.append("file",t,n),d.removeClass("hide"),e.find(".div-dropzone-alert").alert("close"),f.a.post(p,i).then(function(e){var t=e.data.link.markdown;!function(e,t){var n=s()(N);n.val(function(n,i){return i.replace("{{"+e+"}}",t)}),n.trigger("change")}(n,t),T()}).catch(function(e){var t;t=e.response.data.message,r.removeClass("hide"),l.html(t),T()})},w=function(e,t){var n=void 0,i=e.filter(function(e){return"uploading"===e.status||"queued"===e.status}).length;n=i>1?"Attaching "+i+" files -":"Attaching a file -",t.text(n)},e.find(".markdown-selector").click(function(e){e.preventDefault(),s()(this).closest(".gfm-form").find(".div-dropzone").click(),m.focus()})}else E.addClass("js-invalid-dropzone")}c.a.autoDiscover=!1;var v=n(11);function m(e,t,n,i){var o,a,r;return e=(o=s()(e)).get(0),a=function(e,t){return e.substring(t.selectionStart,t.selectionEnd)}(r=o.val(),e),o.focus(),function(e,t,n,i,s,o){var a,r,l,c,d,u,h;return c=!1,d=!1,u=!1,0===s.indexOf("\n")&&(d=!0,s=s.replace(/\n+/,"")),e.selectionEnd-e.selectionStart>s.replace(/\n$/,"").length&&(c=!0,s=s.replace(/\n$/,"")),r=s.split("\n"),o||(h=e.value.substr(0,e.selectionStart).lastIndexOf("\n"),/^\s*$/.test(e.value.substring(h,e.selectionStart))&&(u=!0)),l=!o&&!u&&e.selectionStart>0?"\n":"",a=r.length>1&&(!o||null!=i&&""!==i)?null!=i&&""!==i?function(e,t,n,i){var s=function(e,t){var n;return(n=e.substring(0,t.selectionStart).trim().split("\n"))[n.length-1]}(e,t),o=function(e,t){return e.substring(t.selectionEnd).trim().split("\n")[0]}(e,t);return s===n&&o===n?(null!=n&&(t.selectionStart=t.selectionStart-(n.length+1),t.selectionEnd=t.selectionEnd+(n.length+1)),i):n+"\n"+i+"\n"+n}(t,e,i,s):r.map(function(e){return 0===e.indexOf(n)?""+e.replace(n,""):""+n+e}).join("\n"):""+l+n+s+(o?n:" "),d&&(a="\n"+a),c&&(a+="\n"),Object(v.p)(e,a),function(e,t,n,i){var s;if(e.setSelectionRange)return e.selectionStart===e.selectionEnd?(s=n?e.selectionStart-t.length:e.selectionStart,i&&(s-=1),e.setSelectionRange(s,s)):void 0}(e,n,o,c)}(e,r,t,n,a,i)}var g=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var y=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=t,this.textarea=this.form.find("textarea.js-gfm-input"),this.enableGFM=Object.assign({},r.b,i);var s=gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources||{};Object.keys(this.enableGFM).forEach(function(e){"emojis"!==e&&(n.enableGFM[e]=!!s[e])}),this.destroy(),this.setupForm(),this.form.data("glForm",this)}return g(e,[{key:"destroy",value:function(){this.clearEventListeners(),this.autoComplete&&this.autoComplete.destroy(),this.form.data("glForm",null)}},{key:"setupForm",value:function(){var e,t=this.form.is(":not(.gfm-form)");this.form.removeClass("js-new-note-form"),t&&(this.form.find(".div-dropzone").remove(),this.form.addClass("gfm-form"),gl.utils.disableButtonIfEmptyField(this.form.find(".js-note-text"),this.form.find(".js-comment-button, .js-note-new-discussion")),this.autoComplete=new r.a(gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources),this.autoComplete.setup(this.form.find(".js-gfm-input"),this.enableGFM),p(this.form),a()(this.textarea)),this.addEventListeners(),e=this.form,s()(".js-md",e).off("click").on("click",function(){var e=s()(this);return m(e.closest(".md-area").find("textarea"),e.data("mdTag"),e.data("mdBlock"),!e.data("mdPrepend"))}),this.form.find(".js-note-discard").hide(),this.form.show(),this.isAutosizeable&&this.setupAutosize()}},{key:"setupAutosize",value:function(){var e=this;this.textarea.off("autosize:resized").on("autosize:resized",this.setHeightData.bind(this)),this.textarea.off("mouseup.autosize").on("mouseup.autosize",this.destroyAutosize.bind(this)),setTimeout(function(){a()(e.textarea),e.textarea.css("resize","vertical")},0)}},{key:"setHeightData",value:function(){this.textarea.data("height",this.textarea.outerHeight())}},{key:"destroyAutosize",value:function(){var e=this.textarea.outerHeight();this.textarea.data("height")!==e&&(a.a.destroy(this.textarea),this.textarea.data("height",e),this.textarea.outerHeight(e),this.textarea.css("max-height",window.outerHeight))}},{key:"clearEventListeners",value:function(){var e;this.textarea.off("focus"),this.textarea.off("blur"),e=this.form,s()(".js-md",e).off("click")}},{key:"addEventListeners",value:function(){this.textarea.on("focus",function(){s()(this).closest(".md-area").addClass("is-focused")}),this.textarea.on("blur",function(){s()(this).closest(".md-area").removeClass("is-focused")})}}]),e}();t.a=y},71:function(e,t,n){"use strict";var i=n(0),s=n.n(i),o=(n(158),n(24)),a=n.n(o),r=n(29),l=n.n(r),c=(n(99),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}());a.a.autoDiscover=!1;var d=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active_backdrop=null,this.active_textarea=null,s()(document).on("click",".js-zen-enter",function(e){return e.preventDefault(),s()(e.currentTarget).trigger("zen_mode:enter")}),s()(document).on("click",".js-zen-leave",function(e){return e.preventDefault(),s()(e.currentTarget).trigger("zen_mode:leave")}),s()(document).on("zen_mode:enter",(t=this,function(e){return t.enter(s()(e.target).closest(".md-area").find(".zen-backdrop"))})),s()(document).on("zen_mode:leave",function(e){return function(t){return e.exit()}}(this)),s()(document).on("keydown",function(e){if(27===e.keyCode)return e.preventDefault(),s()(document).trigger("zen_mode:leave")})}return c(e,[{key:"enter",value:function(e){l.a.pause(),this.active_backdrop=s()(e),this.active_backdrop.addClass("fullscreen"),this.active_textarea=this.active_backdrop.find("textarea"),this.active_textarea.removeAttr("style"),this.active_textarea.focus()}},{key:"exit",value:function(){if(this.active_textarea){l.a.unpause(),this.active_textarea.closest(".zen-backdrop").removeClass("fullscreen"),this.scrollTo(this.active_textarea),this.active_textarea=null,this.active_backdrop=null;var e=s()(".div-dropzone");e&&!e.hasClass("js-invalid-dropzone")&&a.a.forElement(".div-dropzone").enable()}}},{key:"scrollTo",value:function(e){return s.a.scrollTo(e,0,{offset:-150})}}]),e}();t.a=d},889:function(e,t,n){"use strict";n.r(t);var i=n(281),s=n(198),o=n(71),a=n(346),r=n(448);document.addEventListener("DOMContentLoaded",function(){new i.a,new s.a,Object(a.a)(),new o.a,Object(r.a)()})},890:function(e,t,n){n(31),e.exports=n(889)},98:function(e,t,n){"use strict";var i=n(76),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(t,n){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.isLocalStorageAvailable=i.a.isLocalStorageAccessSafe(),null!=n.join&&(n=n.join("/")),this.key="autosave/"+n,this.field.data("autosave",this),this.restore(),this.field.on("input",function(){return s.save()})}return s(e,[{key:"restore",value:function(){if(this.isLocalStorageAvailable&&this.field.length){var e=window.localStorage.getItem(this.key);(null!=e?e.length:void 0)>0&&this.field.val(e),this.field.trigger("input");var t=new Event("change",{bubbles:!0,cancelable:!1}),n=this.field.get(0);n&&n.dispatchEvent(t)}}},{key:"save",value:function(){if(this.field.length){var e=this.field.val();return this.isLocalStorageAvailable&&(null!=e?e.length:void 0)>0?window.localStorage.setItem(this.key,e):this.reset()}}},{key:"reset",value:function(){if(this.isLocalStorageAvailable)return window.localStorage.removeItem(this.key)}},{key:"dispose",value:function(){this.field.off("input")}}]),e}();t.a=o},99:function(e,t){Mousetrap=function(e){var t=e,n=t.stopCallback,i=!0;return t.stopCallback=function(e,t,s){return!i||n(e,t,s)},t.pause=function(){i=!1},t.unpause=function(){i=!0},t}(Mousetrap)}},[[890,0,1,3,16]]]);
//# sourceMappingURL=pages.snippets.show.7ddf67f3.chunk.js.map