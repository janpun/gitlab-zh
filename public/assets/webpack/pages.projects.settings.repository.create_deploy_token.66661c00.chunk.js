(this.webpackJsonp=this.webpackJsonp||[]).push([[104],{103:function(e,t,n){"use strict";var a=n(0),o=n.n(a),i=n(73),s=n.n(i),r=n(111),l=n.n(r),c=n(1),d=n(5),u=n(38),p=n(36),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.$dropdown,a=t.$loading;h(this,e);var i=n.closest(".dropdown"),s=n.closest(".block");this.$loading=a,this.$dropdown=n,this.$dropdownParent=i,this.$datePicker=i.find(".js-due-date-calendar"),this.$block=s,this.$sidebarCollapsedValue=s.find(".sidebar-collapsed-icon"),this.$selectbox=n.closest(".selectbox"),this.$value=s.find(".value"),this.$valueContent=s.find(".value-content"),this.$sidebarValue=o()(".js-due-date-sidebar-value",s),this.fieldName=n.data("fieldName"),this.abilityName=n.data("abilityName"),this.issueUpdateURL=n.data("issueUpdate"),this.rawSelectedDate=null,this.displayedDate=null,this.datePayload=null,this.initGlDropdown(),this.initRemoveDueDate(),this.initDatePicker()}return f(e,[{key:"initGlDropdown",value:function(){var e=this;this.$dropdown.glDropdown({opened:function(){e.$datePicker.data("pikaday").show()},hidden:function(){e.$selectbox.hide(),e.$value.css("display","")}})}},{key:"initDatePicker",value:function(){var e=this,t=o()("input[name='"+this.fieldName+"']"),n=new s.a({field:t.get(0),theme:"gitlab-theme",format:"yyyy-mm-dd",parse:function(e){return Object(p.a)(e)},toString:function(e){return Object(p.b)(e)},onSelect:function(a){t.val(n.toString(a)),e.$dropdown.hasClass("js-issue-boards-due-date")?(gl.issueBoards.BoardsStore.detail.issue.dueDate=t.val(),e.updateIssueBoardIssue()):e.saveDueDate(!0)}});n.setDate(Object(p.a)(t.val())),this.$datePicker.append(n.el),this.$datePicker.data("pikaday",n)}},{key:"initRemoveDueDate",value:function(){var e=this;this.$block.on("click",".js-remove-due-date",function(t){var n=e.$datePicker.data("pikaday");t.preventDefault(),n.setDate(null),e.$dropdown.hasClass("js-issue-boards-due-date")?(gl.issueBoards.BoardsStore.detail.issue.dueDate="",e.updateIssueBoardIssue()):(o()("input[name='"+e.fieldName+"']").val(""),e.saveDueDate(!1))})}},{key:"saveDueDate",value:function(e){this.parseSelectedDate(),this.prepSelectedDate(),this.submitSelectedDate(e)}},{key:"parseSelectedDate",value:function(){if(this.rawSelectedDate=o()("input[name='"+this.fieldName+"']").val(),this.rawSelectedDate.length){var e=this.rawSelectedDate.split("-").map(function(e){return parseInt(e,10)}),t=new Date(e[0],e[1]-1,e[2]);this.displayedDate=l()(t,"mmm d, yyyy")}else this.displayedDate="No due date"}},{key:"prepSelectedDate",value:function(){var e={};e[this.abilityName]={},e[this.abilityName].due_date=this.rawSelectedDate,this.datePayload=e}},{key:"updateIssueBoardIssue",value:function(){var e=this;this.$loading.fadeIn(),this.$dropdown.trigger("loading.gl.dropdown"),this.$selectbox.hide(),this.$value.css("display","");var t=function(){e.$loading.fadeOut()};gl.issueBoards.BoardsStore.detail.issue.update(this.$dropdown.attr("data-issue-update")).then(t).catch(t)}},{key:"submitSelectedDate",value:function(e){var t=this,n=this.datePayload[this.abilityName].due_date,a="No due date"!==this.displayedDate,i=a?"bold":"no-value";return this.$loading.removeClass("hidden").fadeIn(),e&&(this.$dropdown.trigger("loading.gl.dropdown"),this.$selectbox.hide()),this.$value.css("display",""),this.$valueContent.html("<span class='"+i+"'>"+this.displayedDate+"</span>"),this.$sidebarValue.html(this.displayedDate),o()(".js-remove-due-date-holder").toggleClass("hidden",n.length),d.a.put(this.issueUpdateURL,this.datePayload).then(function(){var o=a?Object(c.a)("Due date")+"<br />"+n+" ("+Object(u.f)(n)+")":Object(c.a)("Due date");return e&&(t.$dropdown.trigger("loaded.gl.dropdown"),t.$dropdown.dropdown("toggle")),t.$sidebarCollapsedValue.attr("data-original-title",o),t.$loading.fadeOut()})}}]),e}(),b=function(){function e(){h(this,e),this.initMilestoneDatePicker(),this.initIssuableSelect()}return f(e,[{key:"initMilestoneDatePicker",value:function(){o()(".datepicker").each(function(){var e=o()(this),t=e.val(),n=new s.a({field:e.get(0),theme:"gitlab-theme animate-picker",format:"yyyy-mm-dd",container:e.parent().get(0),parse:function(e){return Object(p.a)(e)},toString:function(e){return Object(p.b)(e)},onSelect:function(t){e.val(n.toString(t))}});n.setDate(Object(p.a)(t)),e.data("pikaday",n)}),o()(".js-clear-due-date,.js-clear-start-date").on("click",function(e){e.preventDefault(),o()(e.target).siblings(".datepicker").data("pikaday").setDate(null)})}},{key:"initIssuableSelect",value:function(){var e=o()(".js-issuable-update .due_date").find(".block-loading").hide();o()(".js-due-date-select").each(function(t,n){var a=o()(n);new y({$dropdown:a,$loading:e})})}}]),e}();t.a=b},12:function(e,t,n){"use strict";var a=n(0),o=n.n(a);t.a={bind:function(e){o()(e).tooltip({trigger:"hover"})},componentUpdated:function(e){o()(e).tooltip("_fixTitle")},unbind:function(e){o()(e).tooltip("dispose")}}},15:function(e,t,n){"use strict";var a=[8,10,12,16,18,24,32,48,72],o={props:{name:{type:String,required:!0,validator:function(){return!0}},size:{type:Number,required:!1,default:16,validator:function(e){return a.includes(e)}},cssClasses:{type:String,required:!1,default:""},width:{type:Number,required:!1,default:null},height:{type:Number,required:!1,default:null},y:{type:Number,required:!1,default:null},x:{type:Number,required:!1,default:null},tabIndex:{type:String,required:!1,default:null}},computed:{spriteHref:function(){return gon.sprite_icons+"#"+this.name},iconTestClass:function(){return"ic-"+this.name},iconSizeClass:function(){return this.size?"s"+this.size:""}}},i=n(2),s=Object(i.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{class:[e.iconSizeClass,e.iconTestClass,e.cssClasses],attrs:{width:e.width,height:e.height,x:e.x,y:e.y,tabindex:e.tabIndex}},[n("use",e._b({},"use",{"xlink:href":e.spriteHref},!1))])},[],!1,null,null,null);t.a=s.exports},150:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(0),o=n.n(a);function i(e){e.find(".js-settings-toggle").text("Collapse"),e.find(".settings-content").off("scroll.expandSection").scrollTop(0),e.addClass("expanded"),e.hasClass("no-animate")||e.addClass("animating").one("animationend.animateSection",function(){return e.removeClass("animating")})}function s(e){e.removeClass("no-animate"),e.hasClass("expanded")?function(e){e.find(".js-settings-toggle").text("Expand"),e.find(".settings-content").on("scroll.expandSection",function(){return i(e)}),e.removeClass("expanded"),e.hasClass("no-animate")||e.addClass("animating").one("animationend.animateSection",function(){return e.removeClass("animating")})}(e):i(e)}function r(){if(o()(".settings").each(function(e,t){var n=o()(t);n.on("click.toggleSection",".js-settings-toggle",function(){return s(n)}),n.hasClass("expanded")||n.find(".settings-content").on("scroll.expandSection",function(){n.removeClass("no-animate"),i(n)})}),window.location.hash){var e=o()(window.location.hash);e.length&&e.hasClass("settings")&&i(e)}}},167:function(e,t,n){"use strict";var a=n(3),o=n.n(a),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultToggleLabel=t.defaultToggleLabel,this.fieldName=t.fieldName,this.onSelect=t.onSelect||function(){},this.getDataOption=t.getData,this.getDataRemote=!!t.filterRemote,this.createNewItemFromValueOption=t.createNewItemFromValue,this.$dropdown=t.$dropdown,this.$dropdownContainer=this.$dropdown.parent(),this.$dropdownFooter=this.$dropdownContainer.find(".dropdown-footer"),this.$createButton=this.$dropdownContainer.find(".js-dropdown-create-new-item"),this.buildDropdown(),this.bindEvents(),this.toggleFooter(!0)}return i(e,[{key:"buildDropdown",value:function(){var e=this;this.$dropdown.glDropdown({data:this.getData.bind(this),filterable:!0,filterRemote:this.getDataRemote,search:{fields:["text"]},selectable:!0,toggleLabel:function(e){return e&&"id"in e?o.a.escape(e.title):this.defaultToggleLabel},fieldName:this.fieldName,text:function(e){return o.a.escape(e.text)},id:function(e){return o.a.escape(e.id)},onFilter:this.toggleCreateNewButton.bind(this),clicked:function(t){t.e.preventDefault(),e.onSelect()}})}},{key:"clearDropdown",value:function(){this.$dropdownContainer.find(".dropdown-content").html(""),this.$dropdownContainer.find(".dropdown-input-field").val("")}},{key:"bindEvents",value:function(){this.$createButton.on("click",this.onClickCreateWildcard.bind(this))}},{key:"onClickCreateWildcard",value:function(e){e.preventDefault(),this.refreshData(),this.$dropdown.data("glDropdown").selectRowAtIndex()}},{key:"refreshData",value:function(){this.$dropdown.data("glDropdown").remote.execute()}},{key:"getData",value:function(e,t){var n=this;this.getDataOption(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=e;n.selectedItem&&e.some(function(e){return e.id===n.selectedItem.id})||(a=e.concat(n.selectedItem||[])),t(a)})}},{key:"createNewItemFromValue",value:function(e){return this.createNewItemFromValueOption?this.createNewItemFromValueOption(e):{title:e,id:e,text:e}}},{key:"toggleCreateNewButton",value:function(e){e&&(this.selectedItem=this.createNewItemFromValue(e),this.$dropdownContainer.find(".js-dropdown-create-new-item code").text(e)),this.toggleFooter(!e)}},{key:"toggleFooter",value:function(e){this.$dropdownFooter.toggleClass("hidden",e)}}]),e}();t.a=s},271:function(e,t,n){"use strict";var a=n(0),o=n.n(a),i={name:"NavigationTabs",props:{tabs:{type:Array,required:!0},scope:{type:String,required:!1,default:""}},mounted:function(){o()(document).trigger("init.scrolling-tabs")},methods:{shouldRenderBadge:function(e){return!(void 0===e||null===e)},onTabClick:function(e){this.$emit("onChangeTab",e.scope)}}},s=n(2),r=Object(s.a)(i,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"nav-links scrolling-tabs separator"},e._l(e.tabs,function(t,a){return n("li",{key:a,class:{active:t.isActive}},[n("a",{class:"js-"+e.scope+"-tab-"+t.scope,attrs:{role:"button"},on:{click:function(n){e.onTabClick(t)}}},[e._v("\n      "+e._s(t.name)+"\n\n      "),e.shouldRenderBadge(t.count)?n("span",{staticClass:"badge badge-pill"},[e._v("\n        "+e._s(t.count)+"\n      ")]):e._e()])])}))},[],!1,null,null,null);t.a=r.exports},445:function(e,t,n){"use strict";var a=n(0),o=n.n(a),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.initDropdown()}return i(e,[{key:"initDropdown",value:function(){var e=this.options.onSelect;this.options.$dropdown.glDropdown({data:this.options.data,selectable:!0,inputId:this.options.$dropdown.data("inputId"),fieldName:this.options.$dropdown.data("fieldName"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(t){t.e.preventDefault(),e()}})}}]),e}(),r=n(167),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=o()(".js-new-protected-tag"),this.buildDropdowns()}return l(e,[{key:"buildDropdowns",value:function(){var t=this.$form.find(".js-allowed-to-create");this.onSelectCallback=this.onSelect.bind(this),this.protectedTagAccessDropdown=new s({$dropdown:t,data:gon.create_access_levels,onSelect:this.onSelectCallback}),t.data("glDropdown").selectRowAtIndex(0),this.createItemDropdown=new r.a({$dropdown:this.$form.find(".js-protected-tag-select"),defaultToggleLabel:"Protected Tag",fieldName:"protected_tag[name]",onSelect:this.onSelectCallback,getData:e.getProtectedTags})}},{key:"onSelect",value:function(){var e=this.$form.find('input[name="protected_tag[name]"]'),t=this.$form.find("#create_access_levels_attributes");this.$form.find('input[type="submit"]').prop("disabled",!(e.val()&&t.length))}}],[{key:"getProtectedTags",value:function(e,t){t(gon.open_tags)}}]),e}(),d=n(7),u=n(5),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=t.$wrap,this.$allowedToCreateDropdownButton=this.$wrap.find(".js-allowed-to-create"),this.onSelectCallback=this.onSelect.bind(this),this.buildDropdowns()}return p(e,[{key:"buildDropdowns",value:function(){this.protectedTagAccessDropdown=new s({$dropdown:this.$allowedToCreateDropdownButton,data:gon.create_access_levels,onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this,t=this.$wrap.find('input[name="'+this.$allowedToCreateDropdownButton.data("fieldName")+'"]');t.length&&(this.$allowedToCreateDropdownButton.disable(),u.a.patch(this.$wrap.data("url"),{protected_tag:{create_access_levels_attributes:[{id:this.$allowedToCreateDropdownButton.data("accessLevelId"),access_level:t.val()}]}}).then(function(){e.$allowedToCreateDropdownButton.enable()}).catch(function(){e.$allowedToCreateDropdownButton.enable(),Object(d.a)("Failed to update tag!","alert",document.querySelector(".js-protected-tags-list"))}))}}]),e}(),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=o()(".protected-tags-list"),this.initEditForm()}return h(e,[{key:"initEditForm",value:function(){this.$wrap.find(".js-protected-tag-edit-form").each(function(e,t){new f({$wrap:o()(t)})})}}]),e}(),b=n(150),v=n(8),g=n(1),w=n(27),m=n(271),_=new v.default,k=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var j=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.axios=u.a.create({baseURL:t})}return k(e,[{key:"getKeys",value:function(){return this.axios.get().then(function(e){return e.data})}},{key:"enableKey",value:function(e){return this.axios.put(e+"/enable").then(function(e){return e.data})}},{key:"disableKey",value:function(e){return this.axios.put(e+"/disable").then(function(e){return e.data})}}]),e}(),$=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keys={}}return $(e,[{key:"isEnabled",value:function(e){return this.keys.enabled_keys.some(function(t){return t.id===e})}}]),e}(),C=n(3),S=n.n(C),T=n(15),x=n(12),K=n(94),P={components:{loadingIcon:w.a},props:{deployKey:{type:Object,required:!0},type:{type:String,required:!0},btnCssClass:{type:String,required:!1,default:"btn-default"}},data:function(){return{isLoading:!1}},methods:{doAction:function(){var e=this;this.isLoading=!0,_.$emit(this.type+".key",this.deployKey,function(){e.isLoading=!1})}}},O=n(2);var E={components:{actionBtn:Object(O.a)(P,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn",class:[{disabled:e.isLoading},e.btnCssClass],attrs:{disabled:e.isLoading},on:{click:e.doAction}},[e._t("default"),e._v(" "),e.isLoading?n("loading-icon",{attrs:{inline:!0}}):e._e()],2)},[],!1,null,null,null).exports,icon:T.a},directives:{tooltip:x.a},mixins:[K.a],props:{deployKey:{type:Object,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0},projectId:{type:String,required:!1,default:null}},data:function(){return{projectsExpanded:!1}},computed:{editDeployKeyPath:function(){return this.endpoint+"/"+this.deployKey.id+"/edit"},projects:function(){var e=this,t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.deployKey.deploy_keys_projects));if(null!==this.projectId){var n=S.a.findIndex(t,function(t){return t&&t.project&&t.project.id&&t.project.id.toString()===e.projectId});if(n>-1){var a=t.splice(n,1);return a[0].project.full_name=Object(g.e)("DeployKeys|Current project"),a.concat(t)}}return t},firstProject:function(){return S.a.head(this.projects)},restProjects:function(){return S.a.tail(this.projects)},restProjectsTooltip:function(){return Object(g.f)(Object(g.e)("DeployKeys|Expand %{count} other projects"),{count:this.restProjects.length})},restProjectsLabel:function(){return Object(g.f)(Object(g.e)("DeployKeys|+%{count} others"),{count:this.restProjects.length})},isEnabled:function(){return this.store.isEnabled(this.deployKey.id)},isRemovable:function(){return this.store.isEnabled(this.deployKey.id)&&this.deployKey.destroyed_when_orphaned&&this.deployKey.almost_orphaned},isExpandable:function(){return!this.projectsExpanded&&this.restProjects.length>1},isExpanded:function(){return this.projectsExpanded||1===this.restProjects.length}},methods:{projectTooltipTitle:function(e){return e.can_push?Object(g.e)("DeployKeys|Write access allowed"):Object(g.e)("DeployKeys|Read access only")},toggleExpanded:function(){this.projectsExpanded=!this.projectsExpanded}}},I={components:{deployKey:Object(O.a)(E,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"gl-responsive-table-row deploy-key"},[n("div",{staticClass:"table-section section-40"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.s__("DeployKeys|Deploy key"))+"\n    ")]),e._v(" "),n("div",{staticClass:"table-mobile-content"},[n("strong",{staticClass:"title qa-key-title"},[e._v("\n        "+e._s(e.deployKey.title)+"\n      ")]),e._v(" "),n("div",{staticClass:"fingerprint qa-key-fingerprint"},[e._v("\n        "+e._s(e.deployKey.fingerprint)+"\n      ")])])]),e._v(" "),n("div",{staticClass:"table-section section-30 section-wrap"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.s__("DeployKeys|Project usage"))+"\n    ")]),e._v(" "),n("div",{staticClass:"table-mobile-content deploy-project-list"},[e.projects.length>0?[n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"label deploy-project-label",attrs:{title:e.projectTooltipTitle(e.firstProject)}},[n("span",[e._v("\n            "+e._s(e.firstProject.project.full_name)+"\n          ")]),e._v(" "),n("icon",{attrs:{name:e.firstProject.can_push?"lock-open":"lock"}})],1),e._v(" "),e.isExpandable?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"label deploy-project-label",attrs:{title:e.restProjectsTooltip},on:{click:e.toggleExpanded}},[n("span",[e._v(e._s(e.restProjectsLabel))])]):e.isExpanded?e._l(e.restProjects,function(t){return n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],key:t.project.full_path,staticClass:"label deploy-project-label",attrs:{href:t.project.full_path,title:e.projectTooltipTitle(t)}},[n("span",[e._v("\n            "+e._s(t.project.full_name)+"\n          ")]),e._v(" "),n("icon",{attrs:{name:t.can_push?"lock-open":"lock"}})],1)}):e._e()]:n("span",{staticClass:"text-secondary"},[e._v(e._s(e.__("None")))])],2)]),e._v(" "),n("div",{staticClass:"table-section section-15 text-right"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.__("Created"))+"\n    ")]),e._v(" "),n("div",{staticClass:"table-mobile-content text-secondary key-created-at"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{title:e.tooltipTitle(e.deployKey.created_at)}},[n("icon",{attrs:{name:"calendar"}}),e._v(" "),n("span",[e._v(e._s(e.timeFormated(e.deployKey.created_at)))])],1)])]),e._v(" "),n("div",{staticClass:"table-section section-15 table-button-footer deploy-key-actions"},[n("div",{staticClass:"btn-group table-action-buttons"},[e.isEnabled?e._e():n("action-btn",{attrs:{"deploy-key":e.deployKey,type:"enable"}},[e._v("\n        "+e._s(e.__("Enable"))+"\n      ")]),e._v(" "),e.deployKey.can_edit?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"btn btn-default text-secondary",attrs:{href:e.editDeployKeyPath,title:e.__("Edit"),"data-container":"body"}},[n("icon",{attrs:{name:"pencil"}})],1):e._e(),e._v(" "),e.isRemovable?n("action-btn",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{"deploy-key":e.deployKey,title:e.__("Remove"),"btn-css-class":"btn-danger",type:"remove","data-container":"body"}},[n("icon",{attrs:{name:"remove"}})],1):e.isEnabled?n("action-btn",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{"deploy-key":e.deployKey,title:e.__("Disable"),"btn-css-class":"btn-warning",type:"disable","data-container":"body"}},[n("icon",{attrs:{name:"cancel"}})],1):e._e()],1)])])},[],!1,null,null,null).exports},props:{keys:{type:Array,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0},projectId:{type:String,required:!1,default:null}}},N={components:{KeysPanel:Object(O.a)(I,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"deploy-keys-panel table-holder"},[e.keys.length>0?[n("div",{staticClass:"gl-responsive-table-row table-row-header",attrs:{role:"row"}},[n("div",{staticClass:"table-section section-40",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("DeployKeys|Deploy key"))+"\n      ")]),e._v(" "),n("div",{staticClass:"table-section section-30",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("DeployKeys|Project usage"))+"\n      ")]),e._v(" "),n("div",{staticClass:"table-section section-15 text-right",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.__("Created"))+"\n      ")])]),e._v(" "),e._l(e.keys,function(t){return n("deploy-key",{key:t.id,attrs:{"deploy-key":t,store:e.store,endpoint:e.endpoint,"project-id":e.projectId}})})]:n("div",{staticClass:"settings-message text-center"},[e._v("\n    "+e._s(e.s__("DeployKeys|No deploy keys found. Create one with the form above."))+"\n  ")])],2)},[],!1,null,null,null).exports,LoadingIcon:w.a,NavigationTabs:m.a},props:{endpoint:{type:String,required:!0},projectId:{type:String,required:!0}},data:function(){return{currentTab:"enabled_keys",isLoading:!1,store:new D}},scopes:{enabled_keys:Object(g.e)("DeployKeys|Enabled deploy keys"),available_project_keys:Object(g.e)("DeployKeys|Privately accessible deploy keys"),public_keys:Object(g.e)("DeployKeys|Publicly accessible deploy keys")},computed:{tabs:function(){var e=this;return Object.keys(this.$options.scopes).map(function(t){var n=Array.isArray(e.keys[t])?e.keys[t].length:null;return{name:e.$options.scopes[t],scope:t,isActive:t===e.currentTab,count:n}})},hasKeys:function(){return Object.keys(this.keys).length},keys:function(){return this.store.keys}},created:function(){this.service=new j(this.endpoint),_.$on("enable.key",this.enableKey),_.$on("remove.key",this.disableKey),_.$on("disable.key",this.disableKey)},mounted:function(){this.fetchKeys()},beforeDestroy:function(){_.$off("enable.key",this.enableKey),_.$off("remove.key",this.disableKey),_.$off("disable.key",this.disableKey)},methods:{onChangeTab:function(e){this.currentTab=e},fetchKeys:function(){var e=this;return this.isLoading=!0,this.service.getKeys().then(function(t){e.isLoading=!1,e.store.keys=t}).catch(function(){return e.isLoading=!1,e.store.keys={},new d.a(Object(g.e)("DeployKeys|Error getting deploy keys"))})},enableKey:function(e){this.service.enableKey(e.id).then(this.fetchKeys).catch(function(){return new d.a(Object(g.e)("DeployKeys|Error enabling deploy key"))})},disableKey:function(e,t){window.confirm(Object(g.e)("DeployKeys|You are going to remove this deploy key. Are you sure?"))?this.service.disableKey(e.id).then(this.fetchKeys).then(t).catch(function(){return new d.a(Object(g.e)("DeployKeys|Error removing deploy key"))}):t()}}},L=Object(O.a)(N,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"append-bottom-default deploy-keys"},[e.isLoading&&!e.hasKeys?n("loading-icon",{attrs:{label:e.s__("DeployKeys|Loading deploy keys"),size:"2"}}):e.hasKeys?[n("div",{staticClass:"top-area scrolling-tabs-container inner-page-scroll-tabs"},[n("div",{staticClass:"fade-left"},[n("i",{staticClass:"fa fa-angle-left",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("div",{staticClass:"fade-right"},[n("i",{staticClass:"fa fa-angle-right",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("navigation-tabs",{attrs:{tabs:e.tabs,scope:"deployKeys"},on:{onChangeTab:e.onChangeTab}})],1),e._v(" "),n("keys-panel",{staticClass:"qa-project-deploy-keys",attrs:{"project-id":e.projectId,keys:e.keys[e.currentTab],store:e.store,endpoint:e.endpoint}})]:e._e()],2)},[],!1,null,null,null).exports,B=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.initDropdown()}return B(e,[{key:"initDropdown",value:function(){var e=this.options,t=e.$dropdown,n=e.data,a=e.onSelect;t.glDropdown({data:n,selectable:!0,inputId:t.data("inputId"),fieldName:t.data("fieldName"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(e){e.e.preventDefault(),a()}})}}]),e}(),A=n(76),F=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var R=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=o()(".js-new-protected-branch"),this.isLocalStorageAvailable=A.a.isLocalStorageAccessSafe(),this.currentProjectUserDefaults={},this.buildDropdowns()}return F(e,[{key:"buildDropdowns",value:function(){var t=this.$form.find(".js-allowed-to-merge"),n=this.$form.find(".js-allowed-to-push"),a=this.$form.find(".js-protected-branch-select");this.onSelectCallback=this.onSelect.bind(this),this.protectedBranchMergeAccessDropdown=new q({$dropdown:t,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),this.protectedBranchPushAccessDropdown=new q({$dropdown:n,data:gon.push_access_levels,onSelect:this.onSelectCallback}),this.createItemDropdown=new r.a({$dropdown:a,defaultToggleLabel:"Protected Branch",fieldName:"protected_branch[name]",onSelect:this.onSelectCallback,getData:e.getProtectedBranches})}},{key:"onSelect",value:function(){var e=this.$form.find('input[name="protected_branch[name]"]'),t=this.$form.find('input[name="protected_branch[merge_access_levels_attributes][0][access_level]"]'),n=this.$form.find('input[name="protected_branch[push_access_levels_attributes][0][access_level]"]'),a=!(e.val()&&t.length&&n.length);this.$form.find('input[type="submit"]').prop("disabled",a)}}],[{key:"getProtectedBranches",value:function(e,t){t(gon.open_branches)}}]),e}(),M=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var V=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=t.$wrap,this.$allowedToMergeDropdown=this.$wrap.find(".js-allowed-to-merge"),this.$allowedToPushDropdown=this.$wrap.find(".js-allowed-to-push"),this.onSelectCallback=this.onSelect.bind(this),this.buildDropdowns()}return M(e,[{key:"buildDropdowns",value:function(){this.protectedBranchAccessDropdown=new q({$dropdown:this.$allowedToMergeDropdown,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),this.protectedBranchAccessDropdown=new q({$dropdown:this.$allowedToPushDropdown,data:gon.push_access_levels,onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this,t=this.$wrap.find('input[name="'+this.$allowedToMergeDropdown.data("fieldName")+'"]'),n=this.$wrap.find('input[name="'+this.$allowedToPushDropdown.data("fieldName")+'"]');t.length&&n.length&&(this.$allowedToMergeDropdown.disable(),this.$allowedToPushDropdown.disable(),u.a.patch(this.$wrap.data("url"),{protected_branch:{merge_access_levels_attributes:[{id:this.$allowedToMergeDropdown.data("accessLevelId"),access_level:t.val()}],push_access_levels_attributes:[{id:this.$allowedToPushDropdown.data("accessLevelId"),access_level:n.val()}]}}).then(function(){e.$allowedToMergeDropdown.enable(),e.$allowedToPushDropdown.enable()}).catch(function(){e.$allowedToMergeDropdown.enable(),e.$allowedToPushDropdown.enable(),Object(d.a)("Failed to update branch!","alert",document.querySelector(".js-protected-branches-list"))}))}}]),e}(),U=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=o()(".protected-branches-list"),this.initEditForm()}return U(e,[{key:"initEditForm",value:function(){this.$wrap.find(".js-protected-branch-edit-form").each(function(e,t){new V({$wrap:o()(t)})})}}]),e}(),W=n(103);t.a=function(){new c,new y,new v.default({el:document.getElementById("js-deploy-keys"),components:{deployKeysApp:L},data:function(){return{endpoint:this.$options.el.dataset.endpoint,projectId:this.$options.el.dataset.projectId}},render:function(e){return e("deploy-keys-app",{props:{endpoint:this.endpoint,projectId:this.projectId}})}}),Object(b.a)(),new R,new z,new W.a}},913:function(e,t,n){"use strict";n.r(t);var a=n(445);document.addEventListener("DOMContentLoaded",a.a)},914:function(e,t,n){n(31),n(57),e.exports=n(913)},94:function(e,t,n){"use strict";var a=n(38);t.a={methods:{timeFormated:function(e){return Object(a.d)().format(e)},tooltipTitle:function(e){return Object(a.a)(e)}}}}},[[914,0,1,2,4]]]);
//# sourceMappingURL=pages.projects.settings.repository.create_deploy_token.66661c00.chunk.js.map