(this.webpackJsonp=this.webpackJsonp||[]).push([[111],{121:function(t,e,n){"use strict";var i=n(12),o=n(94),s=(n(38),{directives:{tooltip:i.a},mixins:[o.a],props:{time:{type:String,required:!0},tooltipPlacement:{type:String,required:!1,default:"top"},cssClass:{type:String,required:!1,default:""}}}),a=n(2),r=Object(a.a)(s,function(){var t=this.$createElement;return(this._self._c||t)("time",{directives:[{name:"tooltip",rawName:"v-tooltip"}],class:this.cssClass,attrs:{title:this.tooltipTitle(this.time),"data-placement":this.tooltipPlacement,"data-container":"body"},domProps:{textContent:this._s(this.timeFormated(this.time))}})},[],!1,null,null,null);e.a=r.exports},141:function(t,e,n){"use strict";var i={components:{ciIcon:n(96).a},props:{name:{type:String,required:!0},status:{type:Object,required:!0}}},o=n(2),s=Object(o.a)(i,function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"ci-job-name-component"},[e("ci-icon",{attrs:{status:this.status}}),this._v(" "),e("span",{staticClass:"ci-status-text"},[this._v("\n    "+this._s(this.name)+"\n  ")])],1)},[],!1,null,null,null);e.a=s.exports},142:function(t,e,n){"use strict";var i=n(0),o=n.n(i),s=n(5),a=n(45),r=n(1),l=n(7),c=n(12),u={components:{Icon:n(15).a},directives:{tooltip:c.a},props:{tooltipText:{type:String,required:!0},link:{type:String,required:!0},actionIcon:{type:String,required:!0}},data:function(){return{isDisabled:!1}},computed:{cssClass:function(){var t=Object(a.e)(this.actionIcon);return t+" js-icon-"+t}},methods:{onClickAction:function(){var t=this;o()(this.$el).tooltip("hide"),this.isDisabled=!0,s.a.post(this.link+".json").then(function(){t.isDisabled=!1,t.$emit("pipelineActionRequestComplete")}).catch(function(){t.isDisabled=!1,Object(l.a)(Object(r.a)("An error occurred while making the request."))})}}},p=n(2),d={components:{ActionComponent:Object(p.a)(u,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"js-ci-action btn btn-blank\nbtn-transparent ci-action-icon-container ci-action-icon-wrapper",class:this.cssClass,attrs:{title:this.tooltipText,disabled:this.isDisabled,type:"button","data-container":"body","data-boundary":"viewport"},on:{click:this.onClickAction}},[e("icon",{attrs:{name:this.actionIcon}})],1)},[],!1,null,null,null).exports,JobNameComponent:n(141).a},directives:{tooltip:c.a},props:{job:{type:Object,required:!0},cssClassJobName:{type:String,required:!1,default:""},dropdownLength:{type:Number,required:!1,default:1/0}},computed:{status:function(){return this.job&&this.job.status?this.job.status:{}},tooltipText:function(){var t=[];return this.job.name&&t.push(this.job.name),this.job.name&&this.status.tooltip&&t.push("-"),this.status.tooltip&&t.push(this.job.status.tooltip),t.join(" ")},tooltipBoundary:function(){return this.dropdownLength<5?"viewport":null},hasAction:function(){return this.job.status&&this.job.status.action&&this.job.status.action.path}},methods:{pipelineActionRequestComplete:function(){this.$emit("pipelineActionRequestComplete")}}},h=Object(p.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ci-job-component"},[t.status.has_details?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"js-pipeline-graph-job-link",class:t.cssClassJobName,attrs:{href:t.status.details_path,title:t.tooltipText,"data-boundary":t.tooltipBoundary,"data-container":"body"}},[n("job-name-component",{attrs:{name:t.job.name,status:t.job.status}})],1):n("div",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"js-job-component-tooltip non-details-job-component",class:t.cssClassJobName,attrs:{title:t.tooltipText,"data-container":"body"}},[n("job-name-component",{attrs:{name:t.job.name,status:t.job.status}})],1),t._v(" "),t.hasAction?n("action-component",{attrs:{"tooltip-text":t.status.action.title,link:t.status.action.path,"action-icon":t.status.action.icon},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e()],1)},[],!1,null,null,null);e.a=h.exports},272:function(t,e,n){"use strict";var i=n(188),o=n(27),s=n(121),a=n(12),r=n(82),l={components:{CiIconBadge:i.a,LoadingIcon:o.a,TimeagoTooltip:s.a,UserAvatarImage:r.a},directives:{tooltip:a.a},props:{status:{type:Object,required:!0},itemName:{type:String,required:!0},itemId:{type:Number,required:!0},time:{type:String,required:!0},user:{type:Object,required:!1,default:function(){return{}}},actions:{type:Array,required:!1,default:function(){return[]}},hasSidebarButton:{type:Boolean,required:!1,default:!1},shouldRenderTriggeredLabel:{type:Boolean,required:!1,default:!0}},computed:{userAvatarAltText:function(){return this.user.name+"'s avatar"}},methods:{onClickAction:function(t){this.$emit("actionClicked",t)}}},c=n(2),u=Object(c.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"page-content-header ci-header-container"},[n("section",{staticClass:"header-main-content"},[n("ci-icon-badge",{attrs:{status:t.status}}),t._v(" "),n("strong",[t._v("\n        "+t._s(t.itemName)+" #"+t._s(t.itemId)+"\n      ")]),t._v(" "),t.shouldRenderTriggeredLabel?[t._v("\n        triggered\n      ")]:[t._v("\n        created\n      ")],t._v(" "),n("timeago-tooltip",{attrs:{time:t.time}}),t._v("\n\n      by\n\n      "),t.user?[n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"js-user-link commit-committer-link",attrs:{href:t.user.path,title:t.user.email}},[n("user-avatar-image",{attrs:{"img-src":t.user.avatar_url,"img-alt":t.userAvatarAltText,"tooltip-text":t.user.name,"img-size":24}}),t._v("\n\n          "+t._s(t.user.name)+"\n        ")],1),t._v(" "),t.user.status_tooltip_html?n("span",{domProps:{innerHTML:t._s(t.user.status_tooltip_html)}}):t._e()]:t._e()],2),t._v(" "),t.actions.length?n("section",{staticClass:"header-action-buttons"},[t._l(t.actions,function(e,i){return["link"===e.type?n("a",{key:i,class:e.cssClass,attrs:{href:e.path}},[t._v("\n          "+t._s(e.label)+"\n        ")]):"ujs-link"===e.type?n("a",{key:i,class:e.cssClass,attrs:{href:e.path,"data-method":"post",rel:"nofollow"}},[t._v("\n          "+t._s(e.label)+"\n        ")]):"button"===e.type?n("button",{key:i,class:e.cssClass,attrs:{disabled:e.isLoading,type:"button"},on:{click:function(n){t.onClickAction(e)}}},[t._v("\n          "+t._s(e.label)+"\n          "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"action.isLoading"}],staticClass:"fa fa-spin fa-spinner",attrs:{"aria-hidden":"true"}})]):t._e()]}),t._v(" "),t.hasSidebarButton?n("button",{staticClass:"btn btn-default d-block d-sm-none d-md-none\nsidebar-toggle-btn js-sidebar-build-toggle js-sidebar-build-toggle-header",attrs:{id:"toggleSidebar",type:"button","aria-label":"Toggle Sidebar"}},[n("i",{staticClass:"fa fa-angle-double-left",attrs:{"aria-hidden":"true","aria-labelledby":"toggleSidebar"}})]):t._e()],2):t._e()])},[],!1,null,null,null);e.a=u.exports},423:function(t,e,n){"use strict";n.r(e);var i=n(8),o=n(7),s=n(72),a=n(1),r=n(61),l=n.n(r),c=n(97),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state={},this.state.pipeline={}}return u(t,[{key:"storePipeline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.pipeline=t}}]),t}(),d=n(5),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pipeline=e}return h(t,[{key:"getPipeline",value:function(){return d.a.get(this.pipeline)}},{key:"postAction",value:function(t){return d.a.post(t+".json")}}]),t}(),b=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.store=new p,this.service=new m(e.endpoint),this.state={},this.state.isLoading=!1}return b(t,[{key:"fetchPipeline",value:function(){var t=this;this.poll=new c.a({resource:this.service,method:"getPipeline",successCallback:this.successCallback.bind(this),errorCallback:this.errorCallback.bind(this)}),l.a.hidden()?this.refreshPipeline():(this.state.isLoading=!0,this.poll.makeRequest()),l.a.change(function(){l.a.hidden()?t.poll.stop():t.poll.restart()})}},{key:"successCallback",value:function(t){this.state.isLoading=!1,this.store.storePipeline(t.data)}},{key:"errorCallback",value:function(){this.state.isLoading=!1,Object(o.a)(Object(a.a)("An error occurred while fetching the pipeline."))}},{key:"refreshPipeline",value:function(){var t=this;return this.poll.stop(),this.service.getPipeline().then(function(e){return t.successCallback(e)}).catch(function(){return t.errorCallback()}).finally(function(){return t.poll.restart()})}}]),t}(),g=n(3),v=n.n(g),C=n(27),j=n(142),y=n(0),_=n.n(y),w=n(141),k={directives:{tooltip:n(12).a},components:{JobComponent:j.a,JobNameComponent:w.a},props:{job:{type:Object,required:!0}},computed:{tooltipText:function(){return this.job.name+" - "+this.job.status.label}},mounted:function(){this.stopDropdownClickPropagation()},methods:{stopDropdownClickPropagation:function(){_()(".js-grouped-pipeline-dropdown button, .js-grouped-pipeline-dropdown a.mini-pipeline-graph-dropdown-item",this.$el).on("click",function(t){t.stopPropagation()})},pipelineActionRequestComplete:function(){this.$emit("pipelineActionRequestComplete")}}},A=n(2),q=Object(A.a)(k,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ci-job-dropdown-container dropdown dropright"},[n("button",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"dropdown-menu-toggle build-content",attrs:{title:t.tooltipText,type:"button","data-toggle":"dropdown","data-container":"body","data-boundary":"viewport","data-display":"static"}},[n("job-name-component",{attrs:{name:t.job.name,status:t.job.status}}),t._v(" "),n("span",{staticClass:"dropdown-counter-badge"},[t._v("\n      "+t._s(t.job.size)+"\n    ")])],1),t._v(" "),n("ul",{staticClass:"dropdown-menu big-pipeline-graph-dropdown-menu js-grouped-pipeline-dropdown"},[n("li",{staticClass:"scrollable-menu"},[n("ul",t._l(t.job.jobs,function(e,i){return n("li",{key:i},[n("job-component",{attrs:{"dropdown-length":t.job.size,job:e,"css-class-job-name":"mini-pipeline-graph-dropdown-item"},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}})],1)}))])])])},[],!1,null,null,null).exports,O={components:{JobComponent:j.a,DropdownJobComponent:q},props:{title:{type:String,required:!0},jobs:{type:Array,required:!0},isFirstColumn:{type:Boolean,required:!1,default:!1},stageConnectorClass:{type:String,required:!1,default:""}},methods:{firstJob:function(t){return t[0]},jobId:function(t){return"ci-badge-"+v.a.escape(t.name)},buildConnnectorClass:function(t){return 0!==t||this.isFirstColumn?"":"left-connector"},pipelineActionRequestComplete:function(){this.$emit("refreshPipelineGraph")}}},P={components:{StageColumnComponent:Object(A.a)(O,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"stage-column",class:t.stageConnectorClass},[n("div",{staticClass:"stage-name"},[t._v("\n    "+t._s(t.title)+"\n  ")]),t._v(" "),n("div",{staticClass:"builds-container"},[n("ul",t._l(t.jobs,function(e,i){return n("li",{key:e.id,staticClass:"build",class:t.buildConnnectorClass(i),attrs:{id:t.jobId(e)}},[n("div",{staticClass:"curve"}),t._v(" "),1===e.size?n("job-component",{attrs:{job:e,"css-class-job-name":"build-content"},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e(),t._v(" "),e.size>1?n("dropdown-job-component",{attrs:{job:e},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e()],1)}))])])},[],!1,null,null,null).exports,LoadingIcon:C.a},props:{isLoading:{type:Boolean,required:!0},pipeline:{type:Object,required:!0}},computed:{graph:function(){return this.pipeline.details&&this.pipeline.details.stages}},methods:{capitalizeStageName:function(t){var e=v.a.escape(t);return e.charAt(0).toUpperCase()+e.slice(1)},isFirstColumn:function(t){return 0===t},stageConnectorClass:function(t,e){var n=void 0;return 0===t&&1===e.groups.length?n="no-margin":t>0&&(n="left-margin"),n},refreshPipelineGraph:function(){this.$emit("refreshPipelineGraph")}}},L=Object(A.a)(P,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"build-content middle-block js-pipeline-graph"},[n("div",{staticClass:"pipeline-visualization pipeline-graph pipeline-tab-content"},[n("div",{staticClass:"text-center"},[t.isLoading?n("loading-icon",{attrs:{size:"3"}}):t._e()],1),t._v(" "),t.isLoading?t._e():n("ul",{staticClass:"stage-column-list"},t._l(t.graph,function(e,i){return n("stage-column-component",{key:e.name,attrs:{title:t.capitalizeStageName(e.name),jobs:e.groups,"stage-connector-class":t.stageConnectorClass(i,e),"is-first-column":t.isFirstColumn(i)},on:{refreshPipelineGraph:t.refreshPipelineGraph}})}))])])},[],!1,null,null,null).exports,S=n(272),x=n(49),T={name:"PipelineHeaderSection",components:{ciHeader:S.a,loadingIcon:C.a},props:{pipeline:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},data:function(){return{actions:this.getActions()}},computed:{status:function(){return this.pipeline.details&&this.pipeline.details.status},shouldRenderContent:function(){return!this.isLoading&&Object.keys(this.pipeline).length}},watch:{pipeline:function(){this.actions=this.getActions()}},methods:{postAction:function(t){var e=this.actions.indexOf(t);this.$set(this.actions[e],"isLoading",!0),x.a.$emit("headerPostAction",t)},getActions:function(){var t=[];return this.pipeline.retry_path&&t.push({label:"Retry",path:this.pipeline.retry_path,cssClass:"js-retry-button btn btn-inverted-secondary",type:"button",isLoading:!1}),this.pipeline.cancel_path&&t.push({label:"Cancel running",path:this.pipeline.cancel_path,cssClass:"js-btn-cancel-pipeline btn btn-danger",type:"button",isLoading:!1}),t}}},R=Object(A.a)(T,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pipeline-header-container"},[t.shouldRenderContent?n("ci-header",{attrs:{status:t.status,"item-id":t.pipeline.id,time:t.pipeline.created_at,user:t.pipeline.user,actions:t.actions,"item-name":"Pipeline"},on:{actionClicked:t.postAction}}):t._e(),t._v(" "),t.isLoading?n("loading-icon",{staticClass:"prepend-top-default append-bottom-default",attrs:{size:"2"}}):t._e()],1)},[],!1,null,null,null).exports;i.default.use(s.a);var $=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var E=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=n,this.defaultAction=this.options.defaultAction,this.action=this.options.action||this.defaultAction,"show"===this.action&&(this.action=this.defaultAction),this.currentLocation=window.location;var i=this.options.parentEl+' a[data-toggle="tab"]';_()(document).off("shown.bs.tab",i).on("shown.bs.tab",i,function(t){return e.tabShown(t)}),this.activateTab(this.action)}return $(t,[{key:"tabShown",value:function(t){var e=t.target.getAttribute("href");return this.setCurrentAction(e)}},{key:"setCurrentAction",value:function(t){var e=t;e.replace(/\/+$/,"");var n=""+e+this.currentLocation.search+this.currentLocation.hash;return window.history.replaceState({url:n},document.title,n),n}},{key:"activateTab",value:function(){return _()(this.options.parentEl+" a[data-action='"+this.action+"']").tab("show")}}]),t}(),N=n(11);var I=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.initTabs&&e.tabsOptions&&new E(e.tabsOptions),e.pipelineStatusUrl&&Object(N.G)(e.pipelineStatusUrl)};document.addEventListener("DOMContentLoaded",function(){var t,e,n,s;t=document.querySelector(".js-pipeline-container").dataset.controllerAction,e=document.querySelector(".js-pipeline-tab-link a").getAttribute("href")+"/status.json",new I({initTabs:!0,pipelineStatusUrl:e,tabsOptions:{action:t,defaultAction:"pipelines",parentEl:".pipelines-tabs"}}),n=document.querySelector(".js-pipeline-details-vue").dataset,(s=new f({endpoint:n.endpoint})).fetchPipeline(),new i.default({el:"#js-pipeline-graph-vue",components:{pipelineGraph:L},data:function(){return{mediator:s}},methods:{requestRefreshPipelineGraph:function(){this.mediator.refreshPipeline().catch(function(){return Object(o.a)(Object(a.a)("An error occurred while making the request."))})}},render:function(t){return t("pipeline-graph",{props:{isLoading:this.mediator.state.isLoading,pipeline:this.mediator.store.state.pipeline},on:{refreshPipelineGraph:this.requestRefreshPipelineGraph}})}}),new i.default({el:"#js-pipeline-header-vue",components:{pipelineHeader:R},data:function(){return{mediator:s}},created:function(){x.a.$on("headerPostAction",this.postAction)},beforeDestroy:function(){x.a.$off("headerPostAction",this.postAction)},methods:{postAction:function(t){var e=this;this.mediator.service.postAction(t.path).then(function(){return e.mediator.refreshPipeline()}).catch(function(){return Object(o.a)(Object(a.a)("An error occurred while making the request."))})}},render:function(t){return t("pipeline-header",{props:{isLoading:this.mediator.state.isLoading,pipeline:this.mediator.store.state.pipeline}})}})})},49:function(t,e,n){"use strict";var i=n(8);e.a=new i.default},924:function(t,e,n){n(31),n(57),t.exports=n(423)}},[[924,0,1,2,6]]]);
//# sourceMappingURL=pages.projects.pipelines.show.9746d00c.chunk.js.map